<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST-3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>state.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140495700-1"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
   
     gtag('config', 'UA-140495700-1');
   </script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>state.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.0% of total for source files.">158 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/state.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">state.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/state.html">state</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/state.f90.html#src">state.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>Allocate memory to the state variables and initialize them</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~state.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilestatef90EfferentGraph" width="462pt" height="228pt"
 viewBox="0.00 0.00 462.00 228.28" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~state.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 224.277)">
<title>sourcefile~~state.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-224.277 458,-224.277 458,4 -4,4"/>
<!-- sourcefile~state.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~state.f90</title>
<polygon fill="none" stroke="#000000" points="454,-150.2252 400,-150.2252 400,-126.2252 454,-126.2252 454,-150.2252"/>
<text text-anchor="middle" x="427" y="-135.8252" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">state.f90</text>
</g>
<!-- sourcefile~utils.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~utils.f90</title>
<g id="a_sourcefile~~state.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/utils.f90.html" xlink:title="utils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="62.5,-192.2252 8.5,-192.2252 8.5,-168.2252 62.5,-168.2252 62.5,-192.2252"/>
<text text-anchor="middle" x="35.5" y="-177.8252" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~state.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~state.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.3854,-150.3975C362.5453,-173.3351 263.235,-220.6398 173.5,-220.2252"/>
</g>
<!-- sourcefile~check_output_control.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~check_output_control.f90</title>
<g id="a_sourcefile~~state.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/check_output_control.f90.html" xlink:title="check_output_control.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="240,-70.2252 107,-70.2252 107,-46.2252 240,-46.2252 240,-70.2252"/>
<text text-anchor="middle" x="173.5" y="-55.8252" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_output_control.f90</text>
</a>
</g>
</g>
<!-- sourcefile~state.f90&#45;&gt;sourcefile~check_output_control.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~state.f90&#45;&gt;sourcefile~check_output_control.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M320,-18.2252C310.3659,-14.6706 258.1986,-30.2574 218.8362,-43.0039"/>
<polygon fill="#ff0000" stroke="#ff0000" points="217.5583,-39.7392 209.1384,-46.1699 219.7309,-46.3935 217.5583,-39.7392"/>
</g>
<!-- sourcefile~read_output.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~read_output.f90</title>
<g id="a_sourcefile~~state.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/read_output.f90.html" xlink:title="read_output.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="364,-150.2252 276,-150.2252 276,-126.2252 364,-126.2252 364,-150.2252"/>
<text text-anchor="middle" x="320" y="-135.8252" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">read_output.f90</text>
</a>
</g>
</g>
<!-- sourcefile~state.f90&#45;&gt;sourcefile~read_output.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~state.f90&#45;&gt;sourcefile~read_output.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.9994,-138.2252C392.0827,-138.2252 383.1302,-138.2252 374.1533,-138.2252"/>
<polygon fill="#ff0000" stroke="#ff0000" points="374.0615,-134.7253 364.0615,-138.2252 374.0614,-141.7253 374.0615,-134.7253"/>
</g>
<!-- sourcefile~vartypes.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~vartypes.f90</title>
<g id="a_sourcefile~~state.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/vartypes.f90.html" xlink:title="vartypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-110.2252 0,-110.2252 0,-86.2252 71,-86.2252 71,-110.2252"/>
<text text-anchor="middle" x="35.5" y="-95.8252" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vartypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~state.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~state.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M421.1989,-125.8867C407.8623,-99.2988 372.1121,-37.4523 320,-18.2252"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M320,-18.2252C230.833,14.6736 194.627,-.4204 107,-37.2252 85.4956,-46.2574 65.7136,-64.2219 52.4353,-78.3273"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.5237,-76.3282 45.4049,-86.0897 54.7121,-81.0273 49.5237,-76.3282"/>
</g>
<!-- sourcefile~check_output_control.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~check_output_control.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M132.0954,-70.2265C116.0533,-74.8764 97.6284,-80.2169 81.2002,-84.9787"/>
<polygon fill="#7fff00" stroke="#7fff00" points="79.8987,-81.7118 71.2684,-87.8575 81.8475,-88.4351 79.8987,-81.7118"/>
</g>
<!-- sourcefile~read_output.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~read_output.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M308.3333,-150.3705C285.0209,-173.2608 230.0449,-220.4865 173.5,-220.2252"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M173.5,-220.2252C137.3991,-220.0583 98.0108,-207.2959 70.5903,-196.2326"/>
<polygon fill="#00ffff" stroke="#00ffff" points="71.6346,-192.8761 61.0577,-192.2601 68.9419,-199.3375 71.6346,-192.8761"/>
</g>
<!-- sourcefile~read_output.f90&#45;&gt;sourcefile~check_output_control.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~read_output.f90&#45;&gt;sourcefile~check_output_control.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M304.4088,-126.174C288.7395,-114.4375 263.5927,-96.6047 240,-84.2252 233.0537,-80.5803 225.4782,-77.1487 218.0089,-74.0477"/>
<polygon fill="#00ffff" stroke="#00ffff" points="219.2445,-70.7723 208.66,-70.3053 216.643,-77.271 219.2445,-70.7723"/>
</g>
<!-- sourcefile~read_output.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~read_output.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M279.1765,-126.1294C266.6966,-122.806 252.8682,-119.4961 240,-117.2252 185.9412,-107.6852 122.9432,-102.748 81.3085,-100.3278"/>
<polygon fill="#00ffff" stroke="#00ffff" points="81.3811,-96.8265 71.2021,-99.7654 80.9922,-103.8157 81.3811,-96.8265"/>
</g>
<!-- sourcefile~read_output_tec.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~read_output_tec.f90</title>
<g id="a_sourcefile~~state.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/read_output_tec.f90.html" xlink:title="read_output_tec.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="228,-150.2252 119,-150.2252 119,-126.2252 228,-126.2252 228,-150.2252"/>
<text text-anchor="middle" x="173.5" y="-135.8252" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">read_output_tec.f90</text>
</a>
</g>
</g>
<!-- sourcefile~read_output.f90&#45;&gt;sourcefile~read_output_tec.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~read_output.f90&#45;&gt;sourcefile~read_output_tec.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M275.6476,-138.2252C263.8192,-138.2252 250.7934,-138.2252 238.1174,-138.2252"/>
<polygon fill="#00ffff" stroke="#00ffff" points="238.0561,-134.7253 228.0561,-138.2252 238.056,-141.7253 238.0561,-134.7253"/>
</g>
<!-- sourcefile~read_output_vtk.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~read_output_vtk.f90</title>
<g id="a_sourcefile~~state.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/read_output_vtk.f90.html" xlink:title="read_output_vtk.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="227.5,-192.2252 119.5,-192.2252 119.5,-168.2252 227.5,-168.2252 227.5,-192.2252"/>
<text text-anchor="middle" x="173.5" y="-177.8252" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">read_output_vtk.f90</text>
</a>
</g>
</g>
<!-- sourcefile~read_output.f90&#45;&gt;sourcefile~read_output_vtk.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~read_output.f90&#45;&gt;sourcefile~read_output_vtk.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.019,-150.2607C261.6212,-154.9617 242.6498,-160.4007 225.4071,-165.344"/>
<polygon fill="#00ffff" stroke="#00ffff" points="224.1353,-162.0675 215.4872,-168.1879 226.0645,-168.7964 224.1353,-162.0675"/>
</g>
<!-- sourcefile~read_output_tec.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~read_output_tec.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M133.9547,-150.2607C114.6462,-156.1372 91.5493,-163.1667 72.5806,-168.9398"/>
<polygon fill="#ff0000" stroke="#ff0000" points="71.3468,-165.6567 62.7991,-171.9167 73.385,-172.3534 71.3468,-165.6567"/>
</g>
<!-- sourcefile~read_output_tec.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~read_output_tec.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M132.0954,-126.2238C116.0533,-121.5739 97.6284,-116.2334 81.2002,-111.4716"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.8475,-108.0152 71.2684,-108.5928 79.8987,-114.7385 81.8475,-108.0152"/>
</g>
<!-- sourcefile~read_output_vtk.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~read_output_vtk.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M119.3548,-180.2252C103.8303,-180.2252 87.2525,-180.2252 72.9706,-180.2252"/>
<polygon fill="#00ffff" stroke="#00ffff" points="72.5522,-176.7253 62.5522,-180.2252 72.5521,-183.7253 72.5522,-176.7253"/>
</g>
<!-- sourcefile~read_output_vtk.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~state.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~read_output_vtk.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M127.0678,-168.2091C120.1479,-165.6701 113.2477,-162.688 107,-159.2252 87.1961,-148.2489 67.8535,-131.249 54.2909,-117.9807"/>
<polygon fill="#00ffff" stroke="#00ffff" points="56.5501,-115.2893 47.0136,-110.6735 51.5902,-120.2289 56.5501,-115.2893"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~state.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilestatef90AfferentGraph" width="247pt" height="32pt"
 viewBox="0.00 0.00 247.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~state.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~state.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 243,-28 243,4 -4,4"/>
<!-- sourcefile~state.f90 -->
<g id="sourcefile~~state.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~state.f90</title>
<polygon fill="none" stroke="#000000" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">state.f90</text>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~state.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~state.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="149,-24 90,-24 90,0 149,0 149,-24"/>
<text text-anchor="middle" x="119.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~state.f90 -->
<g id="sourcefile~~state.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~state.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M89.9781,-12C81.7837,-12 72.7796,-12 64.2068,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="64.0473,-8.5001 54.0473,-12 64.0472,-15.5001 64.0473,-8.5001"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~state.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~state.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="239,-24 185,-24 185,0 239,0 239,-24"/>
<text text-anchor="middle" x="212" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~state.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M184.7472,-12C176.791,-12 167.9269,-12 159.361,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="159.1413,-8.5001 149.1413,-12 159.1413,-15.5001 159.1413,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/state.html">state</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/state.f90.html#src">state.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>  <span class="c">!&lt; Allocate memory to the state variables and initialize them</span>
<a name="ln-2"></a><span class="k">module </span><span class="n">state</span>
<a name="ln-3"></a>  <span class="c">!&lt; Allocate memory to the state variables and initialize them</span>
<a name="ln-4"></a>  <span class="c">!&lt; The state of the system is defined using the density, velocity and</span>
<a name="ln-5"></a>  <span class="c">!&lt; pressure (primitive variables qp), and trubulent and transition</span>
<a name="ln-6"></a>  <span class="c">!&lt; variables at the cell-center points.</span>
<a name="ln-7"></a>    <span class="c">!-------------------------------------------------------------------</span>
<a name="ln-8"></a>    <span class="c">! The state module contains the state variables and the methods that</span>
<a name="ln-9"></a>    <span class="c">! act on them. </span>
<a name="ln-10"></a>    <span class="c">!-------------------------------------------------------------------</span>
<a name="ln-11"></a>    
<a name="ln-12"></a><span class="cp">#include &quot;debug.h&quot;</span>
<a name="ln-13"></a><span class="cp">#include &quot;error.h&quot;</span>
<a name="ln-14"></a>
<a name="ln-15"></a>    <span class="k">use </span><span class="n">vartypes</span>
<a name="ln-16"></a>    <span class="k">use </span><span class="n">utils</span><span class="p">,</span>       <span class="n">only</span><span class="p">:</span> <span class="n">alloc</span>
<a name="ln-17"></a>    <span class="k">use </span><span class="n">read_output</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">read_file</span>
<a name="ln-18"></a>
<a name="ln-19"></a>    <span class="k">use </span><span class="n">check_output_control</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">verify_write_control</span>
<a name="ln-20"></a>
<a name="ln-21"></a>    <span class="k">implicit none</span>
<a name="ln-22"></a><span class="k">    private</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="k">    </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">n_var</span>
<a name="ln-25"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imx</span><span class="p">,</span> <span class="n">jmx</span><span class="p">,</span> <span class="n">kmx</span>
<a name="ln-26"></a>
<a name="ln-27"></a>    <span class="c">! Public methods</span>
<a name="ln-28"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">setup_state</span>
<a name="ln-29"></a>
<a name="ln-30"></a>    <span class="k">contains</span>
<a name="ln-31"></a>
<a name="ln-32"></a><span class="k">        subroutine </span><span class="n">setup_state</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">qp</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-33"></a>            <span class="c">!&lt; Setup the state module.</span>
<a name="ln-34"></a>            <span class="c">!&lt; This subroutine should be run before the state variables</span>
<a name="ln-35"></a>            <span class="c">!&lt; are initilized. This subroutine allocates the memory for </span>
<a name="ln-36"></a>            <span class="c">!&lt; state variables and sets up the aliases to refer to the </span>
<a name="ln-37"></a>            <span class="c">!&lt; components of the state</span>
<a name="ln-38"></a>            <span class="c">!-----------------------------------------------------------</span>
<a name="ln-39"></a>
<a name="ln-40"></a>            <span class="k">implicit none</span>
<a name="ln-41"></a><span class="k">            type</span><span class="p">(</span><span class="n">filetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">files</span>
<a name="ln-42"></a>            <span class="c">!&lt; Files&#39; name and handler</span>
<a name="ln-43"></a>            <span class="k">type</span><span class="p">(</span><span class="n">controltype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">control</span>
<a name="ln-44"></a>            <span class="c">!&lt; Control parameters</span>
<a name="ln-45"></a>            <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-46"></a>            <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-47"></a>            <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-48"></a>            <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-49"></a>            <span class="k">type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-50"></a>            <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-51"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">qp</span>
<a name="ln-52"></a>            <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-53"></a>
<a name="ln-54"></a>            <span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;setup_state&quot;</span><span class="p">)</span>
<a name="ln-55"></a>
<a name="ln-56"></a>            <span class="n">n_var</span> <span class="o">=</span> <span class="n">control</span><span class="p">%</span><span class="n">n_var</span>
<a name="ln-57"></a>
<a name="ln-58"></a>            <span class="n">imx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">imx</span>
<a name="ln-59"></a>            <span class="n">jmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">jmx</span>
<a name="ln-60"></a>            <span class="n">kmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">kmx</span>
<a name="ln-61"></a>
<a name="ln-62"></a>            <span class="k">call </span><span class="n">set_n_var_value</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">)</span>
<a name="ln-63"></a>            <span class="n">dims</span><span class="p">%</span><span class="n">n_var</span> <span class="o">=</span> <span class="n">control</span><span class="p">%</span><span class="n">n_var</span>
<a name="ln-64"></a>            <span class="c">!call allocate_memory(qp)</span>
<a name="ln-65"></a>            <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_var</span><span class="p">,</span> <span class="n">AErrMsg</span><span class="p">(</span><span class="s2">&quot;qp&quot;</span><span class="p">))</span>
<a name="ln-66"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">control</span><span class="p">%</span><span class="n">previous_res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">control</span><span class="p">%</span><span class="n">n_var</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-67"></a>            <span class="c">!call link_aliases(scheme)</span>
<a name="ln-68"></a>            <span class="k">call </span><span class="n">init_infinity_values</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">)</span>
<a name="ln-69"></a>            <span class="k">call </span><span class="n">initstate</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">qp</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-70"></a>
<a name="ln-71"></a>        <span class="k">end subroutine </span><span class="n">setup_state</span>
<a name="ln-72"></a>
<a name="ln-73"></a>
<a name="ln-74"></a>
<a name="ln-75"></a>        <span class="k">subroutine </span><span class="n">init_infinity_values</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">)</span>
<a name="ln-76"></a>            <span class="c">!&lt; Set the values of the infinity variables &quot;qp_inf&quot;</span>
<a name="ln-77"></a>            <span class="c">!-----------------------------------------------------------</span>
<a name="ln-78"></a>
<a name="ln-79"></a>            <span class="k">implicit none</span>
<a name="ln-80"></a><span class="k">            type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-81"></a>            <span class="c">!&lt; finite-volume Schemes: turbulence, transition model, etc</span>
<a name="ln-82"></a>            <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-83"></a>            <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-84"></a>            
<a name="ln-85"></a>            <span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;init_infinity_values&quot;</span><span class="p">)</span>
<a name="ln-86"></a>
<a name="ln-87"></a>            <span class="n">flow</span><span class="p">%</span><span class="n">vel_mag</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">x_speed_inf</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">flow</span><span class="p">%</span><span class="n">y_speed_inf</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">flow</span><span class="p">%</span><span class="n">z_speed_inf</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-88"></a>            <span class="n">flow</span><span class="p">%</span><span class="n">MInf</span>    <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">vel_mag</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">pressure_inf</span><span class="o">/</span><span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span><span class="p">)</span>
<a name="ln-89"></a>            <span class="n">flow</span><span class="p">%</span><span class="n">Reynolds_number</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">vel_mag</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span>
<a name="ln-90"></a>            <span class="n">flow</span><span class="p">%</span><span class="n">Turb_intensity_inf</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">tu_inf</span><span class="o">/</span><span class="mi">100</span>
<a name="ln-91"></a>
<a name="ln-92"></a>            <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-93"></a>                
<a name="ln-94"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a name="ln-95"></a>                    <span class="k">continue</span>
<a name="ln-96"></a>
<a name="ln-97"></a><span class="k">                case</span> <span class="p">(</span><span class="s2">&quot;sst&quot;</span><span class="p">,</span> <span class="s2">&quot;sst2003&quot;</span><span class="p">,</span> <span class="s2">&quot;bsl&quot;</span><span class="p">)</span>
<a name="ln-98"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="p">((</span><span class="n">flow</span><span class="p">%</span><span class="n">Vel_mag</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">Turb_Intensity_inf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-99"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tw_inf</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span><span class="o">/</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ratio_inf</span><span class="p">)</span>
<a name="ln-100"></a>
<a name="ln-101"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;kkl&quot;</span><span class="p">)</span>
<a name="ln-102"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span> <span class="o">=</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="err">1</span><span class="n">e</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sound_speed_inf</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-103"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tkl_inf</span> <span class="o">=</span> <span class="mf">1.5589</span><span class="o">*</span><span class="p">(</span><span class="err">1</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">*</span><span class="n">sound_speed_inf</span><span class="p">(</span><span class="n">flow</span><span class="p">))</span><span class="o">/</span><span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span>
<a name="ln-104"></a>
<a name="ln-105"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;sa&quot;</span><span class="p">)</span>
<a name="ln-106"></a>                     <span class="n">flow</span><span class="p">%</span><span class="n">tv_inf</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">mu_ratio_inf</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">/</span><span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span>
<a name="ln-107"></a>
<a name="ln-108"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;saBC&quot;</span><span class="p">)</span>
<a name="ln-109"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tv_inf</span> <span class="o">=</span> <span class="mf">0.005</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ratio_inf</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">/</span><span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span>
<a name="ln-110"></a>
<a name="ln-111"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;kw&quot;</span><span class="p">)</span>
<a name="ln-112"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="p">((</span><span class="n">flow</span><span class="p">%</span><span class="n">Vel_mag</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">Turb_Intensity_inf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-113"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tw_inf</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span><span class="o">/</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ratio_inf</span><span class="p">)</span>
<a name="ln-114"></a>
<a name="ln-115"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;ke&quot;</span><span class="p">)</span>
<a name="ln-116"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="p">((</span><span class="n">flow</span><span class="p">%</span><span class="n">Vel_mag</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">Turb_Intensity_inf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-117"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tw_inf</span> <span class="o">=</span> <span class="mf">0.09</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span><span class="o">/</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ratio_inf</span><span class="p">)</span>
<a name="ln-118"></a>
<a name="ln-119"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;des-sst&quot;</span><span class="p">)</span>
<a name="ln-120"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="p">((</span><span class="n">flow</span><span class="p">%</span><span class="n">Vel_mag</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">Turb_Intensity_inf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-121"></a>                    <span class="n">flow</span><span class="p">%</span><span class="n">tw_inf</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span><span class="o">/</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ratio_inf</span><span class="p">)</span>
<a name="ln-122"></a>
<a name="ln-123"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;les&quot;</span><span class="p">)</span>
<a name="ln-124"></a>                  <span class="k">continue</span>
<a name="ln-125"></a>                  <span class="c">! todo</span>
<a name="ln-126"></a>
<a name="ln-127"></a>                <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-128"></a>                  <span class="n">Fatal_error</span>
<a name="ln-129"></a>
<a name="ln-130"></a>            <span class="k">end select</span>
<a name="ln-131"></a>
<a name="ln-132"></a>
<a name="ln-133"></a><span class="k">        end subroutine </span><span class="n">init_infinity_values</span>
<a name="ln-134"></a>
<a name="ln-135"></a>
<a name="ln-136"></a>        
<a name="ln-137"></a>        <span class="k">function </span><span class="n">sound_speed_inf</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a name="ln-138"></a>            <span class="c">!&lt; Return the free stream speed of sound.</span>
<a name="ln-139"></a>            <span class="c">!-----------------------------------------------------------</span>
<a name="ln-140"></a>
<a name="ln-141"></a>            <span class="k">implicit none</span>
<a name="ln-142"></a><span class="k">            type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-143"></a>            <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-144"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-145"></a>            <span class="c">!&lt; output variable: speed of sound</span>
<a name="ln-146"></a>
<a name="ln-147"></a>            <span class="n">a</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span> <span class="o">*</span> <span class="n">flow</span><span class="p">%</span><span class="n">pressure_inf</span> <span class="o">/</span> <span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span><span class="p">)</span>
<a name="ln-148"></a>
<a name="ln-149"></a>        <span class="k">end function </span><span class="n">sound_speed_inf</span>
<a name="ln-150"></a>
<a name="ln-151"></a>
<a name="ln-152"></a>
<a name="ln-153"></a>        <span class="k">subroutine </span><span class="n">initstate</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">qp</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-154"></a>            <span class="c">!&lt; Initialize the state.</span>
<a name="ln-155"></a>            <span class="c">!&lt; If load file(start_from) is 0, then the state should be </span>
<a name="ln-156"></a>            <span class="c">!&lt; set to the infinity values. Otherwise, read the state_file</span>
<a name="ln-157"></a>            <span class="c">!&lt; to get the state values</span>
<a name="ln-158"></a>            <span class="c">!-----------------------------------------------------------</span>
<a name="ln-159"></a>
<a name="ln-160"></a>            <span class="k">implicit none</span>
<a name="ln-161"></a><span class="k">            type</span><span class="p">(</span><span class="n">filetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">files</span>
<a name="ln-162"></a>            <span class="c">!&lt; Files&#39; name and handler</span>
<a name="ln-163"></a>            <span class="k">type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-164"></a>            <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-165"></a>            <span class="k">type</span><span class="p">(</span><span class="n">controltype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">control</span>
<a name="ln-166"></a>            <span class="c">!&lt; Control parameters</span>
<a name="ln-167"></a>            <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-168"></a>            <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-169"></a>            <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-170"></a>            <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-171"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">qp</span>
<a name="ln-172"></a>            <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-173"></a>            
<a name="ln-174"></a>            <span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;initstate&quot;</span><span class="p">)</span>
<a name="ln-175"></a>
<a name="ln-176"></a>            <span class="k">call  </span><span class="n">verify_write_control</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">)</span>
<a name="ln-177"></a>
<a name="ln-178"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">control</span><span class="p">%</span><span class="n">start_from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-179"></a>                <span class="c">! Set the state to the infinity values</span>
<a name="ln-180"></a>                <span class="k">call </span><span class="n">init_state_with_infinity_values</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-181"></a>            <span class="k">else</span>
<a name="ln-182"></a><span class="k">                write</span><span class="p">(</span><span class="n">files</span><span class="p">%</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;(a,i4.4,a,i2.2)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-183"></a>                  <span class="s2">&quot;time_directories/&quot;</span><span class="p">,</span><span class="n">control</span><span class="p">%</span><span class="n">start_from</span><span class="p">,</span><span class="s2">&quot;/process_&quot;</span><span class="p">,</span><span class="n">process_id</span>
<a name="ln-184"></a>                <span class="c">! Set the state to the infinity values so if some</span>
<a name="ln-185"></a>                <span class="c">! variable are not restart variable they get free_stream value</span>
<a name="ln-186"></a>                <span class="k">call </span><span class="n">init_state_with_infinity_values</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-187"></a>                <span class="k">call </span><span class="n">read_file</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">qp</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-188"></a>
<a name="ln-189"></a>            <span class="k">end if</span>
<a name="ln-190"></a>
<a name="ln-191"></a><span class="k">        end subroutine </span><span class="n">initstate</span>
<a name="ln-192"></a>
<a name="ln-193"></a>
<a name="ln-194"></a>
<a name="ln-195"></a>        <span class="k">subroutine </span><span class="n">init_state_with_infinity_values</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-196"></a>            <span class="c">!&lt; Initialize the state based on the infinity values</span>
<a name="ln-197"></a>            <span class="c">!-----------------------------------------------------------</span>
<a name="ln-198"></a>            
<a name="ln-199"></a>            <span class="k">implicit none</span>
<a name="ln-200"></a><span class="k">            type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-201"></a>            <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-202"></a>            <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-203"></a>            <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-204"></a>            <span class="k">type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-205"></a>            <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-206"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">qp</span>
<a name="ln-207"></a>            <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-208"></a>            
<a name="ln-209"></a>            <span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;init_state_with_infinity_values&quot;</span><span class="p">)</span>
<a name="ln-210"></a>
<a name="ln-211"></a>            <span class="c">!density = density_inf</span>
<a name="ln-212"></a>            <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">density_inf</span>
<a name="ln-213"></a>            <span class="c">!x_speed = x_speed_inf</span>
<a name="ln-214"></a>            <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">x_speed_inf</span>
<a name="ln-215"></a>            <span class="c">!y_speed = y_speed_inf</span>
<a name="ln-216"></a>            <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">y_speed_inf</span>
<a name="ln-217"></a>            <span class="c">!z_speed = z_speed_inf</span>
<a name="ln-218"></a>            <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">z_speed_inf</span>
<a name="ln-219"></a>            <span class="c">!pressure = pressure_inf</span>
<a name="ln-220"></a>            <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">pressure_inf</span>
<a name="ln-221"></a>
<a name="ln-222"></a>            <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-223"></a>
<a name="ln-224"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a name="ln-225"></a>                    <span class="c">!include nothing</span>
<a name="ln-226"></a>                    <span class="k">continue</span>
<a name="ln-227"></a><span class="k">                </span>
<a name="ln-228"></a><span class="k">                case</span> <span class="p">(</span><span class="s2">&quot;sst&quot;</span><span class="p">,</span> <span class="s2">&quot;sst2003&quot;</span><span class="p">,</span> <span class="s2">&quot;bsl&quot;</span><span class="p">,</span> <span class="s2">&quot;des-sst&quot;</span><span class="p">,</span> <span class="s2">&quot;kw&quot;</span><span class="p">)</span>
<a name="ln-229"></a>                    <span class="c">!tk = tk_inf</span>
<a name="ln-230"></a>                    <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span>
<a name="ln-231"></a>                    <span class="c">!tw = tw_inf</span>
<a name="ln-232"></a>                    <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">tw_inf</span>
<a name="ln-233"></a>
<a name="ln-234"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;kkl&quot;</span><span class="p">)</span>
<a name="ln-235"></a>                    <span class="c">!tk = tk_inf</span>
<a name="ln-236"></a>                    <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span>
<a name="ln-237"></a>                    <span class="c">!tkl = tkl_inf</span>
<a name="ln-238"></a>                    <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">tkl_inf</span>
<a name="ln-239"></a>
<a name="ln-240"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;sa&quot;</span><span class="p">,</span> <span class="s2">&quot;saBC&quot;</span><span class="p">)</span>
<a name="ln-241"></a>                    <span class="c">!tv = tv_inf</span>
<a name="ln-242"></a>                    <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">tv_inf</span>
<a name="ln-243"></a>
<a name="ln-244"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;ke&quot;</span><span class="p">)</span>
<a name="ln-245"></a>                    <span class="c">!tk = tk_inf</span>
<a name="ln-246"></a>                    <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">tk_inf</span>
<a name="ln-247"></a>                    <span class="c">!te = te_inf</span>
<a name="ln-248"></a>                    <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">te_inf</span>
<a name="ln-249"></a>
<a name="ln-250"></a>                <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;les&quot;</span><span class="p">)</span>
<a name="ln-251"></a>                  <span class="k">continue</span>
<a name="ln-252"></a>                  <span class="c">! todo</span>
<a name="ln-253"></a>
<a name="ln-254"></a>                <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-255"></a>                  <span class="n">Fatal_error</span>
<a name="ln-256"></a>
<a name="ln-257"></a>            <span class="k">end select</span>
<a name="ln-258"></a>
<a name="ln-259"></a>
<a name="ln-260"></a>            <span class="c">! Transition modeling</span>
<a name="ln-261"></a>            <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">transition</span><span class="p">))</span>
<a name="ln-262"></a>
<a name="ln-263"></a>              <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lctm2015&#39;</span><span class="p">)</span>
<a name="ln-264"></a>                <span class="c">!tgm = tgm_inf</span>
<a name="ln-265"></a>                <span class="n">qp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">tgm_inf</span>
<a name="ln-266"></a>
<a name="ln-267"></a>              <span class="k">case</span><span class="p">(</span><span class="s1">&#39;bc&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-268"></a>                <span class="c">!do nothing</span>
<a name="ln-269"></a>                <span class="k">continue</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="k">              case </span><span class="n">DEFAULT</span>
<a name="ln-272"></a>                <span class="n">Fatal_error</span>
<a name="ln-273"></a>
<a name="ln-274"></a>            <span class="k">end Select</span>
<a name="ln-275"></a><span class="k">            </span>
<a name="ln-276"></a><span class="k">        end subroutine </span><span class="n">init_state_with_infinity_values</span>
<a name="ln-277"></a>
<a name="ln-278"></a>
<a name="ln-279"></a>
<a name="ln-280"></a>        <span class="k">subroutine </span><span class="n">set_n_var_value</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">)</span>
<a name="ln-281"></a>          <span class="c">!&lt; Set number of variable to solver for based on</span>
<a name="ln-282"></a>          <span class="c">!&lt; the tubulence and transition model being used</span>
<a name="ln-283"></a>          <span class="k">implicit none</span>
<a name="ln-284"></a><span class="k">          type</span><span class="p">(</span><span class="n">controltype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">control</span>
<a name="ln-285"></a>          <span class="c">!&lt; Control parameters</span>
<a name="ln-286"></a>          <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span><span class="n">scheme</span>
<a name="ln-287"></a>          <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-288"></a>
<a name="ln-289"></a>          <span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;set_n_var_value&quot;</span><span class="p">)</span>
<a name="ln-290"></a>
<a name="ln-291"></a>          <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-292"></a>            <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-293"></a>              <span class="n">n_var</span><span class="o">=</span><span class="mi">5</span>
<a name="ln-294"></a>
<a name="ln-295"></a>            <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-296"></a>              <span class="n">n_var</span><span class="o">=</span><span class="mi">6</span>
<a name="ln-297"></a>              
<a name="ln-298"></a>            <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s2">&quot;sst2003&quot;</span><span class="p">,</span> <span class="s1">&#39;bsl&#39;</span><span class="p">,</span> <span class="s1">&#39;kw&#39;</span><span class="p">,</span> <span class="s1">&#39;ke&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">,</span> <span class="s1">&#39;Des-kw&#39;</span><span class="p">)</span>
<a name="ln-299"></a>              <span class="n">n_var</span><span class="o">=</span><span class="mi">7</span>
<a name="ln-300"></a>
<a name="ln-301"></a>            <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-302"></a>              <span class="n">n_var</span><span class="o">=</span><span class="mi">5</span>
<a name="ln-303"></a>
<a name="ln-304"></a>          <span class="k">end select</span>
<a name="ln-305"></a>
<a name="ln-306"></a>
<a name="ln-307"></a>          <span class="c">!Transition modeling</span>
<a name="ln-308"></a>          <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">transition</span><span class="p">))</span>
<a name="ln-309"></a>            <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lctm2015&#39;</span><span class="p">)</span>
<a name="ln-310"></a>              <span class="n">n_var</span> <span class="o">=</span> <span class="n">n_var</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-311"></a>
<a name="ln-312"></a>            <span class="k">case</span><span class="p">(</span><span class="s1">&#39;bc&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-313"></a>              <span class="n">n_var</span> <span class="o">=</span> <span class="n">n_var</span> <span class="o">+</span> <span class="mi">0</span>
<a name="ln-314"></a>
<a name="ln-315"></a>            <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-316"></a>              <span class="n">Fatal_error</span>
<a name="ln-317"></a>
<a name="ln-318"></a>          <span class="k">end Select</span>
<a name="ln-319"></a>
<a name="ln-320"></a><span class="k">          </span><span class="n">control</span><span class="p">%</span><span class="n">n_var</span> <span class="o">=</span> <span class="n">n_var</span>
<a name="ln-321"></a>
<a name="ln-322"></a>        <span class="k">end subroutine </span><span class="n">set_n_var_value</span>
<a name="ln-323"></a>
<a name="ln-324"></a>
<a name="ln-325"></a><span class="k">end module </span><span class="n">state</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2019-12-28T21:23:55.181614 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST-3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>