<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>mapping.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>mapping.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.3% of total for source files.">256 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/mapping.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">mapping.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/mapping.html">mapping</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/mapping.f90.html#src">mapping.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>Setup the indicies map at interface between two blocks</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~mapping.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemappingf90EfferentGraph" width="389pt" height="128pt"
 viewBox="0.00 0.00 389.00 128.42" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~mapping.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 124.4197)">
<title>sourcefile~~mapping.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-124.4197 385,-124.4197 385,4 -4,4"/>
<!-- sourcefile~mapping.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~mapping.f90</title>
<polygon fill="none" stroke="#000000" points="381,-78.4197 309,-78.4197 309,-54.4197 381,-54.4197 381,-78.4197"/>
<text text-anchor="middle" x="345" y="-64.0197" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">mapping.f90</text>
</g>
<!-- sourcefile~string.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~string.f90</title>
<g id="a_sourcefile~~mapping.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/string.f90.html" xlink:title="string.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="273,-120.4197 216,-120.4197 216,-96.4197 273,-96.4197 273,-120.4197"/>
<text text-anchor="middle" x="244.5" y="-106.0197" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">string.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M316.2007,-78.4552C305.7928,-82.8048 293.8735,-87.786 282.7804,-92.4219"/>
<polygon fill="#ff0000" stroke="#ff0000" points="281.1806,-89.2971 273.3035,-96.3824 283.8798,-95.7558 281.1806,-89.2971"/>
</g>
<!-- sourcefile~utils.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~utils.f90</title>
<g id="a_sourcefile~~mapping.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/utils.f90.html" xlink:title="utils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="271.5,-78.4197 217.5,-78.4197 217.5,-54.4197 271.5,-54.4197 271.5,-78.4197"/>
<text text-anchor="middle" x="244.5" y="-64.0197" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M308.7172,-66.4197C299.9075,-66.4197 290.4756,-66.4197 281.6275,-66.4197"/>
<polygon fill="#ff0000" stroke="#ff0000" points="281.5809,-62.9198 271.5809,-66.4197 281.5809,-69.9198 281.5809,-62.9198"/>
</g>
<!-- sourcefile~global_vars.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~global_vars.f90</title>
<g id="a_sourcefile~~mapping.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/global_vars.f90.html" xlink:title="global_vars.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="180,-79.4197 95,-79.4197 95,-55.4197 180,-55.4197 180,-79.4197"/>
<text text-anchor="middle" x="137.5" y="-65.0197" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_vars.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.5,-25.4197C237.106,-23.9934 201.2348,-38.8493 173.0371,-51.2833"/>
<polygon fill="#ff0000" stroke="#ff0000" points="171.5369,-48.1199 163.8208,-55.3802 174.3804,-54.5164 171.5369,-48.1199"/>
</g>
<!-- sourcefile~fclose.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~fclose.f90</title>
<g id="a_sourcefile~~mapping.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/fclose.f90.html" xlink:title="fclose.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="166.5,-37.4197 108.5,-37.4197 108.5,-13.4197 166.5,-13.4197 166.5,-37.4197"/>
<text text-anchor="middle" x="137.5" y="-23.0197" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fclose.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~fclose.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~fclose.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.5,-25.4197C222.4437,-21.165 197.3507,-20.9297 177.0108,-21.866"/>
<polygon fill="#ff0000" stroke="#ff0000" points="176.6327,-18.3818 166.8489,-22.4473 177.0325,-25.3704 176.6327,-18.3818"/>
</g>
<!-- sourcefile~global.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~global.f90</title>
<g id="a_sourcefile~~mapping.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/global.f90.html" xlink:title="global.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="59,-37.4197 0,-37.4197 0,-13.4197 59,-13.4197 59,-37.4197"/>
<text text-anchor="middle" x="29.5" y="-23.0197" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M322.6421,-54.3039C302.7813,-44.2818 272.6244,-30.8449 244.5,-25.4197"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.5,-25.4197C214.8979,-19.7094 209.7752,-9.1447 180,-4.4197 142.6891,1.5012 132.3241,1.4172 95,-4.4197 86.3504,-5.7724 77.2831,-8.0725 68.7467,-10.6666"/>
<polygon fill="#ff0000" stroke="#ff0000" points="67.4658,-7.4022 59.0265,-13.8076 69.6183,-14.0631 67.4658,-7.4022"/>
</g>
<!-- sourcefile~utils.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~utils.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M217.4994,-66.672C209.2247,-66.7494 199.8186,-66.8373 190.4357,-66.925"/>
<polygon fill="#cbff00" stroke="#cbff00" points="190.2847,-63.4261 180.3179,-67.0195 190.3502,-70.4258 190.2847,-63.4261"/>
</g>
<!-- sourcefile~global_vars.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~global_vars.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M106.5515,-55.3842C94.8458,-50.832 81.3611,-45.5879 68.9771,-40.7719"/>
<polygon fill="#00ff66" stroke="#00ff66" points="69.9251,-37.3853 59.3365,-37.0228 67.388,-43.9093 69.9251,-37.3853"/>
</g>
<!-- sourcefile~fclose.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~mapping.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~fclose.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M108.2736,-25.4197C96.2462,-25.4197 82.1254,-25.4197 69.1863,-25.4197"/>
<polygon fill="#0066ff" stroke="#0066ff" points="69.1253,-21.9198 59.1253,-25.4197 69.1253,-28.9198 69.1253,-21.9198"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~mapping.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemappingf90AfferentGraph" width="641pt" height="192pt"
 viewBox="0.00 0.00 641.00 192.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~mapping.f90~~AfferentGraph" class="graph" transform="scale(.9771 .9771) rotate(0) translate(4 193)">
<title>sourcefile~~mapping.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-193 652,-193 652,4 -4,4"/>
<!-- sourcefile~mapping.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~mapping.f90</title>
<polygon fill="none" stroke="#000000" points="72,-87 0,-87 0,-63 72,-63 72,-87"/>
<text text-anchor="middle" x="36" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">mapping.f90</text>
</g>
<!-- sourcefile~plusgs.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~plusgs.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/plusgs.f90.html" xlink:title="plusgs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="177.5,-66 116.5,-66 116.5,-42 177.5,-42 177.5,-66"/>
<text text-anchor="middle" x="147" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">plusgs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M116.3749,-59.7939C105.7537,-61.8034 93.6,-64.1027 82.0146,-66.2945"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.2076,-62.885 72.0325,-68.183 82.5089,-69.763 81.2076,-62.885"/>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="410.5,-147 351.5,-147 351.5,-123 410.5,-123 410.5,-147"/>
<text text-anchor="middle" x="381" y="-132.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M254,-136C206.6304,-131.799 191.7752,-152.0223 147,-136"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M147,-136C116.3848,-125.0447 84.1018,-106.3923 62.2929,-92.5904"/>
<polygon fill="#ff0000" stroke="#ff0000" points="63.9258,-89.479 53.623,-87.0088 60.1367,-95.3648 63.9258,-89.479"/>
</g>
<!-- sourcefile~interface1.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~interface1.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/interface1.f90.html" xlink:title="interface1.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="186,-108 108,-108 108,-84 186,-84 186,-108"/>
<text text-anchor="middle" x="147" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interface1.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~interface1.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~interface1.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M351.4242,-136.839C325.6436,-138.059 287.2741,-138.951 254,-136"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M254,-136C227.1046,-133.6147 198.5526,-122.4529 177.7132,-112.5244"/>
<polygon fill="#00ff66" stroke="#00ff66" points="179.2313,-109.3706 168.7147,-108.0854 176.1344,-115.6483 179.2313,-109.3706"/>
</g>
<!-- sourcefile~grid.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~grid.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/grid.f90.html" xlink:title="grid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281,-188 227,-188 227,-164 281,-164 281,-188"/>
<text text-anchor="middle" x="254" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M351.2241,-144.6127C333.2436,-150.4174 310.181,-157.8628 291.0305,-164.0453"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="289.8614,-160.7448 281.4203,-167.1478 292.012,-167.4062 289.8614,-160.7448"/>
</g>
<!-- sourcefile~update.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~update.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/update.f90.html" xlink:title="update.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="286,-87 222,-87 222,-63 286,-63 286,-87"/>
<text text-anchor="middle" x="254" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">update.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~update.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~update.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M355.2997,-122.8581C336.1921,-113.8309 309.9052,-101.4119 288.8979,-91.4872"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="290.199,-88.231 279.6621,-87.1238 287.2087,-94.5602 290.199,-88.231"/>
</g>
<!-- sourcefile~interface1.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~interface1.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M107.8656,-88.5962C99.5212,-87.0175 90.6347,-85.3363 82.0582,-83.7137"/>
<polygon fill="#ff0000" stroke="#ff0000" points="82.6599,-80.2655 72.1836,-81.8455 81.3586,-87.1435 82.6599,-80.2655"/>
</g>
<!-- sourcefile~lusgs.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~lusgs.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/lusgs.f90.html" xlink:title="lusgs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="174.5,-24 119.5,-24 119.5,0 174.5,0 174.5,-24"/>
<text text-anchor="middle" x="147" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lusgs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M124.2437,-24.0848C118.8962,-26.9711 113.232,-30.0665 108,-33 93.8814,-40.9161 78.3555,-49.9325 65.3472,-57.5766"/>
<polygon fill="#ff0000" stroke="#ff0000" points="63.2135,-54.7715 56.3763,-62.8648 66.7683,-60.8017 63.2135,-54.7715"/>
</g>
<!-- sourcefile~grid.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~grid.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.8109,-165.5944C205.2306,-157.3937 174.2618,-145.7553 147,-136"/>
</g>
<!-- sourcefile~create_and_erase.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~create_and_erase.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/create_and_erase.f90.html" xlink:title="create_and_erase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440,-189 322,-189 322,-165 440,-165 440,-189"/>
<text text-anchor="middle" x="381" y="-174.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">create_and_erase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~create_and_erase.f90&#45;&gt;sourcefile~grid.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~create_and_erase.f90&#45;&gt;sourcefile~grid.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M321.9616,-176.5351C311.4962,-176.4527 300.8685,-176.369 291.2228,-176.2931"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="291.2233,-172.7931 281.196,-176.2141 291.1681,-179.7929 291.2233,-172.7931"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="648,-147 594,-147 594,-123 648,-123 648,-147"/>
<text text-anchor="middle" x="621" y="-132.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M593.7124,-135.5275C582.6304,-135.7172 569.7042,-135.9071 558,-136 510.8741,-136.374 456.6893,-135.941 420.8157,-135.5337"/>
<polygon fill="#cbff00" stroke="#cbff00" points="420.7926,-132.0333 410.7519,-135.4146 420.7098,-139.0328 420.7926,-132.0333"/>
</g>
<!-- sourcefile~start_finish.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~start_finish.f90</title>
<g id="a_sourcefile~~mapping.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/start_finish.f90.html" xlink:title="start_finish.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="558,-127 476,-127 476,-103 558,-103 558,-127"/>
<text text-anchor="middle" x="517" y="-112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_finish.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~start_finish.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~start_finish.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M593.9467,-129.7974C585.9882,-128.267 577.0079,-126.54 568.0646,-124.8201"/>
<polygon fill="#00ffff" stroke="#00ffff" points="568.5205,-121.3437 558.0394,-122.8922 567.1985,-128.2178 568.5205,-121.3437"/>
</g>
<!-- sourcefile~start_finish.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~start_finish.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M475.8264,-121.0549C458.4753,-123.6066 438.3489,-126.5663 421.1136,-129.1009"/>
<polygon fill="#cbff00" stroke="#cbff00" points="420.1907,-125.6989 410.8064,-130.6167 421.2092,-132.6244 420.1907,-125.6989"/>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~plusgs.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~plusgs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M221.8965,-68.6993C211.1508,-66.5903 199.0264,-64.2108 187.7124,-61.9903"/>
<polygon fill="#ff0000" stroke="#ff0000" points="188.0995,-58.4996 177.6127,-60.0081 186.7514,-65.3685 188.0995,-58.4996"/>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~interface1.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~interface1.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M221.8965,-81.3007C213.844,-82.8811 205.0172,-84.6135 196.3374,-86.317"/>
<polygon fill="#00ff66" stroke="#00ff66" points="195.4095,-82.9322 186.2708,-88.2926 196.7577,-89.8012 195.4095,-82.9322"/>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~lusgs.f90 -->
<g id="sourcefile~~mapping.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~lusgs.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M235.1299,-62.9276C221.5831,-54.3638 202.8234,-42.7134 186,-33 183.7857,-31.7215 181.4886,-30.4208 179.1677,-29.1254"/>
<polygon fill="#0066ff" stroke="#0066ff" points="180.6723,-25.9586 170.2223,-24.2122 177.3024,-32.0941 180.6723,-25.9586"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemappingf90AfferentGraph = svgPanZoom('#sourcefilemappingf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/mapping.html">mapping</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/mapping.f90.html#src">mapping.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>  <span class="c">!&lt; Setup the indicies map at interface between two blocks</span>
<a name="ln-2"></a><span class="k">module </span><span class="n">mapping</span>
<a name="ln-3"></a>  <span class="c">!&lt; Setup the indicies map at interface between two blocks</span>
<a name="ln-4"></a>
<a name="ln-5"></a>  <span class="k">use </span><span class="n">global</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">MAP_FILE_UNIT</span>
<a name="ln-6"></a>  <span class="k">use </span><span class="n">global</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mapfile</span>
<a name="ln-7"></a>  <span class="k">use </span><span class="n">global</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">PERIODIC_FILE_UNIT</span>
<a name="ln-8"></a>  <span class="k">use </span><span class="n">global</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">periodicfile</span>
<a name="ln-9"></a>
<a name="ln-10"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">total_process</span>
<a name="ln-11"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">process_id</span>
<a name="ln-12"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">PbcId</span>
<a name="ln-13"></a>
<a name="ln-14"></a>  <span class="k">use </span><span class="n">utils</span>      <span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">DEBUG_LEVEL</span>
<a name="ln-15"></a>  <span class="k">use </span><span class="n">utils</span>      <span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dmsg</span>
<a name="ln-16"></a>  <span class="k">use </span><span class="n">string</span>
<a name="ln-17"></a>  <span class="k">use </span><span class="n">fclose</span>     <span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">close_file</span>
<a name="ln-18"></a>
<a name="ln-19"></a>  <span class="c">!map variablews</span>
<a name="ln-20"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">imx</span>
<a name="ln-21"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">jmx</span>
<a name="ln-22"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kmx</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">otherface</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">dir_switch</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">imin_id</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">imax_id</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">jmin_id</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">jmax_id</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kmin_id</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kmax_id</span>
<a name="ln-31"></a>
<a name="ln-32"></a>  <span class="k">implicit none</span>
<a name="ln-33"></a><span class="k">  private</span>
<a name="ln-34"></a><span class="k">  </span><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ilo</span>
<a name="ln-35"></a>  <span class="c">!&lt; Read Lowest index of I direction</span>
<a name="ln-36"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">jlo</span>
<a name="ln-37"></a>  <span class="c">!&lt; Read Lowest index of J direction</span>
<a name="ln-38"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">klo</span>
<a name="ln-39"></a>  <span class="c">!&lt; Read Lowest index of K direction</span>
<a name="ln-40"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ihi</span>
<a name="ln-41"></a>  <span class="c">!&lt; Read Highest index of I direction</span>
<a name="ln-42"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">jhi</span>
<a name="ln-43"></a>  <span class="c">!&lt; Read Highest index of J direction</span>
<a name="ln-44"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">khi</span>
<a name="ln-45"></a>  <span class="c">!&lt; Read Highest index of K direction</span>
<a name="ln-46"></a>
<a name="ln-47"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Pilo</span>
<a name="ln-48"></a>  <span class="c">!&lt; Modified lowest index of I direction</span>
<a name="ln-49"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Pjlo</span>
<a name="ln-50"></a>  <span class="c">!&lt; Modified lowest index of J direction</span>
<a name="ln-51"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Pklo</span>
<a name="ln-52"></a>  <span class="c">!&lt; Modified lowest index of K direction</span>
<a name="ln-53"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Pihi</span>
<a name="ln-54"></a>  <span class="c">!&lt; Modified Highest index of I direction</span>
<a name="ln-55"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Pjhi</span>
<a name="ln-56"></a>  <span class="c">!&lt; Modified Highest index of J direction</span>
<a name="ln-57"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Pkhi</span>
<a name="ln-58"></a>  <span class="c">!&lt; Modified Highest index of K direction</span>
<a name="ln-59"></a>
<a name="ln-60"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">PiDir</span>
<a name="ln-61"></a>  <span class="c">!&lt; Switch for communication direction from </span>
<a name="ln-62"></a>  <span class="c">!&lt; (low-high) to (hight-low) for I direction</span>
<a name="ln-63"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">PjDir</span>
<a name="ln-64"></a>  <span class="c">!&lt; Switch for communication direction from </span>
<a name="ln-65"></a>  <span class="c">!&lt; (low-high) to (hight-low) for J direction</span>
<a name="ln-66"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">PkDir</span>
<a name="ln-67"></a>  <span class="c">!&lt; Switch for communication direction from </span>
<a name="ln-68"></a>  <span class="c">!&lt; (low-high) to (hight-low) for K direction</span>
<a name="ln-69"></a>
<a name="ln-70"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Gilo</span>
<a name="ln-71"></a>  <span class="c">!&lt; Modified lowest index of I direction for Grid data exchange</span>
<a name="ln-72"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Gjlo</span>
<a name="ln-73"></a>  <span class="c">!&lt; Modified lowest index of J direction for Grid data exchange</span>
<a name="ln-74"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Gklo</span>
<a name="ln-75"></a>  <span class="c">!&lt; Modified lowest index of K direction for Grid data exchange</span>
<a name="ln-76"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Gihi</span>
<a name="ln-77"></a>  <span class="c">!&lt; Modified highest index of I direction for Grid data exchange</span>
<a name="ln-78"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Gjhi</span>
<a name="ln-79"></a>  <span class="c">!&lt; Modified highest index of J direction for Grid data exchange</span>
<a name="ln-80"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Gkhi</span>
<a name="ln-81"></a>  <span class="c">!&lt; Modified highest index of K direction for Grid data exchange</span>
<a name="ln-82"></a>  
<a name="ln-83"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">mpi_class</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-84"></a>  <span class="c">!&lt; Class flag for master or slave</span>
<a name="ln-85"></a>
<a name="ln-86"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">read_interface_map</span>
<a name="ln-87"></a>
<a name="ln-88"></a>    <span class="k">contains</span>
<a name="ln-89"></a>
<a name="ln-90"></a><span class="k">      subroutine </span><span class="n">read_interface_map</span><span class="p">()</span>
<a name="ln-91"></a>        <span class="c">!&lt; Read mapping file in the system/mesh/layout/mapping.txt</span>
<a name="ln-92"></a>        <span class="k">implicit none</span>
<a name="ln-93"></a><span class="k">        </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-94"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">max_call</span>
<a name="ln-95"></a>
<a name="ln-96"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-97"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span>
<a name="ln-98"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">s11</span><span class="p">,</span><span class="n">s12</span><span class="p">,</span><span class="n">s21</span><span class="p">,</span><span class="n">s22</span>
<a name="ln-99"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">e11</span><span class="p">,</span><span class="n">e12</span><span class="p">,</span><span class="n">e21</span><span class="p">,</span><span class="n">e22</span>
<a name="ln-100"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">switch</span>
<a name="ln-101"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="k">class</span>
<a name="ln-102"></a>        <span class="c">!--- initialize indicies --!</span>
<a name="ln-103"></a>        <span class="n">max_call</span> <span class="o">=</span> <span class="n">total_process</span><span class="o">*</span><span class="mi">6</span>
<a name="ln-104"></a>        <span class="n">ilo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">ihi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-105"></a>        <span class="n">ilo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">imx</span><span class="p">;</span> <span class="n">ihi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">imx</span>
<a name="ln-106"></a>        <span class="n">ilo</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">ihi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">imx</span>
<a name="ln-107"></a>        <span class="n">ilo</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">ihi</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">imx</span>
<a name="ln-108"></a>        <span class="n">ilo</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">ihi</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">imx</span>
<a name="ln-109"></a>        <span class="n">ilo</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">ihi</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">imx</span>
<a name="ln-110"></a>
<a name="ln-111"></a>        <span class="n">jlo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">jhi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">jmx</span>
<a name="ln-112"></a>        <span class="n">jlo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">jhi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">jmx</span>
<a name="ln-113"></a>        <span class="n">jlo</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">jhi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-114"></a>        <span class="n">jlo</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">jmx</span><span class="p">;</span> <span class="n">jhi</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">jmx</span>
<a name="ln-115"></a>        <span class="n">jlo</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">jhi</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">jmx</span>
<a name="ln-116"></a>        <span class="n">jlo</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">jhi</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">jmx</span>
<a name="ln-117"></a>
<a name="ln-118"></a>        <span class="n">klo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">khi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmx</span>
<a name="ln-119"></a>        <span class="n">klo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">khi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmx</span>
<a name="ln-120"></a>        <span class="n">klo</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">khi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmx</span>
<a name="ln-121"></a>        <span class="n">klo</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">khi</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmx</span>
<a name="ln-122"></a>        <span class="n">klo</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">;</span> <span class="n">khi</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-123"></a>        <span class="n">klo</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmx</span><span class="p">;</span> <span class="n">khi</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmx</span>
<a name="ln-124"></a>
<a name="ln-125"></a>        <span class="n">otherface</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-126"></a>        <span class="n">otherface</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-127"></a>        <span class="n">otherface</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-128"></a>        <span class="n">otherface</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-129"></a>        <span class="n">otherface</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mi">6</span>
<a name="ln-130"></a>        <span class="n">otherface</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span>
<a name="ln-131"></a>        <span class="n">dir_switch</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-132"></a>        <span class="c">!--- end of variable intializaiton --!</span>
<a name="ln-133"></a>
<a name="ln-134"></a>        <span class="c">!--- reading map file  ---!</span>
<a name="ln-135"></a>
<a name="ln-136"></a>        <span class="k">open</span><span class="p">(</span><span class="n">MAP_FILE_UNIT</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">mapfile</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">)</span>
<a name="ln-137"></a>        <span class="k">read</span><span class="p">(</span><span class="n">MAP_FILE_UNIT</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="c">! ignore header</span>
<a name="ln-138"></a>        <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">max_call</span>
<a name="ln-139"></a>          <span class="k">read</span><span class="p">(</span><span class="n">MAP_FILE_UNIT</span><span class="p">,</span><span class="o">*</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span> <span class="n">b1</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">s11</span><span class="p">,</span><span class="n">e11</span><span class="p">,</span><span class="n">s12</span><span class="p">,</span><span class="n">e12</span><span class="p">,&amp;</span>
<a name="ln-140"></a>                                            <span class="n">b2</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">s21</span><span class="p">,</span><span class="n">e21</span><span class="p">,</span><span class="n">s22</span><span class="p">,</span><span class="n">e22</span><span class="p">,</span><span class="n">switch</span><span class="p">,</span><span class="k">class</span>
<a name="ln-141"></a><span class="k">          if</span><span class="p">(</span><span class="nb">is_iostat_end</span><span class="p">(</span><span class="n">ios</span><span class="p">))</span> <span class="k">EXIT</span>
<a name="ln-142"></a><span class="k">          if</span><span class="p">(</span><span class="n">b1</span><span class="o">==</span><span class="n">process_id</span><span class="p">)</span><span class="k">then</span>
<a name="ln-143"></a><span class="k">            if</span><span class="p">(</span><span class="n">f1</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-144"></a><span class="k">              </span><span class="n">otherface</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">f2</span>
<a name="ln-145"></a>              <span class="n">jlo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">s21</span>
<a name="ln-146"></a>              <span class="n">jhi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">e21</span>
<a name="ln-147"></a>              <span class="n">klo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">s22</span>
<a name="ln-148"></a>              <span class="n">khi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">e22</span>
<a name="ln-149"></a>              <span class="n">dir_switch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">switch</span>
<a name="ln-150"></a>              <span class="n">mpi_class</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="k">class</span>
<a name="ln-151"></a><span class="k">            </span><span class="n">elseif</span><span class="p">(</span><span class="n">f1</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-152"></a><span class="k">              </span><span class="n">otherface</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">f2</span>
<a name="ln-153"></a>              <span class="n">jlo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">s21</span>
<a name="ln-154"></a>              <span class="n">jhi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">e21</span>
<a name="ln-155"></a>              <span class="n">klo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">s22</span>
<a name="ln-156"></a>              <span class="n">khi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">e22</span>
<a name="ln-157"></a>              <span class="n">dir_switch</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">switch</span>
<a name="ln-158"></a>              <span class="n">mpi_class</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="k">class</span>
<a name="ln-159"></a><span class="k">            </span><span class="n">elseif</span><span class="p">(</span><span class="n">f1</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-160"></a><span class="k">              </span><span class="n">otherface</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">f2</span>
<a name="ln-161"></a>              <span class="n">ilo</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">s21</span>
<a name="ln-162"></a>              <span class="n">ihi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">e21</span>
<a name="ln-163"></a>              <span class="n">klo</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">s22</span>
<a name="ln-164"></a>              <span class="n">khi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">e22</span>
<a name="ln-165"></a>              <span class="n">dir_switch</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">switch</span>
<a name="ln-166"></a>              <span class="n">mpi_class</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="k">class</span>
<a name="ln-167"></a><span class="k">            </span><span class="n">elseif</span><span class="p">(</span><span class="n">f1</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-168"></a><span class="k">              </span><span class="n">otherface</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">f2</span>
<a name="ln-169"></a>              <span class="n">ilo</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">s21</span>
<a name="ln-170"></a>              <span class="n">ihi</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">e21</span>
<a name="ln-171"></a>              <span class="n">klo</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">s22</span>
<a name="ln-172"></a>              <span class="n">khi</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">e22</span>
<a name="ln-173"></a>              <span class="n">dir_switch</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">switch</span>
<a name="ln-174"></a>              <span class="n">mpi_class</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="k">class</span>
<a name="ln-175"></a><span class="k">            </span><span class="n">elseif</span><span class="p">(</span><span class="n">f1</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-176"></a><span class="k">              </span><span class="n">otherface</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">f2</span>
<a name="ln-177"></a>              <span class="n">ilo</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">s21</span>
<a name="ln-178"></a>              <span class="n">ihi</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">e21</span>
<a name="ln-179"></a>              <span class="n">jlo</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">s22</span>
<a name="ln-180"></a>              <span class="n">jhi</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">e22</span>
<a name="ln-181"></a>              <span class="n">dir_switch</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">switch</span>
<a name="ln-182"></a>              <span class="n">mpi_class</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="k">class</span>
<a name="ln-183"></a><span class="k">            </span><span class="n">elseif</span><span class="p">(</span><span class="n">f1</span><span class="o">==</span><span class="mi">6</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-184"></a><span class="k">              </span><span class="n">otherface</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">f2</span>
<a name="ln-185"></a>              <span class="n">ilo</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">s21</span>
<a name="ln-186"></a>              <span class="n">ihi</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">e21</span>
<a name="ln-187"></a>              <span class="n">jlo</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">s22</span>
<a name="ln-188"></a>              <span class="n">jhi</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">e22</span>
<a name="ln-189"></a>              <span class="n">dir_switch</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">switch</span>
<a name="ln-190"></a>              <span class="n">mpi_class</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="k">class</span>
<a name="ln-191"></a><span class="k">            end if</span>
<a name="ln-192"></a><span class="k">          else </span>
<a name="ln-193"></a><span class="k">            continue</span>
<a name="ln-194"></a><span class="k">          end if</span>
<a name="ln-195"></a><span class="k">        end do</span>
<a name="ln-196"></a>
<a name="ln-197"></a><span class="k">        call </span><span class="n">close_file</span><span class="p">(</span><span class="n">MAP_FILE_UNIT</span><span class="p">)</span>
<a name="ln-198"></a>        <span class="k">call </span><span class="n">change_map_to_particular_range</span><span class="p">()</span>
<a name="ln-199"></a>
<a name="ln-200"></a>        <span class="k">call </span><span class="n">read_periodic_bc_file</span><span class="p">()</span>
<a name="ln-201"></a>      <span class="k">end subroutine </span><span class="n">read_interface_map</span>
<a name="ln-202"></a>
<a name="ln-203"></a>      <span class="k">subroutine </span><span class="n">change_map_to_particular_range</span><span class="p">()</span>
<a name="ln-204"></a>        <span class="c">!&lt; Modified the indicies for MPI communication</span>
<a name="ln-205"></a>        <span class="c">!-------------------------------------</span>
<a name="ln-206"></a>        <span class="c">!eg: 1-kmx to 0 to kmx for data transfer</span>
<a name="ln-207"></a>        <span class="c">!--------------------------------------</span>
<a name="ln-208"></a>        <span class="k">implicit none</span>
<a name="ln-209"></a><span class="k">        </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-210"></a>        <span class="n">Pilo</span><span class="o">=</span><span class="n">ilo</span>
<a name="ln-211"></a>        <span class="n">Pjlo</span><span class="o">=</span><span class="n">jlo</span>
<a name="ln-212"></a>        <span class="n">Pklo</span><span class="o">=</span><span class="n">klo</span>
<a name="ln-213"></a>        <span class="n">Pihi</span><span class="o">=</span><span class="n">ihi</span>
<a name="ln-214"></a>        <span class="n">Pjhi</span><span class="o">=</span><span class="n">jhi</span>
<a name="ln-215"></a>        <span class="n">Pkhi</span><span class="o">=</span><span class="n">khi</span>
<a name="ln-216"></a>        <span class="n">PiDir</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-217"></a>        <span class="n">PjDir</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-218"></a>        <span class="n">PkDir</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-219"></a>        <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-220"></a>          <span class="k">if</span><span class="p">(</span><span class="n">ilo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-221"></a><span class="k">            </span><span class="n">Pilo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-222"></a>            <span class="n">Gilo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">2</span>
<a name="ln-223"></a>          <span class="k">end if</span>
<a name="ln-224"></a><span class="k">          if</span><span class="p">(</span><span class="n">jlo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">4</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-225"></a><span class="k">            </span><span class="n">Pjlo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-226"></a>            <span class="n">Gjlo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">2</span>
<a name="ln-227"></a>          <span class="k">end if</span>
<a name="ln-228"></a><span class="k">          if</span><span class="p">(</span><span class="n">klo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">)</span><span class="k">then</span>
<a name="ln-229"></a><span class="k">            </span><span class="n">Pklo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-230"></a>            <span class="n">Gklo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">2</span>
<a name="ln-231"></a>          <span class="k">end if</span>
<a name="ln-232"></a><span class="k">          if</span><span class="p">(</span><span class="n">ihi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-233"></a><span class="k">            </span><span class="n">Pihi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>          
<a name="ln-234"></a>            <span class="n">Gihi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">2</span>         
<a name="ln-235"></a>            <span class="n">PiDir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-236"></a>          <span class="k">end if               </span>
<a name="ln-237"></a><span class="k">          if</span><span class="p">(</span><span class="n">jhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">4</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">))</span><span class="k">then</span>
<a name="ln-238"></a><span class="k">            </span><span class="n">Pjhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>          
<a name="ln-239"></a>            <span class="n">Gjhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">2</span>          
<a name="ln-240"></a>            <span class="n">PjDir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-241"></a>          <span class="k">end if               </span>
<a name="ln-242"></a><span class="k">          if</span><span class="p">(</span><span class="n">khi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">)</span><span class="k">then</span>
<a name="ln-243"></a><span class="k">            </span><span class="n">Pkhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-244"></a>            <span class="n">Gkhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">2</span>
<a name="ln-245"></a>            <span class="n">PkDir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-246"></a>          <span class="k">end if</span>
<a name="ln-247"></a><span class="k">          if</span><span class="p">(</span><span class="n">ilo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-248"></a><span class="k">            </span><span class="n">Gilo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span>
<a name="ln-249"></a>            <span class="n">Pilo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-250"></a>            <span class="n">PiDir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-251"></a>          <span class="k">end if</span>
<a name="ln-252"></a><span class="k">          if</span><span class="p">(</span><span class="n">jlo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">4</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-253"></a><span class="k">            </span><span class="n">Gjlo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span>
<a name="ln-254"></a>            <span class="n">Pjlo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-255"></a>            <span class="n">PjDir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-256"></a>          <span class="k">end if</span>
<a name="ln-257"></a><span class="k">          if</span><span class="p">(</span><span class="n">klo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-258"></a><span class="k">            </span><span class="n">Gklo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span>
<a name="ln-259"></a>            <span class="n">Pklo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-260"></a>            <span class="n">PkDir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-261"></a>          <span class="k">end if</span>
<a name="ln-262"></a><span class="k">          if</span><span class="p">(</span><span class="n">ihi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-263"></a><span class="k">            </span><span class="n">Gihi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span>
<a name="ln-264"></a>            <span class="n">Pihi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-265"></a>          <span class="k">end if</span>
<a name="ln-266"></a><span class="k">          if</span><span class="p">(</span><span class="n">jhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">4</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-267"></a><span class="k">            </span><span class="n">Gjhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span>
<a name="ln-268"></a>            <span class="n">Pjhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-269"></a>          <span class="k">end if</span>
<a name="ln-270"></a><span class="k">          if</span><span class="p">(</span><span class="n">khi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-271"></a><span class="k">            </span><span class="n">Gkhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span>
<a name="ln-272"></a>            <span class="n">Pkhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-273"></a>          <span class="k">end if</span>
<a name="ln-274"></a><span class="k">        end do</span>
<a name="ln-275"></a><span class="k">        </span>
<a name="ln-276"></a><span class="k">      end subroutine </span><span class="n">change_map_to_particular_range</span>
<a name="ln-277"></a>          
<a name="ln-278"></a>
<a name="ln-279"></a>      <span class="k">subroutine </span><span class="n">read_periodic_bc_file</span><span class="p">()</span>
<a name="ln-280"></a>        <span class="c">!&lt; Read periodic.md file in the system/mesh/layout/periodic.md</span>
<a name="ln-281"></a>        <span class="k">implicit none</span>
<a name="ln-282"></a><span class="k">        </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-283"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">max_call</span>
<a name="ln-284"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-285"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span>
<a name="ln-286"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span>
<a name="ln-287"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="k">class</span>
<a name="ln-288"></a>
<a name="ln-289"></a><span class="k">        open</span><span class="p">(</span><span class="n">PERIODIC_FILE_UNIT</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">periodicfile</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">)</span>
<a name="ln-290"></a>        <span class="k">read</span><span class="p">(</span><span class="n">PERIODIC_FILE_UNIT</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="c">!ignore first line (header)</span>
<a name="ln-291"></a>        <span class="n">max_call</span> <span class="o">=</span> <span class="n">total_process</span><span class="o">*</span><span class="mi">6</span>
<a name="ln-292"></a>        <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">max_call</span>
<a name="ln-293"></a>          <span class="k">read</span><span class="p">(</span><span class="n">PERIODIC_FILE_UNIT</span><span class="p">,</span><span class="o">*</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span> <span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span> <span class="k">class</span>
<a name="ln-294"></a><span class="k">          if</span><span class="p">(</span><span class="nb">is_iostat_end</span><span class="p">(</span><span class="n">ios</span><span class="p">))</span> <span class="k">EXIT</span>
<a name="ln-295"></a><span class="k">          if</span><span class="p">(</span><span class="n">b1</span><span class="o">==</span><span class="n">process_id</span><span class="p">)</span><span class="k">then</span>
<a name="ln-296"></a><span class="k">            </span><span class="n">PbcId</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span> <span class="o">=</span> <span class="n">b2</span>
<a name="ln-297"></a>          <span class="k">end if</span>
<a name="ln-298"></a><span class="k">        end do</span>
<a name="ln-299"></a><span class="k">        close</span><span class="p">(</span><span class="n">PERIODIC_FILE_UNIT</span><span class="p">)</span>
<a name="ln-300"></a>      <span class="k">end subroutine </span><span class="n">read_periodic_bc_file</span>
<a name="ln-301"></a>
<a name="ln-302"></a><span class="k">end module </span><span class="n">mapping</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2019-05-14T21:49:25.151673 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>