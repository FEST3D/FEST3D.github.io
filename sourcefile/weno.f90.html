<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST-3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>weno.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140495700-1"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
   
     gtag('config', 'UA-140495700-1');
   </script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>weno.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for source files.">71 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/weno.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">weno.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/weno.html">weno</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/weno.f90.html#src">weno.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>Higher face state reconstuction method: WENO</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~weno.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilewenof90EfferentGraph" width="171pt" height="32pt"
 viewBox="0.00 0.00 171.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~weno.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~weno.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 167,-28 167,4 -4,4"/>
<!-- sourcefile~weno.f90 -->
<g id="sourcefile~~weno.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~weno.f90</title>
<polygon fill="none" stroke="#000000" points="163,-24 107,-24 107,0 163,0 163,-24"/>
<text text-anchor="middle" x="135" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">weno.f90</text>
</g>
<!-- sourcefile~vartypes.f90 -->
<g id="sourcefile~~weno.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~vartypes.f90</title>
<g id="a_sourcefile~~weno.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/vartypes.f90.html" xlink:title="vartypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vartypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~weno.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~weno.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~weno.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M106.7534,-12C98.8248,-12 89.9938,-12 81.3229,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.2812,-8.5001 71.2812,-12 81.2812,-15.5001 81.2812,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~weno.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilewenof90AfferentGraph" width="641pt" height="136pt"
 viewBox="0.00 0.00 641.00 136.11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~weno.f90~~AfferentGraph" class="graph" transform="scale(.7914 .7914) rotate(0) translate(4 168)">
<title>sourcefile~~weno.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-168 806,-168 806,4 -4,4"/>
<!-- sourcefile~weno.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~weno.f90</title>
<polygon fill="none" stroke="#000000" points="56,-84 0,-84 0,-60 56,-60 56,-84"/>
<text text-anchor="middle" x="28" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">weno.f90</text>
</g>
<!-- sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~face_interpolant.f90</title>
<g id="a_sourcefile~~weno.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/face_interpolant.f90.html" xlink:title="face_interpolant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="199,-84 92,-84 92,-60 199,-60 199,-84"/>
<text text-anchor="middle" x="145.5" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">face_interpolant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~face_interpolant.f90&#45;&gt;sourcefile~weno.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~face_interpolant.f90&#45;&gt;sourcefile~weno.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M91.9077,-72C83.2259,-72 74.3928,-72 66.1745,-72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="66.1512,-68.5001 56.1512,-72 66.1511,-75.5001 66.1512,-68.5001"/>
</g>
<!-- sourcefile~time.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~time.f90</title>
<g id="a_sourcefile~~weno.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/time.f90.html" xlink:title="time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="510,-164 456,-164 456,-140 510,-140 510,-164"/>
<text text-anchor="middle" x="483" y="-149.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M455.9044,-149.2096C424.1882,-145.8005 370.1274,-139.5451 324,-132"/>
</g>
<!-- sourcefile~boundary_state_reconstruction.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~boundary_state_reconstruction.f90</title>
<g id="a_sourcefile~~weno.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/boundary_state_reconstruction.f90.html" xlink:title="boundary_state_reconstruction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="413,-104 235,-104 235,-80 413,-80 413,-104"/>
<text text-anchor="middle" x="324" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">boundary_state_reconstruction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M234.75,-82C226.075,-81.028 217.4001,-80.056 209.0529,-79.1208"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.3835,-75.636 199.0559,-78.0007 208.604,-82.5925 209.3835,-75.636"/>
</g>
<!-- sourcefile~update.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~update.f90</title>
<g id="a_sourcefile~~weno.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/update.f90.html" xlink:title="update.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="617,-124 553,-124 553,-100 617,-100 617,-124"/>
<text text-anchor="middle" x="585" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">update.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483,-112C411.7765,-112 394.2894,-143.4973 324,-132"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M324,-132C284.0836,-125.4708 273.3943,-125.7212 235,-113 215.3351,-106.4844 194.2277,-96.9473 177.4523,-88.7106"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.6289,-85.3859 168.1194,-84.0439 175.4983,-91.6468 178.6289,-85.3859"/>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~time.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M554.3966,-124.0013C543.504,-128.273 531.125,-133.1274 519.7693,-137.5807"/>
<polygon fill="#ff0000" stroke="#ff0000" points="518.1484,-134.4567 510.1165,-141.3661 520.7041,-140.9736 518.1484,-134.4567"/>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~boundary_state_reconstruction.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~boundary_state_reconstruction.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M552.8425,-112C532.7632,-112 506.375,-112 483,-112"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M483,-112C455.8597,-112 426.3159,-109.0959 400.1412,-105.501"/>
<polygon fill="#cbff00" stroke="#cbff00" points="400.304,-101.9887 389.9092,-104.038 399.3131,-108.9182 400.304,-101.9887"/>
</g>
<!-- sourcefile~scheme.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~scheme.f90</title>
<g id="a_sourcefile~~weno.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/scheme.f90.html" xlink:title="scheme.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="517,-84 449,-84 449,-60 517,-60 517,-84"/>
<text text-anchor="middle" x="483" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scheme.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~scheme.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~scheme.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M554.3966,-99.9987C544.7023,-96.197 533.8308,-91.9337 523.5511,-87.9024"/>
<polygon fill="#0066ff" stroke="#0066ff" points="524.5219,-84.5236 513.9343,-84.1311 521.9662,-91.0404 524.5219,-84.5236"/>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.8214,-71.4141C437.4282,-71.2448 424.6676,-71.0833 413,-71 333.8909,-70.435 314.1099,-70.5581 235,-71 226.7352,-71.0462 218.0414,-71.1163 209.4535,-71.1985"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.4168,-67.6986 199.4527,-71.2998 209.4877,-74.6982 209.4168,-67.6986"/>
</g>
<!-- sourcefile~ausmp.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~ausmp.f90</title>
<g id="a_sourcefile~~weno.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/ausmp.f90.html" xlink:title="ausmP.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="356,-24 292,-24 292,0 356,0 356,-24"/>
<text text-anchor="middle" x="324" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ausmP.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~ausmp.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~ausmp.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M460.7291,-59.9926C447.1816,-52.9905 429.3865,-44.3216 413,-38 397.991,-32.2098 381.1371,-26.978 366.166,-22.7511"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="366.7186,-19.273 356.1481,-19.9908 364.8591,-26.0215 366.7186,-19.273"/>
</g>
<!-- sourcefile~ausmp.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~ausmp.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M291.6775,-20.7799C274.7048,-25.5569 253.6191,-31.7546 235,-38 218.5826,-43.5069 200.7053,-50.1624 185.2752,-56.1198"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.5774,-53.0248 175.5288,-59.9146 186.1173,-59.5478 183.5774,-53.0248"/>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~weno.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="712,-124 653,-124 653,-100 712,-100 712,-124"/>
<text text-anchor="middle" x="682.5" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~time.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M652.7973,-122.6978C641.6818,-126.3887 628.872,-130.2759 617,-133 584.7528,-140.3994 547.4398,-145.4072 520.3896,-148.4157"/>
<polygon fill="#ff0000" stroke="#ff0000" points="519.7655,-144.9624 510.1958,-149.509 520.512,-151.9225 519.7655,-144.9624"/>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~update.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~update.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M652.9822,-112C644.8447,-112 635.8557,-112 627.1525,-112"/>
<polygon fill="#00ff66" stroke="#00ff66" points="627.1352,-108.5001 617.1352,-112 627.1351,-115.5001 627.1352,-108.5001"/>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~scheme.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~scheme.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M652.7973,-101.3022C641.6818,-97.6113 628.872,-93.7241 617,-91 587.3811,-84.2037 553.4885,-79.425 527.2,-76.36"/>
<polygon fill="#0066ff" stroke="#0066ff" points="527.4898,-72.8706 517.1608,-75.2293 526.7063,-79.8266 527.4898,-72.8706"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~weno.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="802,-124 748,-124 748,-100 802,-100 802,-124"/>
<text text-anchor="middle" x="775" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~weno.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.7472,-112C739.791,-112 730.9269,-112 722.361,-112"/>
<polygon fill="#ff0000" stroke="#ff0000" points="722.1413,-108.5001 712.1413,-112 722.1413,-115.5001 722.1413,-108.5001"/>
</g>
</g>
</svg>
</div><script>var pansourcefilewenof90AfferentGraph = svgPanZoom('#sourcefilewenof90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/weno.html">weno</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/weno.f90.html#src">weno.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>    <span class="c">!&lt; Higher face state reconstuction method: WENO</span>
<a name="ln-2"></a><span class="k">module </span><span class="n">weno</span>
<a name="ln-3"></a>    <span class="c">!&lt;</span>
<a name="ln-4"></a>    <span class="c">!&lt; Reference: 1 Shu, C.-W., “High-order Finite Difference and Finite Volume </span>
<a name="ln-5"></a>    <span class="c">!&lt; WENO Schemes and Discontinuous Galerkin Methods for CFD,” </span>
<a name="ln-6"></a>    <span class="c">!&lt; International Journal of Computational Fluid Dynamics, vol. 17, 2003, pp. 107–118.</span>
<a name="ln-7"></a>    <span class="c">!&lt; Reference: 2 Huang, W. F., Ren, Y. X., and Jiang, X., </span>
<a name="ln-8"></a>    <span class="c">!&lt;“A simple algorithm to improve the performance of the WENO scheme on non-uniform grids,” </span>
<a name="ln-9"></a>    <span class="c">!&lt;Acta Mechanica Sinica/Lixue Xuebao, 2017, pp. 1–11.</span>
<a name="ln-10"></a>    <span class="c">!-----------------------------------------------------------------</span>
<a name="ln-11"></a>
<a name="ln-12"></a><span class="cp">#include &quot;../../debug.h&quot;</span>
<a name="ln-13"></a>
<a name="ln-14"></a>    <span class="k">use </span><span class="n">vartypes</span>
<a name="ln-15"></a>    <span class="k">implicit none</span>
<a name="ln-16"></a><span class="k">    private</span>
<a name="ln-17"></a>
<a name="ln-18"></a>    <span class="c">! Public members</span>
<a name="ln-19"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">compute_weno_states</span>
<a name="ln-20"></a>
<a name="ln-21"></a>    <span class="k">contains</span>
<a name="ln-22"></a><span class="k">        </span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="k">        subroutine </span><span class="n">compute_face_states</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">f_qp_left</span><span class="p">,</span> <span class="n">f_qp_right</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-25"></a>          <span class="c">!&lt; Subroutine to calculate state at the face, generalized for</span>
<a name="ln-26"></a>          <span class="c">!&lt; all direction : I,J, and K.</span>
<a name="ln-27"></a>            <span class="k">implicit none</span>
<a name="ln-28"></a>
<a name="ln-29"></a><span class="k">            type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-30"></a>            <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-31"></a>            <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flags</span>
<a name="ln-32"></a>            <span class="c">!&lt; flags for direction switch</span>
<a name="ln-33"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">qp</span>
<a name="ln-34"></a>            <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-35"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">flags</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">flags</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="o">-</span><span class="n">flags</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">flags</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="o">-</span><span class="n">flags</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">flags</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">f_qp_left</span><span class="p">,</span> <span class="n">f_qp_right</span>
<a name="ln-36"></a>            <span class="c">!&lt; primitive state variable at faces</span>
<a name="ln-37"></a>            <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span>
<a name="ln-38"></a>            <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i_f</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j_f</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">k_f</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-39"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">P</span> <span class="c">!&lt; polynomial approximation</span>
<a name="ln-40"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">!&lt; smoothness factor</span>
<a name="ln-41"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">w</span> <span class="c">!&lt; wieght</span>
<a name="ln-42"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g</span> <span class="c">!&lt; linear wieght</span>
<a name="ln-43"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">u</span> <span class="c">!&lt; state_variable</span>
<a name="ln-44"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">eps</span><span class="o">=</span><span class="err">1</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span>
<a name="ln-45"></a>
<a name="ln-46"></a>            <span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">1</span><span class="mf">0.0</span>
<a name="ln-47"></a>            <span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">6.0</span><span class="o">/</span><span class="mi">1</span><span class="mf">0.0</span>
<a name="ln-48"></a>            <span class="n">g</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.0</span><span class="o">/</span><span class="mi">1</span><span class="mf">0.0</span>
<a name="ln-49"></a>
<a name="ln-50"></a>
<a name="ln-51"></a>            <span class="n">i_f</span> <span class="o">=</span> <span class="n">flags</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-52"></a>            <span class="n">j_f</span> <span class="o">=</span> <span class="n">flags</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-53"></a>            <span class="n">k_f</span> <span class="o">=</span> <span class="n">flags</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-54"></a>
<a name="ln-55"></a>            <span class="k">do </span><span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="p">%</span><span class="n">n_var</span>
<a name="ln-56"></a>             <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">k_f</span><span class="p">,</span> <span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">k_f</span>
<a name="ln-57"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">j_f</span><span class="p">,</span> <span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j_f</span>
<a name="ln-58"></a>               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">i_f</span><span class="p">,</span> <span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">i_f</span>
<a name="ln-59"></a>                 <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i_f</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">j_f</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k_f</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>  <span class="c">!u_{i-2}</span>
<a name="ln-60"></a>                 <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">i_f</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">j_f</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">k_f</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>  <span class="c">!u_{i-1}</span>
<a name="ln-61"></a>                 <span class="n">u</span><span class="p">(</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span>      <span class="p">,</span><span class="n">j</span>      <span class="p">,</span><span class="n">k</span>      <span class="p">,</span><span class="n">l</span><span class="p">)</span>  <span class="c">!u_{i}</span>
<a name="ln-62"></a>                 <span class="n">U</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="n">i_f</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="n">j_f</span><span class="p">,</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="n">k_f</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>  <span class="c">!u_{i+1}</span>
<a name="ln-63"></a>                 <span class="n">U</span><span class="p">(</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i_f</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">j_f</span><span class="p">,</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k_f</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>  <span class="c">!u_{i+2}</span>
<a name="ln-64"></a>
<a name="ln-65"></a>                 <span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>  <span class="mf">7.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="mf">1.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">/</span><span class="mf">6.0</span>
<a name="ln-66"></a>                 <span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>  <span class="mf">5.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span>  <span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">6.0</span>
<a name="ln-67"></a>                 <span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span>  <span class="mf">5.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>  <span class="mf">1.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mf">6.0</span>
<a name="ln-68"></a>
<a name="ln-69"></a>                 <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="mf">3.0</span><span class="o">/</span><span class="mi">1</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">U</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>    <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mf">3.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-70"></a>                 <span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="mf">3.0</span><span class="o">/</span><span class="mi">1</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>    <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span>              <span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-71"></a>                 <span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="mf">3.0</span><span class="o">/</span><span class="mi">1</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">U</span><span class="p">(</span> <span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">U</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">3.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span><span class="o">+</span>    <span class="n">U</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-72"></a>
<a name="ln-73"></a>                 <span class="n">w</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(:)</span><span class="o">/</span><span class="p">(</span><span class="n">eps</span> <span class="o">+</span> <span class="n">B</span><span class="p">(:))</span><span class="o">**</span><span class="mi">2</span> 
<a name="ln-74"></a>                 <span class="n">f_qp_left</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">i_f</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">j_f</span><span class="p">,</span><span class="n">k</span><span class="o">+</span><span class="n">k_f</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>  <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">/</span><span class="nb">SUM</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="ln-75"></a>
<a name="ln-76"></a>                 <span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>  <span class="mf">7.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="mf">1.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">0</span><span class="p">))</span><span class="o">/</span><span class="mf">6.0</span> 
<a name="ln-77"></a>                 <span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>  <span class="mf">5.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span>  <span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">6.0</span>
<a name="ln-78"></a>                 <span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span>  <span class="mf">5.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span>  <span class="mf">1.0</span><span class="o">*</span><span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mf">6.0</span>
<a name="ln-79"></a>
<a name="ln-80"></a>                 <span class="c">!B(1) = (13.0/12.0)*(U( 2)-2.0*U( 1)+U( 0))**2 + (1.0/4.0)*(    U(2)-4.0*U( 1)+3.0*U( 0))**2</span>
<a name="ln-81"></a>                 <span class="c">!B(2) = (13.0/12.0)*(U( 1)-2.0*U( 0)+U(-1))**2 + (1.0/4.0)*(    U(1)-              U(-1))**2</span>
<a name="ln-82"></a>                 <span class="c">!B(3) = (13.0/12.0)*(U( 0)-2.0*U(-1)+U(-2))**2 + (1.0/4.0)*(3.0*U(0)-4.0*U(-1)+    U(-2))**2</span>
<a name="ln-83"></a>
<a name="ln-84"></a>                 <span class="n">w</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">eps</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> 
<a name="ln-85"></a>                 <span class="n">w</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">eps</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> 
<a name="ln-86"></a>                 <span class="n">w</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">eps</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> 
<a name="ln-87"></a>                 <span class="n">f_qp_right</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">/</span><span class="nb">SUM</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="ln-88"></a>               <span class="k">end do</span>
<a name="ln-89"></a><span class="k">              end do</span>
<a name="ln-90"></a><span class="k">             end do</span>
<a name="ln-91"></a><span class="k">            end do</span>
<a name="ln-92"></a>
<a name="ln-93"></a><span class="k">        end subroutine </span><span class="n">compute_face_states</span>
<a name="ln-94"></a>
<a name="ln-95"></a>
<a name="ln-96"></a>        <span class="k">subroutine </span><span class="n">compute_weno_states</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">x_qp_l</span><span class="p">,</span> <span class="n">x_qp_r</span><span class="p">,</span> <span class="n">y_qp_l</span><span class="p">,</span> <span class="n">y_qp_r</span><span class="p">,</span> <span class="n">z_qp_l</span><span class="p">,</span> <span class="n">z_qp_r</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-97"></a>          <span class="c">!&lt; Call Weno scheme for all the three direction I,J, and K</span>
<a name="ln-98"></a>
<a name="ln-99"></a>            <span class="k">implicit none</span>
<a name="ln-100"></a><span class="k">            type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-101"></a>            <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-102"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="kd">::</span> <span class="n">qp</span>
<a name="ln-103"></a>            <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-104"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x_qp_l</span><span class="p">,</span> <span class="n">x_qp_r</span>
<a name="ln-105"></a>            <span class="c">!&lt; Store primitive state at the I-face </span>
<a name="ln-106"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">y_qp_l</span><span class="p">,</span> <span class="n">y_qp_r</span>
<a name="ln-107"></a>            <span class="c">!&lt; Store primitive state at the J-face </span>
<a name="ln-108"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">z_qp_l</span><span class="p">,</span> <span class="n">z_qp_r</span>
<a name="ln-109"></a>            <span class="c">!&lt; Store primitive state at the K-face </span>
<a name="ln-110"></a>            <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flags</span>
<a name="ln-111"></a>            <span class="c">!&lt; flags for different direction</span>
<a name="ln-112"></a>            <span class="n">flags</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-113"></a>            <span class="k">call </span><span class="n">compute_face_states</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">x_qp_l</span><span class="p">,</span> <span class="n">x_qp_r</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-114"></a>            <span class="n">flags</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-115"></a>            <span class="k">call </span><span class="n">compute_face_states</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">y_qp_l</span><span class="p">,</span> <span class="n">y_qp_r</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-116"></a>            <span class="n">flags</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">)</span>
<a name="ln-117"></a>            <span class="k">call </span><span class="n">compute_face_states</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">z_qp_l</span><span class="p">,</span> <span class="n">z_qp_r</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-118"></a>
<a name="ln-119"></a>        <span class="k">end subroutine </span><span class="n">compute_weno_states</span>
<a name="ln-120"></a>
<a name="ln-121"></a><span class="k">end module </span><span class="n">weno</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-02-10T20:32:54.471560 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST-3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>