<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST-3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>resnorm.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140495700-1"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
   
     gtag('config', 'UA-140495700-1');
   </script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>resnorm.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.3% of total for source files.">262 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/resnorm.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">resnorm.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/resnorm.html">resnorm</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/resnorm.f90.html#src">resnorm.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>This module contains subroutine that 
 1. check if time for resnorm dump is arrived
 2. calculate resnorm
 3. send those resnorm to processor number 0
 4. Recalulate resnorm based on information 
    availble from all processors
 5. Append the data to resnorm file</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~resnorm.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileresnormf90EfferentGraph" width="483pt" height="154pt"
 viewBox="0.00 0.00 483.00 154.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~resnorm.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 150)">
<title>sourcefile~~resnorm.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-150 479,-150 479,4 -4,4"/>
<!-- sourcefile~resnorm.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~resnorm.f90</title>
<polygon fill="none" stroke="#000000" points="475,-66 405,-66 405,-42 475,-42 475,-66"/>
<text text-anchor="middle" x="440" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">resnorm.f90</text>
</g>
<!-- sourcefile~fclose.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~fclose.f90</title>
<g id="a_sourcefile~~resnorm.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/fclose.f90.html" xlink:title="fclose.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="274,-146 216,-146 216,-122 274,-122 274,-146"/>
<text text-anchor="middle" x="245" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fclose.f90</text>
</a>
</g>
</g>
<!-- sourcefile~resnorm.f90&#45;&gt;sourcefile~fclose.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~resnorm.f90&#45;&gt;sourcefile~fclose.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M339.5,-94C317.2079,-98.2732 293.6981,-108.2005 275.7042,-117.0956"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.6321,-114.2237 266.3178,-121.8886 276.8156,-120.4579 273.6321,-114.2237"/>
</g>
<!-- sourcefile~global.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~global.f90</title>
<g id="a_sourcefile~~resnorm.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/global.f90.html" xlink:title="global.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="59,-66 0,-66 0,-42 59,-42 59,-66"/>
<text text-anchor="middle" x="29.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global.f90</text>
</a>
</g>
</g>
<!-- sourcefile~resnorm.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~resnorm.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245,-94C197.4242,-89.612 183.5554,-106.7127 137.5,-94"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M137.5,-94C113.7065,-87.4323 87.7463,-77.8972 67.242,-69.7839"/>
<polygon fill="#ff0000" stroke="#ff0000" points="68.5252,-66.5275 57.941,-66.0535 65.9194,-73.0245 68.5252,-66.5275"/>
</g>
<!-- sourcefile~utils.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~utils.f90</title>
<g id="a_sourcefile~~resnorm.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/utils.f90.html" xlink:title="utils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="272,-66 218,-66 218,-42 272,-42 272,-66"/>
<text text-anchor="middle" x="245" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~resnorm.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~resnorm.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M416.8068,-66.1669C396.914,-75.8754 367.165,-88.6968 339.5,-94"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M339.5,-94C313.6709,-98.9512 286.2072,-84.8915 267.5827,-72.0996"/>
<polygon fill="#ff0000" stroke="#ff0000" points="269.5915,-69.2329 259.4406,-66.1979 265.4833,-74.9006 269.5915,-69.2329"/>
</g>
<!-- sourcefile~global_vars.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~global_vars.f90</title>
<g id="a_sourcefile~~resnorm.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/global_vars.f90.html" xlink:title="global_vars.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="180,-66 95,-66 95,-42 180,-42 180,-66"/>
<text text-anchor="middle" x="137.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_vars.f90</text>
</a>
</g>
</g>
<!-- sourcefile~resnorm.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~resnorm.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M339.5,-94C298.251,-101.9071 286.8225,-97.8574 245,-94"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245,-94C218.0029,-91.51 189.3159,-80.3548 168.3724,-70.4555"/>
<polygon fill="#ff0000" stroke="#ff0000" points="169.8493,-67.2817 159.3285,-66.0312 166.7732,-73.5696 169.8493,-67.2817"/>
</g>
<!-- sourcefile~string.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~string.f90</title>
<g id="a_sourcefile~~resnorm.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/string.f90.html" xlink:title="string.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-66 311,-66 311,-42 368,-42 368,-66"/>
<text text-anchor="middle" x="339.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">string.f90</text>
</a>
</g>
</g>
<!-- sourcefile~resnorm.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~resnorm.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.85,-54C396.2249,-54 386.9456,-54 378.1653,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="378.1564,-50.5001 368.1564,-54 378.1563,-57.5001 378.1564,-50.5001"/>
</g>
<!-- sourcefile~layout.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~layout.f90</title>
<g id="a_sourcefile~~resnorm.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/layout.f90.html" xlink:title="layout.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="369,-24 310,-24 310,0 369,0 369,-24"/>
<text text-anchor="middle" x="339.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">layout.f90</text>
</a>
</g>
</g>
<!-- sourcefile~resnorm.f90&#45;&gt;sourcefile~layout.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~resnorm.f90&#45;&gt;sourcefile~layout.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M411.2007,-41.9645C400.7928,-37.6149 388.8735,-32.6337 377.7804,-27.9978"/>
<polygon fill="#ff0000" stroke="#ff0000" points="378.8798,-24.6639 368.3035,-24.0373 376.1806,-31.1226 378.8798,-24.6639"/>
</g>
<!-- sourcefile~fclose.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~fclose.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M216.6997,-121.9284C195.2757,-113.1701 164.9495,-101.5769 137.5,-94"/>
</g>
<!-- sourcefile~utils.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~utils.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M217.8732,-54C209.4685,-54 199.902,-54 190.3723,-54"/>
<polygon fill="#00ff00" stroke="#00ff00" points="190.1027,-50.5001 180.1026,-54 190.1026,-57.5001 190.1027,-50.5001"/>
</g>
<!-- sourcefile~global_vars.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~global_vars.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M94.8155,-54C86.4413,-54 77.6869,-54 69.4077,-54"/>
<polygon fill="#00ffff" stroke="#00ffff" points="69.2393,-50.5001 59.2392,-54 69.2392,-57.5001 69.2393,-50.5001"/>
</g>
<!-- sourcefile~layout.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~layout.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M309.6303,-11.3923C290.9986,-11.3201 266.5473,-11.7825 245,-14"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M245,-14C178.1537,-20.8794 160.607,-18.458 95,-33 86.4527,-34.8945 77.4291,-37.4262 68.9031,-40.0747"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="67.6263,-36.8088 59.1811,-43.2064 69.7726,-43.4717 67.6263,-36.8088"/>
</g>
<!-- sourcefile~layout.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~layout.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M312.4201,-24.0355C302.7324,-28.3412 291.6521,-33.2658 281.3113,-37.8616"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="279.8005,-34.7029 272.0839,-41.9627 282.6435,-41.0996 279.8005,-34.7029"/>
</g>
<!-- sourcefile~layout.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~resnorm.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~layout.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M245,-14C218.2026,-16.7578 189.7074,-27.771 168.792,-37.5444"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="167.2305,-34.4117 159.749,-41.9136 170.2758,-40.7146 167.2305,-34.4117"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~resnorm.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileresnormf90AfferentGraph" width="381pt" height="52pt"
 viewBox="0.00 0.00 381.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~resnorm.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~resnorm.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 377,-48 377,4 -4,4"/>
<!-- sourcefile~resnorm.f90 -->
<g id="sourcefile~~resnorm.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~resnorm.f90</title>
<polygon fill="none" stroke="#000000" points="70,-44 0,-44 0,-20 70,-20 70,-44"/>
<text text-anchor="middle" x="35" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">resnorm.f90</text>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~resnorm.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~resnorm.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="165,-44 106,-44 106,-20 165,-20 165,-44"/>
<text text-anchor="middle" x="135.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~resnorm.f90 -->
<g id="sourcefile~~resnorm.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~resnorm.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M105.8903,-32C97.8168,-32 88.8829,-32 80.1561,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.0707,-28.5001 70.0706,-32 80.0706,-35.5001 80.0707,-28.5001"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~resnorm.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~resnorm.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-44 319,-44 319,-20 373,-20 373,-44"/>
<text text-anchor="middle" x="346" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~resnorm.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M318.7124,-32.5275C307.6304,-32.7172 294.7042,-32.9071 283,-33 246.5567,-33.2892 237.4434,-33.2782 201,-33 192.6723,-32.9364 183.7495,-32.8274 175.2535,-32.7041"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.2233,-29.2034 165.1706,-32.5488 175.1154,-36.2025 175.2233,-29.2034"/>
</g>
<!-- sourcefile~start_finish.f90 -->
<g id="sourcefile~~resnorm.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~start_finish.f90</title>
<g id="a_sourcefile~~resnorm.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/start_finish.f90.html" xlink:title="start_finish.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="283,-24 201,-24 201,0 283,0 283,-24"/>
<text text-anchor="middle" x="242" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_finish.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~start_finish.f90 -->
<g id="sourcefile~~resnorm.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~start_finish.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M318.9467,-26.7974C310.9882,-25.267 302.0079,-23.54 293.0646,-21.8201"/>
<polygon fill="#00ffff" stroke="#00ffff" points="293.5205,-18.3437 283.0394,-19.8922 292.1985,-25.2178 293.5205,-18.3437"/>
</g>
<!-- sourcefile~start_finish.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~resnorm.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~start_finish.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M200.8243,-19.7325C192.3352,-21.3267 183.4138,-23.0021 174.9863,-24.5847"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.1959,-21.1719 165.0137,-26.4575 175.4879,-28.0516 174.1959,-21.1719"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/resnorm.html">resnorm</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/resnorm.f90.html#src">resnorm.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>  <span class="c">!&lt; This module contains subroutine that </span>
<a name="ln-2"></a>  <span class="c">!&lt; 1. check if time for resnorm dump is arrived</span>
<a name="ln-3"></a>  <span class="c">!&lt; 2. calculate resnorm</span>
<a name="ln-4"></a>  <span class="c">!&lt; 3. send those resnorm to processor number 0</span>
<a name="ln-5"></a>  <span class="c">!&lt; 4. Recalulate resnorm based on information </span>
<a name="ln-6"></a>  <span class="c">!&lt;    availble from all processors</span>
<a name="ln-7"></a>  <span class="c">!&lt; 5. Append the data to resnorm file</span>
<a name="ln-8"></a><span class="k">module </span><span class="n">resnorm</span>
<a name="ln-9"></a>  <span class="c">!&lt; This module contains subroutine that </span>
<a name="ln-10"></a>  <span class="c">!&lt; 1. check if time for resnorm dump is arrived</span>
<a name="ln-11"></a>  <span class="c">!&lt; 2. calculate resnorm</span>
<a name="ln-12"></a>  <span class="c">!&lt; 3. send those resnorm to processor number 0</span>
<a name="ln-13"></a>  <span class="c">!&lt; 4. Recalulate resnorm based on information </span>
<a name="ln-14"></a>  <span class="c">!&lt;    availble from all processors</span>
<a name="ln-15"></a>  <span class="c">!&lt; 5. Append the data to resnorm file</span>
<a name="ln-16"></a>  <span class="c">!----------------------------------------------------</span>
<a name="ln-17"></a>
<a name="ln-18"></a>  <span class="k">use </span><span class="n">global</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">RESNORM_FILE_UNIT</span>
<a name="ln-19"></a>  <span class="k">use </span><span class="n">global</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">resnorm_file</span>
<a name="ln-20"></a>
<a name="ln-21"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">imx</span>
<a name="ln-22"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">jmx</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kmx</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">gm</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">n_var</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">density_inf</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">vel_mag</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">pressure_inf</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">tk_inf</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">tw_inf</span>
<a name="ln-31"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">tkl_inf</span>
<a name="ln-32"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">te_inf</span>
<a name="ln-33"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">tv_inf</span>
<a name="ln-34"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">current_iter</span>
<a name="ln-35"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">res_write_interval</span>
<a name="ln-36"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">write_percision</span>
<a name="ln-37"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Res_abs</span>
<a name="ln-38"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Res_rel</span>
<a name="ln-39"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Res_save</span>
<a name="ln-40"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Res_scale</span>
<a name="ln-41"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Res_count</span>
<a name="ln-42"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Res_list</span>
<a name="ln-43"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">Res_itr</span>
<a name="ln-44"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">turbulence</span>
<a name="ln-45"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">residue</span>
<a name="ln-46"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">start_from</span>
<a name="ln-47"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">last_iter</span>
<a name="ln-48"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">F_p</span>
<a name="ln-49"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">G_p</span>
<a name="ln-50"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_p</span>
<a name="ln-51"></a>
<a name="ln-52"></a>
<a name="ln-53"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">dmsg</span>
<a name="ln-54"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">dealloc</span>
<a name="ln-55"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span>      <span class="n">only</span><span class="p">:</span> <span class="n">alloc</span>
<a name="ln-56"></a>  <span class="k">use </span><span class="n">layout</span><span class="p">,</span>     <span class="n">only</span><span class="p">:</span> <span class="n">process_id</span>
<a name="ln-57"></a>  <span class="k">use </span><span class="n">layout</span><span class="p">,</span>     <span class="n">only</span><span class="p">:</span> <span class="n">total_process</span>
<a name="ln-58"></a>  <span class="k">use </span><span class="n">string</span>
<a name="ln-59"></a>  <span class="k">use </span><span class="n">fclose</span><span class="p">,</span>     <span class="n">only</span><span class="p">:</span> <span class="n">close_file</span>
<a name="ln-60"></a>
<a name="ln-61"></a><span class="cp">#include &quot;error.inc&quot;</span>
<a name="ln-62"></a><span class="cp">#include &quot;mpi.inc&quot;</span>
<a name="ln-63"></a>  <span class="k">private</span>
<a name="ln-64"></a><span class="k">  </span><span class="kt">real</span> <span class="kd">::</span> <span class="n">merror</span>
<a name="ln-65"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buffer</span>
<a name="ln-66"></a>
<a name="ln-67"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">setup_resnorm</span>
<a name="ln-68"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">destroy_resnorm</span>
<a name="ln-69"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">find_resnorm</span>
<a name="ln-70"></a>
<a name="ln-71"></a>  <span class="k">contains</span>
<a name="ln-72"></a>
<a name="ln-73"></a><span class="k">    subroutine </span><span class="n">setup_resnorm</span><span class="p">()</span>
<a name="ln-74"></a>      <span class="c">!&lt; Allocate memory, setup scale and file to write</span>
<a name="ln-75"></a>      <span class="k">implicit none</span>
<a name="ln-76"></a><span class="k">      call </span><span class="n">allocate_memory</span><span class="p">()</span>
<a name="ln-77"></a>      <span class="k">call </span><span class="n">setup_scale</span><span class="p">()</span>
<a name="ln-78"></a>      <span class="k">call </span><span class="n">setup_file</span><span class="p">()</span>
<a name="ln-79"></a>    <span class="k">end subroutine </span><span class="n">setup_resnorm</span>
<a name="ln-80"></a>
<a name="ln-81"></a>    <span class="k">subroutine </span><span class="n">find_resnorm</span><span class="p">()</span>
<a name="ln-82"></a>      <span class="c">!&lt; Find the normalized residual for each processor</span>
<a name="ln-83"></a>      <span class="k">implicit none</span>
<a name="ln-84"></a><span class="k">      call </span><span class="n">get_absolute_resnorm</span><span class="p">()</span>
<a name="ln-85"></a>      <span class="k">call </span><span class="n">collect_resnorm_from_all_blocks</span><span class="p">()</span>
<a name="ln-86"></a>      <span class="k">call </span><span class="n">assemble_resnom_at_each_process</span><span class="p">()</span>
<a name="ln-87"></a>      <span class="k">call </span><span class="n">get_relative_resnorm</span><span class="p">()</span>
<a name="ln-88"></a>      <span class="k">if</span><span class="p">((</span><span class="nb">mod</span><span class="p">(</span><span class="n">current_iter</span><span class="p">,</span><span class="n">res_write_interval</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-89"></a>              <span class="n">current_iter</span><span class="o">==</span><span class="n">Res_itr</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>               <span class="p">&amp;</span>
<a name="ln-90"></a>              <span class="n">current_iter</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>      <span class="p">.</span><span class="nb">and</span><span class="p">.</span>              <span class="p">&amp;</span>
<a name="ln-91"></a>              <span class="n">process_id</span>  <span class="o">==</span><span class="mi">0</span><span class="p">)</span>      <span class="k">then</span>
<a name="ln-92"></a><span class="k">        call </span><span class="n">write_resnorm</span><span class="p">()</span>
<a name="ln-93"></a>      <span class="k">end if</span>
<a name="ln-94"></a><span class="k">    end subroutine </span><span class="n">find_resnorm</span>
<a name="ln-95"></a>
<a name="ln-96"></a>    <span class="k">subroutine </span><span class="n">destroy_resnorm</span><span class="p">()</span>
<a name="ln-97"></a>      <span class="c">!&lt; Deallocate memory and close residual file</span>
<a name="ln-98"></a>      <span class="k">implicit none</span>
<a name="ln-99"></a><span class="k">      call </span><span class="n">deallocate_memory</span><span class="p">()</span>
<a name="ln-100"></a>      <span class="k">call </span><span class="n">close_file</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">)</span>
<a name="ln-101"></a>    <span class="k">end subroutine </span><span class="n">destroy_resnorm</span>
<a name="ln-102"></a>
<a name="ln-103"></a>    <span class="k">subroutine </span><span class="n">setup_file</span><span class="p">()</span>
<a name="ln-104"></a>      <span class="c">!&lt; Open the residual file to write</span>
<a name="ln-105"></a>      <span class="k">implicit none</span>
<a name="ln-106"></a><span class="k">      </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-107"></a>      <span class="k">if</span><span class="p">(</span><span class="n">process_id</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-108"></a><span class="k">        if</span><span class="p">(</span><span class="n">start_from</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-109"></a><span class="k">          open</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="n">resnorm_file</span><span class="p">)</span>
<a name="ln-110"></a>        <span class="k">else</span>
<a name="ln-111"></a><span class="k">          open</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="n">resnorm_file</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;append&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
<a name="ln-112"></a>        <span class="k">end if</span>
<a name="ln-113"></a><span class="k">        write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="s1">&#39;(A,2x)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s2">&quot;Iteration&quot;</span>
<a name="ln-114"></a>        <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Res_count</span>
<a name="ln-115"></a>          <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="s1">&#39;(A,2x)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Res_list</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-116"></a>        <span class="k">end do</span>
<a name="ln-117"></a><span class="k">        write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-118"></a>      <span class="k">end if</span>
<a name="ln-119"></a><span class="k">    end subroutine </span><span class="n">setup_file</span>
<a name="ln-120"></a>
<a name="ln-121"></a>    <span class="k">subroutine </span><span class="n">allocate_memory</span><span class="p">()</span>
<a name="ln-122"></a>      <span class="c">!&lt; Allocate memory to MPI Communication</span>
<a name="ln-123"></a>      <span class="k">implicit none</span>
<a name="ln-124"></a><span class="k">      call </span><span class="n">alloc</span><span class="p">(</span><span class="n">Res_abs</span>  <span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-125"></a>      <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">Res_rel</span>  <span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-126"></a>      <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">Res_scale</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-127"></a>      <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">Res_save</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-128"></a>      <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">buffer</span>   <span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="n">n_var</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">total_process</span><span class="p">)</span>
<a name="ln-129"></a>    <span class="k">end subroutine </span><span class="n">allocate_memory</span>
<a name="ln-130"></a>
<a name="ln-131"></a>    <span class="k">subroutine </span><span class="n">deallocate_memory</span><span class="p">()</span>
<a name="ln-132"></a>      <span class="c">!&lt; Deallocate memory required for MPI Communication</span>
<a name="ln-133"></a>      <span class="k">implicit none</span>
<a name="ln-134"></a><span class="k">      call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">Res_abs</span><span class="p">)</span>
<a name="ln-135"></a>      <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">Res_rel</span><span class="p">)</span>
<a name="ln-136"></a>      <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">Res_scale</span><span class="p">)</span>
<a name="ln-137"></a>      <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">Res_save</span><span class="p">)</span>
<a name="ln-138"></a>      <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-139"></a>      <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">Res_list</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">Res_list</span><span class="p">)</span>
<a name="ln-140"></a>    <span class="k">end subroutine </span><span class="n">deallocate_memory</span>
<a name="ln-141"></a>
<a name="ln-142"></a>    <span class="k">subroutine </span><span class="n">setup_scale</span><span class="p">()</span>
<a name="ln-143"></a>      <span class="c">!&lt; Setup scale required for relative and absolute</span>
<a name="ln-144"></a>      <span class="c">!&lt; residual for writing in the file.</span>
<a name="ln-145"></a>      <span class="k">implicit none</span>
<a name="ln-146"></a><span class="k">      </span><span class="n">Res_scale</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span>
<a name="ln-147"></a>      <span class="n">Res_scale</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span>
<a name="ln-148"></a>      <span class="n">Res_scale</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">vel_mag</span>
<a name="ln-149"></a>      <span class="n">Res_scale</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">vel_mag</span>
<a name="ln-150"></a>      <span class="n">Res_scale</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">vel_mag</span>
<a name="ln-151"></a>      <span class="n">Res_scale</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-152"></a>                     <span class="p">((</span><span class="n">gm</span><span class="o">/</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span><span class="o">*</span><span class="n">pressure_inf</span><span class="p">))</span>
<a name="ln-153"></a>
<a name="ln-154"></a>      <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-155"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-156"></a>          <span class="c">!do nothing</span>
<a name="ln-157"></a>          <span class="k">continue</span>
<a name="ln-158"></a><span class="k">        case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-159"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tk_inf</span>
<a name="ln-160"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tw_inf</span>
<a name="ln-161"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-162"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tk_inf</span>
<a name="ln-163"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tkl_inf</span>
<a name="ln-164"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;des&#39;</span><span class="p">)</span>
<a name="ln-165"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tk_inf</span>
<a name="ln-166"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tw_inf</span>
<a name="ln-167"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-168"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tv_inf</span>
<a name="ln-169"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span>
<a name="ln-170"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tk_inf</span>
<a name="ln-171"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tw_inf</span>
<a name="ln-172"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;ke&#39;</span><span class="p">)</span>
<a name="ln-173"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">tk_inf</span>
<a name="ln-174"></a>          <span class="n">Res_scale</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">density_inf</span><span class="o">*</span><span class="n">vel_mag</span><span class="o">*</span><span class="n">te_inf</span>
<a name="ln-175"></a>        <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-176"></a>          <span class="n">Fatal_error</span>
<a name="ln-177"></a>      <span class="k">end select</span>
<a name="ln-178"></a>
<a name="ln-179"></a><span class="k">    end subroutine </span><span class="n">setup_scale</span>
<a name="ln-180"></a>
<a name="ln-181"></a>    <span class="k">subroutine </span><span class="n">get_absolute_resnorm</span><span class="p">()</span>
<a name="ln-182"></a>      <span class="c">!&lt; Get absolute residual for current process</span>
<a name="ln-183"></a>      <span class="k">implicit none</span>
<a name="ln-184"></a><span class="k">      </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-185"></a>      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span>
<a name="ln-186"></a>        <span class="n">Res_abs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Residue</span><span class="p">(:,:,:,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">Res_scale</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-187"></a>      <span class="k">end do</span>
<a name="ln-188"></a><span class="k">      </span><span class="n">merror</span> <span class="o">=</span> <span class="p">(</span>                                     <span class="p">&amp;</span>
<a name="ln-189"></a>               <span class="nb">sum</span><span class="p">(</span><span class="n">F_p</span><span class="p">(</span>  <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-190"></a>              <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">F_p</span><span class="p">(</span><span class="n">imx</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-191"></a>              <span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="n">G_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-192"></a>              <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">G_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-193"></a>              <span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="n">H_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-194"></a>              <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">H_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-195"></a>              <span class="p">)</span>
<a name="ln-196"></a>      <span class="n">Res_abs</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">merror</span><span class="o">/</span><span class="n">Res_scale</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-197"></a>    <span class="k">end subroutine </span><span class="n">get_absolute_resnorm</span>
<a name="ln-198"></a>
<a name="ln-199"></a>    <span class="k">subroutine </span><span class="n">collect_resnorm_from_all_blocks</span><span class="p">()</span>
<a name="ln-200"></a>      <span class="c">!&lt; MPI Communication to gather residual from all processes</span>
<a name="ln-201"></a>      <span class="k">implicit none</span>
<a name="ln-202"></a><span class="k">      </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-203"></a>      <span class="k">call </span><span class="n">MPI_ALLGATHER</span><span class="p">(</span><span class="n">Res_abs</span><span class="p">,</span> <span class="n">n_var</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">MPI_DOUBLE_PRECISION</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-204"></a>      <span class="n">buffer</span><span class="p">,</span> <span class="n">n_var</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">MPI_DOUBLE_PRECISION</span><span class="p">,</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-205"></a>    <span class="k">end subroutine </span><span class="n">collect_resnorm_from_all_blocks</span>
<a name="ln-206"></a>
<a name="ln-207"></a>    <span class="k">subroutine </span><span class="n">assemble_resnom_at_each_process</span><span class="p">()</span>
<a name="ln-208"></a>      <span class="c">!&lt; Sum residual obtained from all the processes after MPI_Communication</span>
<a name="ln-209"></a>      <span class="k">implicit none</span>
<a name="ln-210"></a><span class="k">      </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-211"></a>      <span class="n">Res_abs</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-212"></a>      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">total_process</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-213"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">n_var</span>
<a name="ln-214"></a>          <span class="n">Res_abs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span>  <span class="n">Res_abs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">buffer</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">n_var</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-215"></a>        <span class="k">end do</span>
<a name="ln-216"></a><span class="k">      end do</span>
<a name="ln-217"></a><span class="k">      </span><span class="n">Res_abs</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">Res_abs</span><span class="p">(</span><span class="mi">1</span><span class="p">:))</span>
<a name="ln-218"></a>      <span class="n">Res_abs</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">abs</span><span class="p">(</span><span class="n">Res_abs</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-219"></a>    <span class="k">end subroutine </span><span class="n">assemble_resnom_at_each_process</span>
<a name="ln-220"></a>
<a name="ln-221"></a>    <span class="k">subroutine </span><span class="n">get_relative_resnorm</span><span class="p">()</span>
<a name="ln-222"></a>      <span class="c">!&lt; Get relative residual with respect to first iteration residual</span>
<a name="ln-223"></a>      <span class="k">implicit none</span>
<a name="ln-224"></a><span class="k">      if</span><span class="p">(</span><span class="n">current_iter</span><span class="o">&lt;=</span><span class="n">Res_itr</span><span class="p">)</span> <span class="n">Res_save</span><span class="o">=</span><span class="n">Res_abs</span>
<a name="ln-225"></a>      <span class="n">Res_rel</span> <span class="o">=</span> <span class="n">Res_abs</span><span class="o">/</span><span class="n">Res_save</span>
<a name="ln-226"></a>    <span class="k">end subroutine </span><span class="n">get_relative_resnorm</span>
<a name="ln-227"></a>
<a name="ln-228"></a>    <span class="k">subroutine </span><span class="n">write_resnorm</span><span class="p">()</span>
<a name="ln-229"></a>      <span class="c">!&lt; Writing the residual in the file to save.</span>
<a name="ln-230"></a>      <span class="k">implicit none</span>
<a name="ln-231"></a><span class="k">      </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-232"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span>
<a name="ln-233"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frm</span>
<a name="ln-234"></a>
<a name="ln-235"></a>      <span class="n">n</span><span class="o">=</span><span class="n">write_percision</span>
<a name="ln-236"></a>      <span class="k">write</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="s1">&#39;(A,I0,A,I0,A)&#39;</span><span class="p">)</span> <span class="s2">&quot;(e&quot;</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s2">&quot;E2, 4x)&quot;</span>
<a name="ln-237"></a>
<a name="ln-238"></a>      <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="s1">&#39;(I0,4x)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">current_iter</span><span class="o">+</span><span class="n">last_iter</span>
<a name="ln-239"></a>      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Res_count</span>
<a name="ln-240"></a>        <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Res_list</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
<a name="ln-241"></a>          <span class="c">!include &quot;resnorm_write_cases.inc&quot;</span>
<a name="ln-242"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Mass_abs&#39;</span><span class="p">)</span>
<a name="ln-243"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-244"></a>
<a name="ln-245"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Resnorm_abs&#39;</span><span class="p">)</span>
<a name="ln-246"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Res_abs</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-247"></a>
<a name="ln-248"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Viscous_abs&#39;</span><span class="p">)</span>
<a name="ln-249"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Res_abs</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-250"></a>
<a name="ln-251"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Turbulent_abs&#39;</span><span class="p">)</span>
<a name="ln-252"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">/=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-253"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Res_abs</span><span class="p">(</span><span class="mi">6</span><span class="p">:)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-254"></a>            <span class="k">end if</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Continuity_abs&#39;</span><span class="p">)</span>
<a name="ln-257"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-258"></a>
<a name="ln-259"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;X_mom_abs&#39;</span><span class="p">)</span>
<a name="ln-260"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-261"></a>
<a name="ln-262"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Y_mom_abs&#39;</span><span class="p">)</span>
<a name="ln-263"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-264"></a>
<a name="ln-265"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Z_mom_abs&#39;</span><span class="p">)</span>
<a name="ln-266"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-267"></a>
<a name="ln-268"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Energy_abs&#39;</span><span class="p">)</span>
<a name="ln-269"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-270"></a>
<a name="ln-271"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Mass_rel&#39;</span><span class="p">)</span>
<a name="ln-272"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-273"></a>
<a name="ln-274"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Resnorm_rel&#39;</span><span class="p">)</span>
<a name="ln-275"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Res_rel</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-276"></a>
<a name="ln-277"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Viscous_rel&#39;</span><span class="p">)</span>
<a name="ln-278"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Res_rel</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-279"></a>
<a name="ln-280"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Turbulent_rel&#39;</span><span class="p">)</span>
<a name="ln-281"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">/=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-282"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Res_rel</span><span class="p">(</span><span class="mi">6</span><span class="p">:)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-283"></a>            <span class="k">end if</span>
<a name="ln-284"></a>
<a name="ln-285"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Continuity_rel&#39;</span><span class="p">)</span>
<a name="ln-286"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-287"></a>
<a name="ln-288"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;X-mom_rel&#39;</span><span class="p">)</span>
<a name="ln-289"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-290"></a>
<a name="ln-291"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Y-mom_rel&#39;</span><span class="p">)</span>
<a name="ln-292"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-293"></a>
<a name="ln-294"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Z-mom_rel&#39;</span><span class="p">)</span>
<a name="ln-295"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-296"></a>
<a name="ln-297"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Energy_rel&#39;</span><span class="p">)</span>
<a name="ln-298"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-299"></a>
<a name="ln-300"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;TKE_abs&#39;</span><span class="p">)</span>
<a name="ln-301"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sst&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;kkl&#39;</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sst2003&#39;</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-302"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-303"></a>            <span class="k">end if</span>
<a name="ln-304"></a>
<a name="ln-305"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Tv_abs&#39;</span><span class="p">)</span>
<a name="ln-306"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sa&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;saBC&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-307"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-308"></a>            <span class="k">end if</span>
<a name="ln-309"></a>
<a name="ln-310"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Dissipation_abs&#39;</span><span class="p">)</span>
<a name="ln-311"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;ke&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-312"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-313"></a>            <span class="k">end if</span>
<a name="ln-314"></a>
<a name="ln-315"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Omega_abs&#39;</span><span class="p">)</span>
<a name="ln-316"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sst&#39;</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sst2003&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-317"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-318"></a>            <span class="k">end if</span>
<a name="ln-319"></a>
<a name="ln-320"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Kl_abs&#39;</span><span class="p">)</span>
<a name="ln-321"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-322"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_abs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-323"></a>            <span class="k">end if</span>
<a name="ln-324"></a>
<a name="ln-325"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;TKE_rel&#39;</span><span class="p">)</span>
<a name="ln-326"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sst&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;kkl&#39;</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sst2003&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-327"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-328"></a>            <span class="k">end if</span>
<a name="ln-329"></a>
<a name="ln-330"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Tv_rel&#39;</span><span class="p">)</span>
<a name="ln-331"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sa&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;saBC&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-332"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-333"></a>            <span class="k">end if</span>
<a name="ln-334"></a>
<a name="ln-335"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Dissipation_rel&#39;</span><span class="p">)</span>
<a name="ln-336"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;ke&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-337"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-338"></a>            <span class="k">end if</span>
<a name="ln-339"></a>
<a name="ln-340"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Omega_rel&#39;</span><span class="p">)</span>
<a name="ln-341"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sst&#39;</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;sst2003&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-342"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-343"></a>            <span class="k">end if</span>
<a name="ln-344"></a>
<a name="ln-345"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;Kl_rel&#39;</span><span class="p">)</span>
<a name="ln-346"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-347"></a><span class="k">            write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">Res_rel</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-348"></a>            <span class="k">end if</span>
<a name="ln-349"></a>
<a name="ln-350"></a><span class="k">          case </span><span class="n">DEFAULT</span>
<a name="ln-351"></a>            <span class="c">! making absolute resnorm default</span>
<a name="ln-352"></a>            <span class="k">write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="n">frm</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Res_abs</span><span class="p">(</span><span class="mi">1</span><span class="p">:)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-353"></a>            <span class="n">Issue_warning</span>
<a name="ln-354"></a>        <span class="k">end select</span>
<a name="ln-355"></a><span class="k">      end do</span>
<a name="ln-356"></a><span class="k">      write</span><span class="p">(</span><span class="n">RESNORM_FILE_UNIT</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-357"></a>
<a name="ln-358"></a>    <span class="k">end subroutine </span><span class="n">write_resnorm</span>
<a name="ln-359"></a>
<a name="ln-360"></a><span class="k">end module </span><span class="n">resnorm</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2019-09-25T21:24:49.588962 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST-3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>