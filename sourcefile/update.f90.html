<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST-3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>update.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140495700-1"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
   
     gtag('config', 'UA-140495700-1');
   </script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>update.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.6% of total for source files.">709 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/update.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">update.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/update.html">update</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/update.f90.html#src">update.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>Time integration module</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~update.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileupdatef90EfferentGraph" width="641pt" height="1015pt"
 viewBox="0.00 0.00 641.00 1015.18" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~update.f90~~EfferentGraph" class="graph" transform="scale(.6152 .6152) rotate(0) translate(4 1646.2575)">
<title>sourcefile~~update.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1646.2575 1038,-1646.2575 1038,4 -4,4"/>
<!-- sourcefile~update.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~update.f90</title>
<polygon fill="none" stroke="#000000" points="1034,-571.2618 970,-571.2618 970,-547.2618 1034,-547.2618 1034,-571.2618"/>
<text text-anchor="middle" x="1002" y="-556.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">update.f90</text>
</g>
<!-- sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~global_sa.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/global_sa.f90.html" xlink:title="global_sa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="458,-893.2618 382,-893.2618 382,-869.2618 458,-869.2618 458,-893.2618"/>
<text text-anchor="middle" x="420" y="-878.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_sa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.5,-1067.2618C844.8695,-1114.6995 853.8422,-1158.4114 785,-1187.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C702.1172,-1221.9964 768.4978,-1061.2364 699,-1004.2618 671.7407,-981.9146 652.8294,-1002.3503 622,-985.2618"/>
</g>
<!-- sourcefile~geometry.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~geometry.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/geometry.f90.html" xlink:title="geometry.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="458,-1201.2618 382,-1201.2618 382,-1177.2618 458,-1177.2618 458,-1201.2618"/>
<text text-anchor="middle" x="420" y="-1186.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">geometry.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~geometry.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~geometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C729.2599,-1210.6214 553.9444,-1200.2808 468.1908,-1193.4915"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.4405,-1190.0003 458.1911,-1192.6836 467.8767,-1196.9776 468.4405,-1190.0003"/>
</g>
<!-- sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~global_kkl.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/global_kkl.f90.html" xlink:title="global_kkl.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="459,-851.2618 381,-851.2618 381,-827.2618 459,-827.2618 459,-851.2618"/>
<text text-anchor="middle" x="420" y="-836.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_kkl.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-947.2618C689.6057,-873.3003 544.5206,-849.9009 469.2194,-842.5641"/>
<polygon fill="#ff0000" stroke="#ff0000" points="469.348,-839.0612 459.0697,-841.6318 468.7076,-846.0319 469.348,-839.0612"/>
</g>
<!-- sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~viscosity.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/viscosity.f90.html" xlink:title="viscosity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="657,-1037.2618 587,-1037.2618 587,-1013.2618 657,-1013.2618 657,-1037.2618"/>
<text text-anchor="middle" x="622" y="-1022.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">viscosity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C719.0424,-1214.9034 755.22,-1095.4634 699,-1051.2618 689.649,-1043.9099 678.1064,-1038.5805 666.8296,-1034.7388"/>
<polygon fill="#ff0000" stroke="#ff0000" points="667.637,-1031.3254 657.05,-1031.7324 665.58,-1038.0164 667.637,-1031.3254"/>
</g>
<!-- sourcefile~time.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~time.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/time.f90.html" xlink:title="time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="649,-1319.2618 595,-1319.2618 595,-1295.2618 649,-1295.2618 649,-1319.2618"/>
<text text-anchor="middle" x="622" y="-1304.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~time.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C732.7762,-1209.1478 746.4346,-1250.338 699,-1281.2618 686.9439,-1289.1215 672.2711,-1294.8455 658.9807,-1298.8881"/>
<polygon fill="#ff0000" stroke="#ff0000" points="657.8279,-1295.5766 649.1531,-1301.6592 659.7277,-1302.3138 657.8279,-1295.5766"/>
</g>
<!-- sourcefile~boundary_state_reconstruction.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~boundary_state_reconstruction.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/boundary_state_reconstruction.f90.html" xlink:title="boundary_state_reconstruction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="509,-1517.2618 331,-1517.2618 331,-1493.2618 509,-1493.2618 509,-1517.2618"/>
<text text-anchor="middle" x="420" y="-1502.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">boundary_state_reconstruction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~boundary_state_reconstruction.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~boundary_state_reconstruction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C741.8417,-1205.5187 741.6061,-1228.7511 699,-1248.2618 634.9036,-1277.6137 593.4436,-1235.0457 545,-1286.2618 485.6398,-1349.0193 566.358,-1412.6694 509,-1477.2618 505.2356,-1481.501 500.837,-1485.1044 496.0479,-1488.1666"/>
<polygon fill="#ff0000" stroke="#ff0000" points="494.1313,-1485.2263 487.0584,-1493.1146 497.5068,-1491.3588 494.1313,-1485.2263"/>
</g>
<!-- sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~string.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/string.f90.html" xlink:title="string.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="284,-811.2618 227,-811.2618 227,-787.2618 284,-787.2618 284,-811.2618"/>
<text text-anchor="middle" x="255.5" y="-796.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">string.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C702.2339,-1222.2736 754.1935,-1299.3412 699,-1370.2618 609.1015,-1485.7765 560.2434,-1587.1804 420,-1545.2618"/>
</g>
<!-- sourcefile~interface1.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~interface1.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/interface1.f90.html" xlink:title="interface1.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="661,-1361.2618 583,-1361.2618 583,-1337.2618 661,-1337.2618 661,-1361.2618"/>
<text text-anchor="middle" x="622" y="-1346.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interface1.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~interface1.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~interface1.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C717.3013,-1215.6331 757.6707,-1284.1506 699,-1328.2618 690.8597,-1334.3821 681.0465,-1338.719 671.192,-1341.7922"/>
<polygon fill="#ff0000" stroke="#ff0000" points="670.1129,-1338.4585 661.3841,-1344.4633 671.9524,-1345.2125 670.1129,-1338.4585"/>
</g>
<!-- sourcefile~plusgs.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~plusgs.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/plusgs.f90.html" xlink:title="plusgs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="652.5,-1117.2618 591.5,-1117.2618 591.5,-1093.2618 652.5,-1093.2618 652.5,-1117.2618"/>
<text text-anchor="middle" x="622" y="-1102.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">plusgs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~plusgs.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~plusgs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C741.7809,-1205.3742 741.3656,-1146.2895 699,-1126.2618 687.6473,-1120.8951 674.6829,-1116.6963 662.6706,-1113.5112"/>
<polygon fill="#ff0000" stroke="#ff0000" points="663.4096,-1110.0884 652.8604,-1111.0707 661.7196,-1116.8814 663.4096,-1110.0884"/>
</g>
<!-- sourcefile~summon_grad_evaluation.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~summon_grad_evaluation.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/summon_grad_evaluation.f90.html" xlink:title="summon_grad_evaluation.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="699,-1239.2618 545,-1239.2618 545,-1215.2618 699,-1215.2618 699,-1239.2618"/>
<text text-anchor="middle" x="622" y="-1224.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">summon_grad_evaluation.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~summon_grad_evaluation.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~summon_grad_evaluation.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C758.5525,-1198.3455 728.3502,-1206.8188 701.1886,-1213.0508"/>
<polygon fill="#ff0000" stroke="#ff0000" points="700.3319,-1209.6558 691.3319,-1215.2461 701.8537,-1216.4884 700.3319,-1209.6558"/>
</g>
<!-- sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~utils.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/utils.f90.html" xlink:title="utils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="282.5,-661.2618 228.5,-661.2618 228.5,-637.2618 282.5,-637.2618 282.5,-661.2618"/>
<text text-anchor="middle" x="255.5" y="-646.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.5,-425.2618C879.2524,-389.5837 870.6863,-470.0267 835,-493.2618 780.7697,-528.5709 760.8643,-526.2761 699,-545.2618 550.7918,-590.7459 369.5113,-627.5534 292.7115,-642.3022"/>
<polygon fill="#ff0000" stroke="#ff0000" points="291.7489,-638.9227 282.5825,-644.2356 293.0614,-645.7986 291.7489,-638.9227"/>
</g>
<!-- sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~global_vars.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/global_vars.f90.html" xlink:title="global_vars.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="180,-453.2618 95,-453.2618 95,-429.2618 180,-429.2618 180,-453.2618"/>
<text text-anchor="middle" x="137.5" y="-438.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_vars.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M992.1509,-547.0621C973.6628,-523.9376 932.8882,-471.8633 902.5,-425.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.5,-425.2618C814.7752,-290.7323 954.0409,-178.0722 835,-70.2618 764.554,-6.4618 715.9863,-65.3922 622,-51.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M622,-51.2618C461.0681,-26.0724 380.5805,51.086 255.5,-53.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M255.5,-53.2618C166.7096,-128.0142 212.355,-191.7952 180,-303.2618 168.0317,-344.4942 153.0554,-392.3217 144.4525,-419.4656"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.0782,-418.5276 141.3855,-429.118 147.7495,-420.6475 141.0782,-418.5276"/>
</g>
<!-- sourcefile~bc_primitive.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~bc_primitive.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/bc_primitive.f90.html" xlink:title="bc_primitive.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="829,-103.2618 741,-103.2618 741,-79.2618 829,-79.2618 829,-103.2618"/>
<text text-anchor="middle" x="785" y="-88.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bc_primitive.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~bc_primitive.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~bc_primitive.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.5,-425.2618C845.0387,-337.0759 872.3822,-296.6546 835,-198.2618 823.4324,-167.8151 806.9698,-133.9568 796.1403,-112.6425"/>
<polygon fill="#ff0000" stroke="#ff0000" points="799.1402,-110.8222 791.4607,-103.5231 792.9123,-114.018 799.1402,-110.8222"/>
</g>
<!-- sourcefile~source.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~source.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/source.f90.html" xlink:title="source.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="934,-571.2618 871,-571.2618 871,-547.2618 934,-547.2618 934,-571.2618"/>
<text text-anchor="middle" x="902.5" y="-556.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">source.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~source.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~source.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M969.9699,-559.2618C961.8113,-559.2618 952.9215,-559.2618 944.3524,-559.2618"/>
<polygon fill="#ff0000" stroke="#ff0000" points="944.1299,-555.7619 934.1298,-559.2618 944.1298,-562.7619 944.1299,-555.7619"/>
</g>
<!-- sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~global_sst.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/global_sst.f90.html" xlink:title="global_sst.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="295,-493.2618 216,-493.2618 216,-469.2618 295,-469.2618 295,-493.2618"/>
<text text-anchor="middle" x="255.5" y="-478.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_sst.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C730.0754,-1210.4961 749.5746,-1115.8649 699,-1084.2618 639.2151,-1046.9035 596.6038,-1094.2923 545,-1046.2618 507.0364,-1010.9271 548.4457,-968.934 509,-935.2618 478.5451,-909.2645 444.3801,-953.0261 420,-921.2618"/>
</g>
<!-- sourcefile~viscous2.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~viscous2.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/viscous2.f90.html" xlink:title="viscous2.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658,-771.2618 586,-771.2618 586,-747.2618 658,-747.2618 658,-771.2618"/>
<text text-anchor="middle" x="622" y="-756.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">viscous2.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~viscous2.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~viscous2.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1001.6153,-571.4195C999.0962,-642.311 982.4685,-1001.437 902.5,-1067.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.5,-1067.2618C844.8695,-1114.6995 843.9898,-992.9981 785,-947.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-947.2618C731.9964,-906.1669 744.3155,-872.7056 699,-823.2618 683.3426,-806.1781 663.1114,-789.5314 647.316,-777.4995"/>
<polygon fill="#ff0000" stroke="#ff0000" points="649.1577,-774.5061 639.0544,-771.3163 644.9633,-780.1104 649.1577,-774.5061"/>
</g>
<!-- sourcefile~lusgs.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~lusgs.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/lusgs.f90.html" xlink:title="lusgs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="649.5,-1159.2618 594.5,-1159.2618 594.5,-1135.2618 649.5,-1135.2618 649.5,-1159.2618"/>
<text text-anchor="middle" x="622" y="-1144.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lusgs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~lusgs.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~lusgs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785,-1187.2618C773.4448,-1192.1044 703.8421,-1172.3851 659.4054,-1158.9216"/>
<polygon fill="#ff0000" stroke="#ff0000" points="660.3771,-1155.5588 649.7909,-1155.9875 658.3339,-1162.254 660.3771,-1155.5588"/>
</g>
<!-- sourcefile~geometry.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~geometry.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M392.1192,-1177.0647C371.5547,-1166.4975 344.8403,-1149.136 331,-1125.2618 292.1186,-1058.192 310.4213,-854.2375 295,-778.2618 287.2134,-739.8997 272.759,-696.6472 263.6613,-671.239"/>
<polygon fill="#ff5900" stroke="#ff5900" points="266.8303,-669.7118 260.1252,-661.5086 260.2512,-672.1027 266.8303,-669.7118"/>
</g>
<!-- sourcefile~geometry.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~geometry.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M412.7447,-1201.3622C386.2067,-1244.9001 293.961,-1389.7373 255.5,-1365.2618"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M586.7831,-1020.0905C572.315,-1016.3947 556.3335,-1010.071 545,-999.2618 513.2262,-968.9579 541.3945,-936.9013 509,-907.2618 497.8066,-897.0204 482.7918,-890.7959 468.2865,-887.0186"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="468.9051,-883.5702 458.379,-884.7753 467.3592,-890.3973 468.9051,-883.5702"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M602.0336,-1013.1052C584.7616,-1001.6653 560.2329,-983.063 545,-961.2618 517.7051,-922.1978 544.5095,-892.0437 509,-860.2618 498.1482,-850.5493 483.6456,-845.1009 469.5019,-842.1079"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="469.776,-838.6031 459.3239,-840.3366 468.5757,-845.4994 469.776,-838.6031"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M586.6072,-1025.0483C525.201,-1022.6629 398.9904,-1008.5193 331,-935.2618 282.3006,-882.7898 313.4919,-847.421 295,-778.2618 284.8358,-740.2479 271.0009,-696.5716 262.6904,-671.036"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="265.9316,-669.6869 259.4938,-661.2722 259.279,-671.8649 265.9316,-669.6869"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M586.9751,-1017.8815C526.6996,-1007.3894 402.918,-995.8529 331,-1059.2618 225.929,-1151.9013 373.6784,-1440.4671 255.5,-1365.2618"/>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M255.5,-1365.2618C176.523,-1315.0414 143.8902,-600.0936 138.3659,-463.6648"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="141.8586,-463.4109 137.9638,-453.558 134.8642,-463.6893 141.8586,-463.4109"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M586.7041,-1019.096C572.5585,-1015.2456 556.8415,-1009.0754 545,-999.2618 519.872,-978.4371 535.8017,-953.8832 509,-935.2618 476.116,-912.4146 444.3801,-953.0261 420,-921.2618"/>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M420,-921.2618C395.3733,-889.1764 358.231,-932.1687 331,-902.2618 284.7544,-851.4719 310.3344,-662.218 295,-595.2618 287.4172,-562.1521 273.5912,-525.2453 264.4743,-502.6377"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="267.687,-501.2473 260.6561,-493.3216 261.2099,-503.902 267.687,-501.2473"/>
</g>
<!-- sourcefile~copy_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~copy_bc.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/copy_bc.f90.html" xlink:title="copy_bc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455,-143.2618 385,-143.2618 385,-119.2618 455,-119.2618 455,-143.2618"/>
<text text-anchor="middle" x="420" y="-128.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">copy_bc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~copy_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~copy_bc.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M614.7714,-1013.1486C598.7419,-985.5699 560.4167,-915.5061 545,-851.2618 510.6734,-708.2163 582.0816,-317.931 509,-190.2618 498.2556,-171.4921 478.8206,-157.5767 460.8473,-147.9893"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="462.1431,-144.7236 451.6354,-143.3674 459.0039,-150.9803 462.1431,-144.7236"/>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~geometry.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~geometry.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M601.1433,-1295.0782C565.0632,-1274.0017 490.9016,-1230.6796 449.5354,-1206.5152"/>
<polygon fill="#96ff00" stroke="#96ff00" points="451.1434,-1203.4011 440.7433,-1201.3792 447.6125,-1209.4454 451.1434,-1203.4011"/>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M594.7558,-1307.7008C578.0586,-1309.4656 557.5499,-1314.5779 545,-1328.2618 484.5448,-1394.1797 571.2746,-1462.06 509,-1526.2618 480.8388,-1555.2945 458.7528,-1556.845 420,-1545.2618"/>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M420,-1545.2618C381.2472,-1533.6787 358.0323,-1556.3485 331,-1526.2618 306.7633,-1499.2867 265.6002,-940.6611 257.0739,-821.4979"/>
<polygon fill="#96ff00" stroke="#96ff00" points="260.5543,-821.0964 256.3523,-811.3704 253.572,-821.5939 260.5543,-821.0964"/>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M594.8036,-1311.1581C545.7642,-1317.529 445.263,-1327.3851 420,-1305.2618"/>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M420,-1305.2618C382.3463,-1272.2878 354.7703,-1280.308 331,-1236.2618 282.5143,-1146.4183 314.0592,-878.5587 295,-778.2618 287.6596,-739.6339 272.961,-696.1958 263.7107,-670.8662"/>
<polygon fill="#96ff00" stroke="#96ff00" points="266.9911,-669.6457 260.2311,-661.4878 260.4283,-672.0808 266.9911,-669.6457"/>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M594.8902,-1307.4484C578.0285,-1309.0889 557.2874,-1314.1575 545,-1328.2618 463.1622,-1422.2009 593.4323,-1514.6476 509,-1606.2618 481.5893,-1636.0041 457.7043,-1610.6216 420,-1625.2618"/>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M420,-1625.2618C332.1315,-1659.3804 273.5478,-1641.9156 216,-1567.2618 146.1853,-1476.695 138.4214,-615.1664 137.595,-463.8849"/>
<polygon fill="#96ff00" stroke="#96ff00" points="141.0933,-463.5161 137.5435,-453.5337 134.0934,-463.551 141.0933,-463.5161"/>
</g>
<!-- sourcefile~read.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~read.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/read.f90.html" xlink:title="read.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447,-1597.2618 393,-1597.2618 393,-1573.2618 447,-1573.2618 447,-1597.2618"/>
<text text-anchor="middle" x="420" y="-1582.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">read.f90</text>
</a>
</g>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~read.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~read.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M594.6374,-1307.5935C577.893,-1309.3156 557.3761,-1314.4206 545,-1328.2618 475.7414,-1405.7195 577.5597,-1481.1849 509,-1559.2618 496.0656,-1573.9917 475.2976,-1580.5912 457.0755,-1583.4623"/>
<polygon fill="#96ff00" stroke="#96ff00" points="456.486,-1580.0087 447.0006,-1584.7286 457.359,-1586.9541 456.486,-1580.0087"/>
</g>
<!-- sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M388.3606,-1493.1586C368.2132,-1483.6541 343.611,-1468.307 331,-1446.2618 294.0917,-1381.7427 307.9772,-851.4502 295,-778.2618 288.1353,-739.5466 273.2885,-696.1357 263.8799,-670.8351"/>
<polygon fill="#3cff00" stroke="#3cff00" points="267.1483,-669.5828 260.3358,-661.4685 260.6012,-672.0601 267.1483,-669.5828"/>
</g>
<!-- sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M357.5115,-1493.126C348.0961,-1489.6118 338.9051,-1485.0867 331,-1479.2618 282.0763,-1443.2125 306.7698,-1397.8884 255.5,-1365.2618"/>
</g>
<!-- sourcefile~interface1.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~interface1.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M582.7938,-1340.5131C561.059,-1335.6818 533.5425,-1329.5963 509,-1324.2618 469.476,-1315.671 450.4285,-1331.9087 420,-1305.2618"/>
</g>
<!-- sourcefile~interface1.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~interface1.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M620.5256,-1361.5433C614.8441,-1403.16 590.4454,-1539.9356 509,-1606.2618 477.6372,-1631.8025 457.1207,-1609.1993 420,-1625.2618"/>
</g>
<!-- sourcefile~mapping.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~mapping.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/mapping.f90.html" xlink:title="mapping.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456,-1357.2618 384,-1357.2618 384,-1333.2618 456,-1333.2618 456,-1357.2618"/>
<text text-anchor="middle" x="420" y="-1342.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mapping.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interface1.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~interface1.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M582.5728,-1348.4811C549.2372,-1347.821 501.4306,-1346.8743 466.2848,-1346.1784"/>
<polygon fill="#00ff78" stroke="#00ff78" points="466.3403,-1342.6789 456.273,-1345.9801 466.2017,-1349.6775 466.3403,-1342.6789"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M598.7326,-1093.0854C581.4001,-1082.8427 558.4887,-1066.6181 545,-1046.2618 509.7499,-993.0648 553.4245,-953.0762 509,-907.2618 498.2564,-896.1821 483.077,-889.7547 468.2911,-886.0488"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="468.6868,-882.5546 458.177,-883.8943 467.2283,-889.401 468.6868,-882.5546"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~geometry.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~geometry.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M591.2764,-1109.7512C576.5452,-1112.848 559.0851,-1117.9585 545,-1126.2618 525.235,-1137.9136 528.6595,-1151.4329 509,-1163.2618 496.5691,-1170.7414 481.8602,-1176.177 468.0179,-1180.0808"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="466.9285,-1176.7478 458.1366,-1182.66 468.6964,-1183.5209 466.9285,-1176.7478"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M598.0083,-1093.1063C580.5285,-1082.9748 557.7602,-1066.8847 545,-1046.2618 500.6964,-974.659 567.3202,-920.9951 509,-860.2618 498.6363,-849.4693 483.8401,-843.7771 469.2801,-840.8927"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="469.7187,-837.4187 459.2951,-839.3162 468.6269,-844.333 469.7187,-837.4187"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M420,-1073.2618C381.4405,-1044.3289 360.26,-1049.5737 331,-1011.2618 285.6003,-951.8173 265.8795,-862.7185 258.8207,-821.5641"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="262.2462,-820.8229 257.1884,-811.5133 255.3368,-821.945 262.2462,-820.8229"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M591.2752,-1103.8608C541.5883,-1101.0352 446.4837,-1093.1337 420,-1073.2618"/>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M420,-1073.2618C381.4405,-1044.3289 356.5178,-1052.1616 331,-1011.2618 275.5341,-922.3614 318.4,-880.3999 295,-778.2618 286.2584,-740.106 272.0959,-696.7904 263.316,-671.3136"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="266.5106,-669.8449 259.9142,-661.5542 259.9007,-672.149 266.5106,-669.8449"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M591.1096,-1103.0091C533.0089,-1100.4994 406.5255,-1103.4755 331,-1168.2618 259.8314,-1229.3108 334.6233,-1415.5753 255.5,-1365.2618"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M591.3454,-1101.2714C575.736,-1097.802 557.4733,-1091.3286 545,-1079.2618 512.2493,-1047.5785 536.9584,-1019.2448 509,-983.2618 479.4222,-945.1948 449.3518,-959.5035 420,-921.2618"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M591.3662,-1106.1242C575.3694,-1108.2184 556.7361,-1113.5237 545,-1126.2618 485.8756,-1190.4345 567.5453,-1254.5604 509,-1319.2618 498.1025,-1331.3052 481.9697,-1337.894 466.4213,-1341.4572"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="465.511,-1338.0679 456.3491,-1343.3886 466.8293,-1344.9426 465.511,-1338.0679"/>
</g>
<!-- sourcefile~summon_grad_evaluation.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~summon_grad_evaluation.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M586.9014,-1239.2746C537.2478,-1255.4131 449.2751,-1280.6119 420,-1267.2618"/>
</g>
<!-- sourcefile~summon_grad_evaluation.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~summon_grad_evaluation.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M544.9777,-1233.6467C469.0798,-1238.0903 360.3425,-1238.8858 331,-1210.2618 296.5217,-1176.6278 304.1032,-825.5602 295,-778.2618 287.5689,-739.6513 272.8985,-696.2078 263.6785,-670.8723"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="266.9611,-669.6579 260.2111,-661.4916 260.3953,-672.0848 266.9611,-669.6579"/>
</g>
<!-- sourcefile~summon_grad_evaluation.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~summon_grad_evaluation.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M563.5423,-1239.3381C556.5415,-1242.8584 550.0865,-1247.401 545,-1253.2618 487.807,-1319.1617 576.1191,-1390.5047 509,-1446.2618 448.147,-1496.8136 398.9001,-1486.8592 331,-1446.2618 301.9864,-1428.9146 320.6538,-1401.2755 295,-1379.2618 280.8651,-1367.1326 271.3088,-1375.1105 255.5,-1365.2618"/>
</g>
<!-- sourcefile~ghost_gradient.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~ghost_gradient.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node28"><a xlink:href=".././sourcefile/ghost_gradient.f90.html" xlink:title="ghost_gradient.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="471,-1437.2618 369,-1437.2618 369,-1413.2618 471,-1413.2618 471,-1437.2618"/>
<text text-anchor="middle" x="420" y="-1422.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ghost_gradient.f90</text>
</a>
</g>
</g>
<!-- sourcefile~summon_grad_evaluation.f90&#45;&gt;sourcefile~ghost_gradient.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~summon_grad_evaluation.f90&#45;&gt;sourcefile~ghost_gradient.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M564.234,-1239.4234C557.0407,-1242.9295 550.3479,-1247.4454 545,-1253.2618 499.7655,-1302.4595 555.2435,-1351.0114 509,-1399.2618 501.3251,-1407.2698 491.3338,-1412.8506 480.8291,-1416.7306"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="479.5533,-1413.4637 471.0894,-1419.8365 481.6801,-1420.1328 479.5533,-1413.4637"/>
</g>
<!-- sourcefile~utils.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~utils.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#0078ff" stroke-dasharray="5,2" d="M232.3808,-637.2495C226.4839,-633.3806 220.5373,-628.6714 216,-623.2618 174.9167,-574.2811 152.1202,-500.5411 142.7053,-463.7736"/>
<polygon fill="#0078ff" stroke="#0078ff" points="145.9947,-462.4931 140.2076,-453.6184 139.1973,-464.1649 145.9947,-462.4931"/>
</g>
<!-- sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~global.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/global.f90.html" xlink:title="global.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="59,-453.2618 0,-453.2618 0,-429.2618 59,-429.2618 59,-453.2618"/>
<text text-anchor="middle" x="29.5" y="-438.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global.f90</text>
</a>
</g>
</g>
<!-- sourcefile~global_vars.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~global_vars.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M94.8155,-441.2618C86.4413,-441.2618 77.6869,-441.2618 69.4077,-441.2618"/>
<polygon fill="#001dff" stroke="#001dff" points="69.2393,-437.7619 59.2392,-441.2618 69.2392,-444.7619 69.2393,-437.7619"/>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M420,-91.2618C384.9121,-111.3813 357.5258,-79.7277 331,-110.2618 256.0529,-196.5343 352.7094,-524.623 295,-623.2618 293.4842,-625.8527 291.5956,-628.2339 289.4717,-630.4124"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="286.9652,-627.9461 281.5435,-637.0487 291.4583,-633.3139 286.9652,-627.9461"/>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M744.8835,-79.2402C712.1382,-69.9572 664.5012,-57.6517 622,-51.2618"/>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M750.5712,-103.3284C717.9509,-113.8899 667.3412,-128.0382 622,-131.2618"/>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M622,-131.2618C530.7094,-137.7523 499.3949,-45.7367 420,-91.2618"/>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M420,-91.2618C384.9121,-111.3813 358.0397,-80.1818 331,-110.2618 279.4683,-167.5878 335.0478,-389.3987 295,-455.2618 293.4005,-457.8924 291.422,-460.3102 289.2099,-462.5212"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="286.5158,-460.2038 281.0001,-469.2496 290.953,-465.6178 286.5158,-460.2038"/>
</g>
<!-- sourcefile~read_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~read_bc.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/read_bc.f90.html" xlink:title="read_bc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="657,-103.2618 587,-103.2618 587,-79.2618 657,-79.2618 657,-103.2618"/>
<text text-anchor="middle" x="622" y="-88.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">read_bc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~read_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~read_bc.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M740.8899,-91.2618C718.0784,-91.2618 690.2776,-91.2618 667.2967,-91.2618"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="667.1123,-87.7619 657.1123,-91.2618 667.1123,-94.7619 667.1123,-87.7619"/>
</g>
<!-- sourcefile~ft_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~ft_bc.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/ft_bc.f90.html" xlink:title="FT_bc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="652.5,-183.2618 591.5,-183.2618 591.5,-159.2618 652.5,-159.2618 652.5,-183.2618"/>
<text text-anchor="middle" x="622" y="-168.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FT_bc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~ft_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~ft_bc.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M768.2228,-103.4679C751.3657,-115.3221 724.3236,-133.2419 699,-145.2618 687.4484,-150.7448 674.4259,-155.6041 662.4215,-159.5941"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="661.084,-156.3475 652.6319,-162.7359 663.2231,-163.0126 661.084,-156.3475"/>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~copy_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~copy_bc.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M622,-131.2618C568.2595,-135.0826 506.2734,-134.3177 465.2915,-133.0948"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="465.193,-129.59 455.086,-132.7678 464.9688,-136.5864 465.193,-129.59"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M902.3426,-571.4427C901.2849,-632.6664 893.3135,-906.0239 835,-961.2618 800.4189,-994.0191 663.4523,-1008.7266 622,-985.2618"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M622,-985.2618C590.6481,-967.8838 573.699,-982.7399 545,-961.2618 521.9066,-943.979 532.2473,-924.3371 509,-907.2618 497.0987,-898.5203 482.2987,-892.7051 468.2055,-888.8414"/>
<polygon fill="#9500ff" stroke="#9500ff" points="468.6668,-885.3505 458.12,-886.359 466.9937,-892.1476 468.6668,-885.3505"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M622,-837.2618C571.3493,-851.218 510.8069,-849.5254 469.2938,-845.7196"/>
<polygon fill="#9500ff" stroke="#9500ff" points="469.464,-842.2194 459.1672,-844.7147 468.7727,-849.1852 469.464,-842.2194"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M785,-719.2618C732.185,-741.442 747.5551,-784.868 699,-815.2618 668.8315,-834.1463 656.3129,-827.8074 622,-837.2618"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M622,-837.2618C599.9824,-843.3285 442.8103,-800.3883 420,-799.2618"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M622,-719.2618C500.6424,-703.6061 358.8356,-672.9426 292.8305,-657.9426"/>
<polygon fill="#9500ff" stroke="#9500ff" points="293.4311,-654.4897 282.9027,-655.6744 291.8719,-661.3139 293.4311,-654.4897"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M785,-719.2618C718.2066,-747.3124 693.3582,-731.7602 622,-719.2618"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M622,-719.2618C566.7893,-709.5917 561.9354,-681.6892 509,-663.2618 400.2088,-625.3904 363.1943,-650.1485 255.5,-609.2618"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M898.4628,-571.5673C887.0037,-604.0757 850.7747,-691.6391 785,-719.2618"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M785,-719.2618C683.0383,-762.0816 720.2136,-582.0931 622,-531.2618"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M622,-531.2618C540.7199,-489.1946 505.7811,-523.1633 420,-491.2618"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M420,-491.2618C383.1807,-477.5689 338.539,-475.6871 305.056,-476.886"/>
<polygon fill="#9500ff" stroke="#9500ff" points="304.8723,-473.3907 295.044,-477.3473 305.1945,-480.3833 304.8723,-473.3907"/>
</g>
<!-- sourcefile~cc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~cc.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/cc.f90.html" xlink:title="CC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447,-543.2618 393,-543.2618 393,-519.2618 447,-519.2618 447,-543.2618"/>
<text text-anchor="middle" x="420" y="-528.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~cc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~cc.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M622,-531.2618C569.7772,-504.2335 499.3065,-512.6112 456.8954,-521.6096"/>
<polygon fill="#9500ff" stroke="#9500ff" points="455.9944,-518.2246 447.0029,-523.8285 457.5265,-525.0549 455.9944,-518.2246"/>
</g>
<!-- sourcefile~dump_solution.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dump_solution.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/dump_solution.f90.html" xlink:title="dump_solution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="835,-484.2618 735,-484.2618 735,-460.2618 835,-460.2618 835,-484.2618"/>
<text text-anchor="middle" x="785" y="-469.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dump_solution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~dump_solution.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~dump_solution.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M886.1621,-547.1649C866.3683,-532.509 832.8211,-507.6698 809.8244,-490.6424"/>
<polygon fill="#9500ff" stroke="#9500ff" points="811.6974,-487.6743 801.5779,-484.5365 807.532,-493.3001 811.6974,-487.6743"/>
</g>
<!-- sourcefile~layout.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~layout.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node27"><a xlink:href=".././sourcefile/layout.f90.html" xlink:title="layout.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="449.5,-223.2618 390.5,-223.2618 390.5,-199.2618 449.5,-199.2618 449.5,-223.2618"/>
<text text-anchor="middle" x="420" y="-208.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">layout.f90</text>
</a>
</g>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~layout.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~layout.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M899.1206,-547.1264C884.7537,-498.0808 823.688,-313.5024 699,-237.2618 624.5682,-191.7505 517.5007,-197.2444 460.0503,-204.6162"/>
<polygon fill="#9500ff" stroke="#9500ff" points="459.3525,-201.179 449.9195,-206.0027 460.3017,-208.1143 459.3525,-201.179"/>
</g>
<!-- sourcefile~viscous2.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~viscous2.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M606.5479,-771.3114C590.7058,-783.8467 565.5481,-804.2616 545,-823.2618 528.1542,-838.8387 528.9633,-848.9531 509,-860.2618 496.5507,-867.3141 481.8364,-872.0035 467.9948,-875.1198"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="467.2205,-871.7055 458.115,-877.1222 468.611,-878.566 467.2205,-871.7055"/>
</g>
<!-- sourcefile~viscous2.f90&#45;&gt;sourcefile~geometry.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~viscous2.f90&#45;&gt;sourcefile~geometry.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M599.8332,-771.3653C581.9096,-782.4068 557.6476,-800.4605 545,-823.2618 487.5595,-926.8171 557.9867,-979.4499 509,-1087.2618 493.7228,-1120.8845 463.6667,-1151.6623 442.7314,-1170.4192"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="440.1612,-1168.017 434.9324,-1177.2318 444.7663,-1173.2889 440.1612,-1168.017"/>
</g>
<!-- sourcefile~viscous2.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~viscous2.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M599.5334,-771.3298C577.0633,-783.0791 541.2939,-800.9213 509,-813.2618 496.1788,-818.1612 482.0251,-822.6812 468.8488,-826.5311"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="467.6582,-823.2311 459.0016,-829.3397 469.5781,-829.9626 467.6582,-823.2311"/>
</g>
<!-- sourcefile~viscous2.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~viscous2.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M420,-761.2618C375.4907,-756.5409 325.5502,-770.9727 292.4947,-783.3879"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="290.857,-780.2693 282.8029,-787.1528 293.3917,-786.7943 290.857,-780.2693"/>
</g>
<!-- sourcefile~viscous2.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~viscous2.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M585.7549,-762.1302C545.2334,-764.7544 477.719,-767.3839 420,-761.2618"/>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M420,-761.2618C379.26,-756.9407 365.6552,-759.1122 331,-737.2618 303.8297,-720.1308 281.1983,-690.1677 268.0031,-670.0241"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="270.9342,-668.1107 262.622,-661.5412 265.0232,-671.8604 270.9342,-668.1107"/>
</g>
<!-- sourcefile~viscous2.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~viscous2.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M420,-327.2618C392.8448,-302.7893 287.6227,-309.8135 255.5,-327.2618"/>
</g>
<!-- sourcefile~viscous2.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~viscous2.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M585.6158,-755.1907C570.9411,-751.6897 555.1207,-745.2142 545,-733.2618 480.1245,-656.6448 578.1829,-583.0131 509,-510.2618 481.1276,-480.9518 457.9102,-505.3604 420,-491.2618"/>
</g>
<!-- sourcefile~viscous2.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~viscous2.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M585.6215,-755.6043C570.7636,-752.1848 554.8003,-745.6586 545,-733.2618 491.4354,-665.5062 566.3801,-410.8182 509,-346.2618 482.1294,-316.0307 450.0458,-354.3395 420,-327.2618"/>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M420,-327.2618C389.5667,-299.835 363.1775,-328.6199 331,-303.2618 304.7566,-282.5802 318.0694,-261.433 295,-237.2618 280.8172,-222.4017 275.9922,-211.8312 255.5,-213.2618"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M594.3014,-1146.8555C577.6421,-1145.0821 557.3409,-1139.9486 545,-1126.2618 478.9461,-1053.0043 574.3929,-981.11 509,-907.2618 498.5827,-895.4976 483.1691,-888.9246 468.0843,-885.2945"/>
<polygon fill="#ff005a" stroke="#ff005a" points="468.7704,-881.8625 458.2748,-883.309 467.3816,-888.7234 468.7704,-881.8625"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~geometry.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~geometry.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M594.3363,-1153.0137C561.932,-1159.7512 507.6766,-1171.032 468.2852,-1179.2223"/>
<polygon fill="#ff005a" stroke="#ff005a" points="467.4385,-1175.8235 458.3604,-1181.2859 468.8635,-1182.6769 467.4385,-1175.8235"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M594.1659,-1146.9759C577.4541,-1145.2492 557.1452,-1140.1224 545,-1126.2618 466.3773,-1036.5346 589.1603,-948.6181 509,-860.2618 498.8595,-849.0845 483.9777,-843.3126 469.2742,-840.4728"/>
<polygon fill="#ff005a" stroke="#ff005a" points="469.5951,-836.9816 459.1838,-838.9449 468.547,-843.9027 469.5951,-836.9816"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M605.3939,-1159.2643C560.5888,-1191.3434 439.2993,-1276.0627 420,-1267.2618"/>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M420,-1267.2618C382.7244,-1250.2633 358.5615,-1273.5733 331,-1243.2618 273.7275,-1180.2749 259.261,-903.1879 256.2169,-821.8091"/>
<polygon fill="#ff005a" stroke="#ff005a" points="259.7096,-821.5383 255.8599,-811.6677 252.714,-821.7846 259.7096,-821.5383"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M594.1393,-1151.0617C535.6545,-1157.303 399.8241,-1162.3768 331,-1087.2618 284.2979,-1036.291 309.1783,-845.9234 295,-778.2618 286.9717,-739.9496 272.5912,-696.6818 263.5739,-671.257"/>
<polygon fill="#ff005a" stroke="#ff005a" points="266.7496,-669.745 260.0718,-661.5196 260.1627,-672.114 266.7496,-669.745"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M598.5473,-1159.3177C581.1152,-1169.4955 558.1602,-1185.6917 545,-1206.2618 505.719,-1267.6605 565.9167,-1320.7285 509,-1366.2618 487.0054,-1383.8576 279.3357,-1380.2696 255.5,-1365.2618"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M594.2791,-1145.1009C578.431,-1142.6351 558.9883,-1137.3897 545,-1126.2618 518.5456,-1105.2171 531.4848,-1084.5037 509,-1059.2618 444.8698,-987.2679 380.066,-1018.2578 331,-935.2618 292.3344,-869.8584 311.5448,-669.4165 295,-595.2618 287.6034,-562.11 273.7277,-525.2144 264.5493,-502.6207"/>
<polygon fill="#ff005a" stroke="#ff005a" points="267.7563,-501.2168 260.7029,-493.311 261.2867,-503.8898 267.7563,-501.2168"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M599.3997,-1159.4384C582.1964,-1169.785 559.1401,-1186.1464 545,-1206.2618 514.6879,-1249.3832 546.7192,-1282.4443 509,-1319.2618 497.4717,-1330.5146 481.3554,-1336.9427 466,-1340.5987"/>
<polygon fill="#ff005a" stroke="#ff005a" points="465.1735,-1337.1952 456.0752,-1342.6238 466.573,-1344.0539 465.1735,-1337.1952"/>
</g>
<!-- sourcefile~read_bc.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~read_bc.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M420,-53.2618C347.715,-42.3024 311.6403,-6.427 255.5,-53.2618"/>
</g>
<!-- sourcefile~read_bc.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~read_bc.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.7343,-83.8414C546.5222,-75.5636 478.7435,-62.1682 420,-53.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M420,-53.2618C330.1469,-39.6388 289.2579,14.5196 216,-39.2618 122.1222,-108.1812 230.9607,-219.7779 137.5,-289.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M137.5,-289.2618C89.6511,-324.2235 55.0087,-386.9091 39.1527,-419.7909"/>
<polygon fill="#ff0000" stroke="#ff0000" points="35.9225,-418.4356 34.8412,-428.9751 42.259,-421.4103 35.9225,-418.4356"/>
</g>
<!-- sourcefile~read_bc.f90&#45;&gt;sourcefile~layout.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~read_bc.f90&#45;&gt;sourcefile~layout.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.8168,-99.5487C573.1574,-103.6659 557.7624,-109.4639 545,-117.2618 525.9579,-128.8968 526.3748,-138.2586 509,-152.2618 490.0713,-167.5175 467.1805,-182.6259 449.3541,-193.7345"/>
<polygon fill="#ff0000" stroke="#ff0000" points="447.2231,-190.9362 440.5415,-199.1586 450.8923,-196.8976 447.2231,-190.9362"/>
</g>
<!-- sourcefile~ft_bc.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~ft_bc.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M591.3652,-166.3658C536.3353,-159.0223 418.3507,-149.9737 331,-190.2618 310.1654,-199.8712 312.9476,-212.9684 295,-227.2618 278.9312,-240.059 271.442,-238.3069 255.5,-251.2618"/>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M255.5,-251.2618C197.7108,-297.7084 160.4833,-380.5661 145.2933,-419.6826"/>
<polygon fill="#ff9900" stroke="#ff9900" points="142.0091,-418.4724 141.75,-429.0641 148.5576,-420.9457 142.0091,-418.4724"/>
</g>
<!-- sourcefile~ft_bc.f90&#45;&gt;sourcefile~copy_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~ft_bc.f90&#45;&gt;sourcefile~copy_bc.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M591.3205,-165.1867C557.6839,-158.526 503.3896,-147.7746 464.9484,-140.1625"/>
<polygon fill="#ff9900" stroke="#ff9900" points="465.5381,-136.7114 455.0487,-138.2022 464.1784,-143.5781 465.5381,-136.7114"/>
</g>
<!-- sourcefile~read.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~read.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M392.7212,-1584.9661C372.4803,-1583.1778 345.9076,-1577.2219 331,-1559.2618 306.7225,-1530.0134 265.3498,-943.2196 256.996,-821.3202"/>
<polygon fill="#cbff00" stroke="#cbff00" points="260.4846,-821.0324 256.3117,-811.294 253.5008,-821.5091 260.4846,-821.0324"/>
</g>
<!-- sourcefile~read.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~read.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M392.6578,-1575.1679C371.8107,-1565.8919 344.4634,-1549.9549 331,-1526.2618 289.8915,-1453.9186 309.2915,-860.2326 295,-778.2618 288.2466,-739.527 273.3651,-696.1222 263.9194,-670.8282"/>
<polygon fill="#cbff00" stroke="#cbff00" points="267.1849,-669.5682 260.3603,-661.4642 260.6416,-672.0553 267.1849,-669.5682"/>
</g>
<!-- sourcefile~read.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~read.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M392.8468,-1582.4107C373.9592,-1579.2876 349.0323,-1572.779 331,-1559.2618 293.0195,-1530.7914 231.2019,-1424.2284 216,-1379.2618 155.9221,-1201.5544 140.4661,-588.1861 137.916,-463.4887"/>
<polygon fill="#cbff00" stroke="#cbff00" points="141.411,-463.1958 137.7139,-453.2669 134.4123,-463.3342 141.411,-463.1958"/>
</g>
<!-- sourcefile~read.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~read.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M392.8848,-1590.6282C337.1374,-1599.9522 208.9114,-1612.3324 137.5,-1546.2618"/>
</g>
<!-- sourcefile~fclose.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~fclose.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node29"><a xlink:href=".././sourcefile/fclose.f90.html" xlink:title="fclose.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="284.5,-1558.2618 226.5,-1558.2618 226.5,-1534.2618 284.5,-1534.2618 284.5,-1558.2618"/>
<text text-anchor="middle" x="255.5" y="-1543.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fclose.f90</text>
</a>
</g>
</g>
<!-- sourcefile~read.f90&#45;&gt;sourcefile~fclose.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~read.f90&#45;&gt;sourcefile~fclose.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M392.8362,-1578.8218C366.0264,-1572.4657 324.7654,-1562.6834 294.4648,-1555.4997"/>
<polygon fill="#cbff00" stroke="#cbff00" points="295.1835,-1552.0731 284.6458,-1553.1718 293.5687,-1558.8843 295.1835,-1552.0731"/>
</g>
<!-- sourcefile~copy_bc.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~copy_bc.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M384.8057,-138.7479C368.0416,-143.0085 347.9913,-149.1375 331,-157.2618 274.829,-184.1199 254.4274,-188.2733 216,-237.2618 192.7502,-266.9014 158.3488,-373.2629 144.076,-419.5197"/>
<polygon fill="#33ff00" stroke="#33ff00" points="140.7022,-418.584 141.1219,-429.1705 147.3957,-420.6329 140.7022,-418.584"/>
</g>
<!-- sourcefile~cc.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~cc.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M392.959,-533.6713C373.8829,-536.5865 348.6795,-543.0283 331,-557.2618 304.9734,-578.2156 317.6287,-598.6776 295,-623.2618 292.3242,-626.1688 289.2586,-628.9017 286.0442,-631.4232"/>
<polygon fill="#00ff66" stroke="#00ff66" points="283.9999,-628.5822 277.8849,-637.2343 288.0607,-634.2839 283.9999,-628.5822"/>
</g>
<!-- sourcefile~cc.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~cc.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M392.7001,-536.85C374.655,-541.1137 350.7726,-547.8643 331,-557.2618 294.2006,-574.7519 293.5915,-623.7234 255.5,-609.2618"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M255.5,-609.2618C191.5705,-584.9907 157.188,-502.7411 143.9715,-463.0472"/>
<polygon fill="#00ff66" stroke="#00ff66" points="147.2995,-461.9631 140.9295,-453.4971 140.6297,-464.0877 147.2995,-461.9631"/>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M383.8572,-1343.6703C365.3824,-1340.8999 344.0922,-1334.329 331,-1319.2618 297.7236,-1280.9657 265.2687,-916.567 257.335,-821.7322"/>
<polygon fill="#0066ff" stroke="#0066ff" points="260.8047,-821.2201 256.4907,-811.5434 253.8286,-821.7983 260.8047,-821.2201"/>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M383.8321,-1344.1305C365.1121,-1341.5185 343.5976,-1334.9519 331,-1319.2618 293.2828,-1272.2857 305.8916,-837.5132 295,-778.2618 287.8914,-739.5906 273.1206,-696.166 263.7932,-670.8508"/>
<polygon fill="#0066ff" stroke="#0066ff" points="267.0678,-669.6149 260.2821,-661.4782 260.5126,-672.0706 267.0678,-669.6149"/>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M383.7644,-1354.9615C341.9023,-1365.2632 276.1308,-1378.3907 255.5,-1365.2618"/>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M401.073,-1357.4355C382.9349,-1369.1893 354.8684,-1387.6065 331,-1404.2618 287.26,-1434.7834 177.0062,-1582.095 137.5,-1546.2618"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M137.5,-1546.2618C54.9362,-1469.873 33.147,-614.1263 29.9455,-463.7545"/>
<polygon fill="#0066ff" stroke="#0066ff" points="33.4388,-463.3898 29.7324,-453.4645 26.4403,-463.5349 33.4388,-463.3898"/>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~fclose.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~fclose.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M394.1828,-1357.4112C374.7276,-1367.6393 348.4991,-1383.8575 331,-1404.2618 306.1443,-1433.2441 313.0593,-1448.622 295,-1482.2618 287.0274,-1497.1128 277.051,-1513.2605 269.1191,-1525.6207"/>
<polygon fill="#0066ff" stroke="#0066ff" points="266.0269,-1523.9563 263.5192,-1534.2501 271.8988,-1527.7669 266.0269,-1523.9563"/>
</g>
<!-- sourcefile~dump_solution.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dump_solution.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M782.4349,-484.5762C770.8715,-539.5424 723.1109,-760.6342 699,-780.2618 602.6124,-858.7267 544.1506,-805.0877 420,-799.2618"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M420,-799.2618C377.0164,-797.1391 327.6379,-797.5154 294.2868,-798.1842"/>
<polygon fill="#3200ff" stroke="#3200ff" points="293.9708,-794.6902 284.05,-798.4089 294.1244,-801.6885 293.9708,-794.6902"/>
</g>
<!-- sourcefile~dump_solution.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dump_solution.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M734.9391,-473.3013C684.4038,-476.2069 605.4038,-485.943 545,-517.2618 525.1892,-527.5336 528.681,-541.7435 509,-552.2618 473.328,-571.3265 456.4338,-553.6969 420,-571.2618"/>
</g>
<!-- sourcefile~dump_solution.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dump_solution.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M420,-251.2618C379.0992,-253.6161 368.183,-258.0618 331,-275.2618 294.0205,-292.3677 291.3035,-307.8142 255.5,-327.2618"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M255.5,-327.2618C211.8722,-350.9594 172.9529,-395.2332 152.5544,-421.0795"/>
<polygon fill="#3200ff" stroke="#3200ff" points="149.7147,-419.0302 146.3665,-429.0821 155.2524,-423.3121 149.7147,-419.0302"/>
</g>
<!-- sourcefile~dump_solution.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dump_solution.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M622,-251.2618C582.9778,-229.0745 464.8147,-248.6823 420,-251.2618"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M420,-251.2618C379.6199,-253.5861 370.3962,-241.421 331,-232.2618 297.2971,-224.4263 290.0178,-210.852 255.5,-213.2618"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M255.5,-213.2618C245.205,-213.9806 174.8916,-261.941 137.5,-289.2618"/>
</g>
<!-- sourcefile~dump_solution.f90&#45;&gt;sourcefile~layout.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dump_solution.f90&#45;&gt;sourcefile~layout.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M780.3304,-460.171C764.7507,-421.6785 710.4837,-301.572 622,-251.2618"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M622,-251.2618C594.8149,-235.8049 510.4479,-222.7934 459.7498,-216.1036"/>
<polygon fill="#3200ff" stroke="#3200ff" points="460.1474,-212.6259 449.7806,-214.8122 459.2481,-219.5679 460.1474,-212.6259"/>
</g>
<!-- sourcefile~write_output.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~write_output.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node30"><a xlink:href=".././sourcefile/write_output.f90.html" xlink:title="write_output.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="666.5,-463.2618 577.5,-463.2618 577.5,-439.2618 666.5,-439.2618 666.5,-463.2618"/>
<text text-anchor="middle" x="622" y="-448.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dump_solution.f90&#45;&gt;sourcefile~write_output.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dump_solution.f90&#45;&gt;sourcefile~write_output.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M734.7646,-465.7898C716.3749,-463.4206 695.4821,-460.7289 676.7196,-458.3116"/>
<polygon fill="#3200ff" stroke="#3200ff" points="676.91,-454.8073 666.5447,-457.0007 676.0154,-461.7499 676.91,-454.8073"/>
</g>
<!-- sourcefile~layout.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~layout.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M390.1447,-211.7746C370.2538,-213.8201 345.2389,-220.002 331,-237.2618 276.1767,-303.7166 339.3539,-549.4069 295,-623.2618 293.4546,-625.8352 291.5448,-628.2038 289.4064,-630.3737"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="286.899,-627.907 281.4519,-636.9944 291.377,-633.2873 286.899,-627.907"/>
</g>
<!-- sourcefile~layout.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~layout.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M390.2231,-211.0913C354.4458,-212.4088 294.3902,-219.6586 255.5,-251.2618"/>
</g>
<!-- sourcefile~layout.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~layout.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M390.389,-201.2158C349.2288,-189.0446 273.325,-173.1951 216,-199.2618 167.6831,-221.2324 178.9939,-256.1637 137.5,-289.2618"/>
</g>
<!-- sourcefile~ghost_gradient.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~ghost_gradient.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M388.4127,-1413.1286C368.288,-1403.6111 343.6914,-1388.2608 331,-1366.2618 265.5817,-1252.8678 318.3265,-907.0782 295,-778.2618 287.9939,-739.5719 273.1911,-696.1531 263.8296,-670.8441"/>
<polygon fill="#ff0098" stroke="#ff0098" points="267.1016,-669.6014 260.3046,-661.4741 260.5499,-672.0661 267.1016,-669.6014"/>
</g>
<!-- sourcefile~ghost_gradient.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~ghost_gradient.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M370.297,-1413.2309C336.2557,-1403.5738 291.0207,-1387.8662 255.5,-1365.2618"/>
</g>
<!-- sourcefile~fclose.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~fclose.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.3866,-1556.0904C199.8113,-1563.0359 161.1715,-1567.7326 137.5,-1546.2618"/>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M604.4254,-463.321C587.6326,-475.4869 562.3737,-495.5355 545,-517.2618 523.6433,-543.969 530.457,-558.6351 509,-585.2618 472.4662,-630.5979 335.5186,-737.8059 279.5548,-780.8769"/>
<polygon fill="#00ffff" stroke="#00ffff" points="277.0952,-778.3528 271.296,-787.2196 281.3589,-783.9045 277.0952,-778.3528"/>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M577.2828,-461.1043C565.7889,-465.2587 554.11,-471.0976 545,-479.2618 518.0603,-503.405 537.5451,-530.0398 509,-552.2618 477.0841,-577.1079 456.4338,-553.6969 420,-571.2618"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M420,-571.2618C375.4297,-592.7495 323.8558,-617.125 290.5107,-632.8213"/>
<polygon fill="#00ffff" stroke="#00ffff" points="288.7519,-629.7807 281.1931,-637.2047 291.7317,-636.1148 288.7519,-629.7807"/>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M420,-289.2618C350.7552,-260.3547 321.4372,-291.4463 255.5,-327.2618"/>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M615.6095,-439.1681C600.7218,-412.2036 561.0047,-346.892 509,-313.2618 474.598,-291.0149 457.8064,-305.0446 420,-289.2618"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M420,-289.2618C382.1936,-273.4791 367.6695,-283.5312 331,-265.2618 294.5312,-247.0925 296.1454,-210.4242 255.5,-213.2618"/>
</g>
<!-- sourcefile~write_output_tec_node.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~write_output_tec_node.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node31"><a xlink:href=".././sourcefile/write_output_tec_node.f90.html" xlink:title="write_output_tec_node.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="489.5,-463.2618 350.5,-463.2618 350.5,-439.2618 489.5,-439.2618 489.5,-463.2618"/>
<text text-anchor="middle" x="420" y="-448.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output_tec_node.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec_node.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec_node.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M577.1697,-451.2618C554.4926,-451.2618 526.2762,-451.2618 500.035,-451.2618"/>
<polygon fill="#00ffff" stroke="#00ffff" points="499.707,-447.7619 489.707,-451.2618 499.7069,-454.7619 499.707,-447.7619"/>
</g>
<!-- sourcefile~write_output_vtk.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~write_output_vtk.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node32"><a xlink:href=".././sourcefile/write_output_vtk.f90.html" xlink:title="write_output_vtk.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="474.5,-421.2618 365.5,-421.2618 365.5,-397.2618 474.5,-397.2618 474.5,-421.2618"/>
<text text-anchor="middle" x="420" y="-406.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output_vtk.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_vtk.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_vtk.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M577.1697,-441.9407C550.0186,-436.2954 514.9269,-428.9991 484.7917,-422.7334"/>
<polygon fill="#00ffff" stroke="#00ffff" points="485.2838,-419.2609 474.7806,-420.6519 483.8587,-426.1143 485.2838,-419.2609"/>
</g>
<!-- sourcefile~write_output_tec.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~write_output_tec.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node33"><a xlink:href=".././sourcefile/write_output_tec.f90.html" xlink:title="write_output_tec.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="474.5,-379.2618 365.5,-379.2618 365.5,-355.2618 474.5,-355.2618 474.5,-379.2618"/>
<text text-anchor="middle" x="420" y="-364.8618" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output_tec.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M603.9794,-439.1369C582.299,-425.0512 544.3881,-401.994 509,-388.2618 501.2344,-385.2484 492.9134,-382.5881 484.5909,-380.2627"/>
<polygon fill="#00ffff" stroke="#00ffff" points="485.4161,-376.8607 474.8534,-377.6857 483.6251,-383.6277 485.4161,-376.8607"/>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390.8103,-463.4617C370.963,-473.249 345.7262,-488.8907 331,-510.2618 289.6424,-570.2813 313.6838,-599.8083 295,-670.2618 284.9135,-708.2965 271.0543,-751.9663 262.718,-777.495"/>
<polygon fill="#ff0000" stroke="#ff0000" points="259.3073,-776.663 259.5105,-787.2559 265.9575,-778.8483 259.3073,-776.663"/>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M392.2106,-463.4449C372.5141,-473.4008 346.8661,-489.2563 331,-510.2618 299.2311,-552.3214 326.8376,-581.2542 295,-623.2618 292.9668,-625.9445 290.5717,-628.4347 287.9828,-630.7254"/>
<polygon fill="#ff0000" stroke="#ff0000" points="285.6127,-628.132 279.8025,-636.9916 289.8695,-633.689 285.6127,-628.132"/>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M255.5,-441.2618C234.8478,-434.4991 211.0501,-433.3409 190.2598,-434.3037"/>
<polygon fill="#ff0000" stroke="#ff0000" points="189.7667,-430.8279 180.0094,-434.9565 190.2116,-437.8137 189.7667,-430.8279"/>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M354.0394,-463.2911C337.9166,-466.2315 320.9238,-469.3304 305.6751,-472.1114"/>
<polygon fill="#ff0000" stroke="#ff0000" points="304.6389,-468.7425 295.4291,-473.9799 305.8948,-475.6289 304.6389,-468.7425"/>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M350.105,-454.7777C320.3025,-454.309 285.5461,-451.1007 255.5,-441.2618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M255.5,-441.2618C174.2237,-414.6472 205.0022,-236.7488 137.5,-289.2618"/>
</g>
<!-- sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M365.2258,-411.788C352.4164,-414.9507 339.9237,-420.5666 331,-430.2618 294.4773,-469.9422 306.9277,-617.6674 295,-670.2618 286.3425,-708.4368 272.1543,-751.7466 263.3464,-777.217"/>
<polygon fill="#00ff00" stroke="#00ff00" points="259.9316,-776.3789 259.9327,-786.9737 266.5389,-778.6907 259.9316,-776.3789"/>
</g>
<!-- sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M365.4598,-412.0072C352.6472,-415.167 340.0944,-420.7267 331,-430.2618 270.7764,-493.4041 343.2949,-550.5884 295,-623.2618 293.1824,-625.9969 290.9684,-628.5121 288.5264,-630.8092"/>
<polygon fill="#00ff00" stroke="#00ff00" points="286.3304,-628.0837 280.684,-637.0487 290.6886,-633.5616 286.3304,-628.0837"/>
</g>
<!-- sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M365.3835,-400.8563C333.1096,-397.4741 291.6217,-395.893 255.5,-403.2618"/>
</g>
<!-- sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M365.2805,-418.7591C353.6934,-421.7057 341.7301,-425.4784 331,-430.2618 313.2082,-438.1933 311.1368,-444.3504 295,-455.2618 290.9619,-457.9923 286.6721,-460.8549 282.4646,-463.6413"/>
<polygon fill="#00ff00" stroke="#00ff00" points="280.4738,-460.7615 274.0507,-469.1873 284.3263,-466.6061 280.4738,-460.7615"/>
</g>
<!-- sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M365.2587,-398.5414C353.7883,-395.6869 341.8774,-392.2609 331,-388.2618 285.6656,-371.5946 175.6235,-259.6038 137.5,-289.2618"/>
</g>
<!-- sourcefile~write_output_tec.f90&#45;&gt;sourcefile~string.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~write_output_tec.f90&#45;&gt;sourcefile~string.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M365.0795,-369.6548C352.2721,-372.8193 339.8169,-378.4694 331,-388.2618 288.7281,-435.2107 308.2964,-608.5017 295,-670.2618 286.7613,-708.5294 272.4451,-751.8109 263.4978,-777.2505"/>
<polygon fill="#0000ff" stroke="#0000ff" points="260.0855,-776.3995 260.0253,-786.9942 266.6793,-778.7495 260.0855,-776.3995"/>
</g>
<!-- sourcefile~write_output_tec.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~write_output_tec.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M365.2465,-369.8071C352.4368,-372.9695 339.9388,-378.5806 331,-388.2618 259.3213,-465.8943 352.0488,-534.3232 295,-623.2618 293.2269,-626.026 291.0436,-628.5611 288.6215,-630.8713"/>
<polygon fill="#0000ff" stroke="#0000ff" points="286.425,-628.1463 280.8104,-637.1311 290.8025,-633.6087 286.425,-628.1463"/>
</g>
<!-- sourcefile~write_output_tec.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~write_output_tec.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M366.7404,-379.3191C334.5768,-386.5004 292.7384,-395.6651 255.5,-403.2618"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M255.5,-403.2618C229.2316,-408.6206 200.5884,-417.7615 178.101,-425.7351"/>
<polygon fill="#0000ff" stroke="#0000ff" points="176.7678,-422.4952 168.5499,-429.1822 179.1442,-429.0795 176.7678,-422.4952"/>
</g>
<!-- sourcefile~write_output_tec.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~write_output_tec.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M365.4626,-372.5438C353.2321,-375.7011 340.9483,-380.6246 331,-388.2618 304.1862,-408.8467 317.815,-430.3181 295,-455.2618 292.3334,-458.1773 289.2734,-460.9154 286.0623,-463.4398"/>
<polygon fill="#0000ff" stroke="#0000ff" points="284.0175,-460.5992 277.9066,-469.2541 288.081,-466.299 284.0175,-460.5992"/>
</g>
<!-- sourcefile~write_output_tec.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~write_output_tec.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M366.4985,-355.1795C354.485,-351.5048 342.036,-346.9044 331,-341.2618 312.9523,-332.0344 313.621,-321.2696 295,-313.2618 229.9517,-285.2886 192.6954,-244.9082 137.5,-289.2618"/>
</g>
</g>
</svg>
</div><script>var pansourcefileupdatef90EfferentGraph = svgPanZoom('#sourcefileupdatef90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~update.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileupdatef90AfferentGraph" width="375pt" height="52pt"
 viewBox="0.00 0.00 375.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~update.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~update.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 371,-48 371,4 -4,4"/>
<!-- sourcefile~update.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~update.f90</title>
<polygon fill="none" stroke="#000000" points="64,-44 0,-44 0,-20 64,-20 64,-44"/>
<text text-anchor="middle" x="32" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">update.f90</text>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~update.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="159,-44 100,-44 100,-20 159,-20 159,-44"/>
<text text-anchor="middle" x="129.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~update.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~update.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M99.9822,-32C91.8447,-32 82.8557,-32 74.1525,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="74.1352,-28.5001 64.1352,-32 74.1351,-35.5001 74.1352,-28.5001"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~update.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="367,-44 313,-44 313,-20 367,-20 367,-44"/>
<text text-anchor="middle" x="340" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M312.7124,-32.5275C301.6304,-32.7172 288.7042,-32.9071 277,-33 240.5567,-33.2892 231.4434,-33.2782 195,-33 186.6723,-32.9364 177.7495,-32.8274 169.2535,-32.7041"/>
<polygon fill="#ff0000" stroke="#ff0000" points="169.2233,-29.2034 159.1706,-32.5488 169.1154,-36.2025 169.2233,-29.2034"/>
</g>
<!-- sourcefile~start_finish.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~start_finish.f90</title>
<g id="a_sourcefile~~update.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/start_finish.f90.html" xlink:title="start_finish.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="277,-24 195,-24 195,0 277,0 277,-24"/>
<text text-anchor="middle" x="236" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_finish.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~start_finish.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~start_finish.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M312.9467,-26.7974C304.9882,-25.267 296.0079,-23.54 287.0646,-21.8201"/>
<polygon fill="#00ffff" stroke="#00ffff" points="287.5205,-18.3437 277.0394,-19.8922 286.1985,-25.2178 287.5205,-18.3437"/>
</g>
<!-- sourcefile~start_finish.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~start_finish.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M194.8243,-19.7325C186.3352,-21.3267 177.4138,-23.0021 168.9863,-24.5847"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.1959,-21.1719 159.0137,-26.4575 169.4879,-28.0516 168.1959,-21.1719"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/update.html">update</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/update.f90.html#src">update.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>  <span class="c">!&lt; Time integration module</span>
<a name="ln-2"></a><span class="k">module </span><span class="n">update</span>
<a name="ln-3"></a>  <span class="c">!&lt; This module march the solution is time.</span>
<a name="ln-4"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cphi1</span>
<a name="ln-5"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cphi2</span>
<a name="ln-6"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">fphi</span>
<a name="ln-7"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">eta</span>
<a name="ln-8"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cd1</span>
<a name="ln-9"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cmu</span>
<a name="ln-10"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">beta1</span>
<a name="ln-11"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">beta2</span>
<a name="ln-12"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">bstar</span>
<a name="ln-13"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sst_F1</span>
<a name="ln-14"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cb1</span>
<a name="ln-15"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cw1</span>
<a name="ln-16"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cw2</span>
<a name="ln-17"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cw3</span>
<a name="ln-18"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cv1</span>
<a name="ln-19"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">kappa_sa</span>
<a name="ln-20"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradu_x</span>
<a name="ln-21"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradu_y</span>
<a name="ln-22"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradu_z</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradv_x</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradv_y</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradv_z</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradw_x</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradw_y</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">global_vars</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradw_z</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">imx</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">jmx</span>
<a name="ln-31"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">kmx</span>
<a name="ln-32"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">R_gas</span>
<a name="ln-33"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Pr</span>
<a name="ln-34"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">tPr</span>
<a name="ln-35"></a>
<a name="ln-36"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">volume</span>
<a name="ln-37"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">xnx</span><span class="p">,</span> <span class="n">xny</span><span class="p">,</span> <span class="n">xnz</span> <span class="c">!face unit normal x</span>
<a name="ln-38"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ynx</span><span class="p">,</span> <span class="n">yny</span><span class="p">,</span> <span class="n">ynz</span> <span class="c">!face unit normal y</span>
<a name="ln-39"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">znx</span><span class="p">,</span> <span class="n">zny</span><span class="p">,</span> <span class="n">znz</span> <span class="c">!face unit normal z</span>
<a name="ln-40"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">xA</span><span class="p">,</span> <span class="n">yA</span><span class="p">,</span> <span class="n">zA</span>    <span class="c">!face area</span>
<a name="ln-41"></a>    
<a name="ln-42"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">n_var</span>
<a name="ln-43"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">imx</span>
<a name="ln-44"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">jmx</span>
<a name="ln-45"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">kmx</span>
<a name="ln-46"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gm</span>
<a name="ln-47"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sst_n_var</span>
<a name="ln-48"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">qp</span>
<a name="ln-49"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">qp_inf</span>
<a name="ln-50"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">density</span>
<a name="ln-51"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">x_speed</span>
<a name="ln-52"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">y_speed</span>
<a name="ln-53"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">z_speed</span>
<a name="ln-54"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">pressure</span>
<a name="ln-55"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dist</span>
<a name="ln-56"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mu</span>
<a name="ln-57"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mu_t</span>
<a name="ln-58"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">tk_inf</span>
<a name="ln-59"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">tkl_inf</span>
<a name="ln-60"></a>
<a name="ln-61"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">time_stepping_method</span>
<a name="ln-62"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">time_step_accuracy</span>
<a name="ln-63"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">global_time_step</span>
<a name="ln-64"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">delta_t</span>
<a name="ln-65"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">turbulence</span>
<a name="ln-66"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">process_id</span>
<a name="ln-67"></a>
<a name="ln-68"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">F_p</span>
<a name="ln-69"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">G_p</span>
<a name="ln-70"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">H_p</span>
<a name="ln-71"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mass_residue</span>
<a name="ln-72"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">x_mom_residue</span>
<a name="ln-73"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">y_mom_residue</span>
<a name="ln-74"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">z_mom_residue</span>
<a name="ln-75"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">energy_residue</span>
<a name="ln-76"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">TKE_residue</span>
<a name="ln-77"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">omega_residue</span>
<a name="ln-78"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">kl_residue</span>
<a name="ln-79"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">residue</span>
<a name="ln-80"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">mu_ref</span>
<a name="ln-81"></a>
<a name="ln-82"></a>  <span class="k">use </span><span class="n">geometry</span>   <span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">CellCenter</span>
<a name="ln-83"></a>
<a name="ln-84"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">alloc</span>
<a name="ln-85"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span>  <span class="n">dealloc</span> 
<a name="ln-86"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span>  <span class="n">dmsg</span>
<a name="ln-87"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span>  <span class="n">DEBUG_LEVEL</span>
<a name="ln-88"></a>
<a name="ln-89"></a>  <span class="k">use </span><span class="n">string</span>
<a name="ln-90"></a>
<a name="ln-91"></a>  <span class="c">!subroutine for residual calculation</span>
<a name="ln-92"></a>  <span class="k">use </span><span class="n">face_interpolant</span><span class="p">,</span>               <span class="n">only</span><span class="p">:</span> <span class="n">interpolant</span>
<a name="ln-93"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>                    <span class="n">only</span> <span class="p">:</span> <span class="n">mu_ref</span>
<a name="ln-94"></a>  <span class="k">use </span><span class="n">interface1</span><span class="p">,</span>                      <span class="n">only</span><span class="p">:</span> <span class="n">apply_interface</span>
<a name="ln-95"></a>  <span class="k">use </span><span class="n">bc_primitive</span><span class="p">,</span>                   <span class="n">only</span><span class="p">:</span> <span class="n">populate_ghost_primitive</span>
<a name="ln-96"></a>  <span class="k">use </span><span class="n">face_interpolant</span><span class="p">,</span>               <span class="n">only</span><span class="p">:</span> <span class="n">compute_face_interpolant</span>
<a name="ln-97"></a>  <span class="k">use </span><span class="n">boundary_state_reconstruction</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">reconstruct_boundary_state</span>
<a name="ln-98"></a>  <span class="k">use </span><span class="n">scheme</span><span class="p">,</span>                         <span class="n">only</span><span class="p">:</span> <span class="n">compute_fluxes</span>
<a name="ln-99"></a>  <span class="k">use </span><span class="n">summon_grad_evaluation</span><span class="p">,</span>         <span class="n">only</span><span class="p">:</span> <span class="n">evaluate_all_gradients</span>
<a name="ln-100"></a>  <span class="k">use </span><span class="n">viscosity</span>                      <span class="p">,</span><span class="n">only</span><span class="p">:</span> <span class="n">calculate_viscosity</span>
<a name="ln-101"></a>  <span class="k">use </span><span class="n">viscous</span><span class="p">,</span>                        <span class="n">only</span><span class="p">:</span> <span class="n">compute_viscous_fluxes</span>
<a name="ln-102"></a><span class="c">!  use turbulent_fluxes,               only: compute_turbulent_fluxes</span>
<a name="ln-103"></a>  <span class="k">use </span><span class="n">scheme</span><span class="p">,</span>                         <span class="n">only</span><span class="p">:</span> <span class="n">compute_residue</span>
<a name="ln-104"></a>  <span class="k">use </span><span class="n">source</span><span class="p">,</span>                         <span class="n">only</span><span class="p">:</span> <span class="n">add_source_term_residue</span>
<a name="ln-105"></a>
<a name="ln-106"></a>  <span class="k">use </span><span class="nb">time</span><span class="p">,</span>                           <span class="n">only</span> <span class="p">:</span> <span class="n">compute_time_step</span>
<a name="ln-107"></a>  <span class="c">!--- sst implicit update ---!</span>
<a name="ln-108"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sst_F1</span>
<a name="ln-109"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_k1</span>
<a name="ln-110"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_k2</span>
<a name="ln-111"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_w1</span>
<a name="ln-112"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_w2</span>
<a name="ln-113"></a>
<a name="ln-114"></a>  <span class="k">use </span><span class="n">plusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">update_with_plusgs</span>
<a name="ln-115"></a>  <span class="k">use </span><span class="n">plusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">setup_plusgs</span>
<a name="ln-116"></a>  <span class="k">use </span><span class="n">plusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">destroy_plusgs</span>
<a name="ln-117"></a>  <span class="k">use </span><span class="n">lusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">update_with_lusgs</span>
<a name="ln-118"></a>  <span class="k">use </span><span class="n">lusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">setup_lusgs</span>
<a name="ln-119"></a>  <span class="k">use </span><span class="n">lusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">destroy_lusgs</span>
<a name="ln-120"></a><span class="cp">#include &quot;error.inc&quot;</span>
<a name="ln-121"></a><span class="cp">#include &quot;mpi.inc&quot;</span>
<a name="ln-122"></a>    <span class="k">private</span>
<a name="ln-123"></a>
<a name="ln-124"></a><span class="k">    </span><span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">U_store</span>
<a name="ln-125"></a>    <span class="c">!&lt; Array to store the intermediate solution</span>
<a name="ln-126"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">R_store</span>
<a name="ln-127"></a>    <span class="c">!&lt; Array to store the intermediate Residue</span>
<a name="ln-128"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">aux</span>
<a name="ln-129"></a>    <span class="c">!&lt; Array to store some auxilary intermediate variables</span>
<a name="ln-130"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span>      <span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u1</span>
<a name="ln-131"></a>    <span class="c">!&lt; Variable array old for each cell center</span>
<a name="ln-132"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span>      <span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u2</span>
<a name="ln-133"></a>    <span class="c">!&lt; Variable array new for each cell center</span>
<a name="ln-134"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span>      <span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">R</span>
<a name="ln-135"></a>    <span class="c">!&lt; Residue array for each cell center</span>
<a name="ln-136"></a>
<a name="ln-137"></a>    <span class="c">! Public methods</span>
<a name="ln-138"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">setup_update</span>
<a name="ln-139"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">destroy_update</span>
<a name="ln-140"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">get_next_solution</span>
<a name="ln-141"></a>
<a name="ln-142"></a>    <span class="k">contains</span>
<a name="ln-143"></a>
<a name="ln-144"></a>
<a name="ln-145"></a><span class="k">      subroutine </span><span class="n">setup_update</span><span class="p">()</span>
<a name="ln-146"></a>        <span class="c">!&lt; Allocate memory to variables required based </span>
<a name="ln-147"></a>        <span class="c">!&lt; on the time-integration scheme.</span>
<a name="ln-148"></a>        <span class="k">implicit none</span>
<a name="ln-149"></a>
<a name="ln-150"></a><span class="k">        call </span><span class="n">alloc</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-151"></a>        <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">u2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-152"></a>        <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">R</span> <span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-153"></a>        <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-154"></a>
<a name="ln-155"></a>        <span class="k">select case</span> <span class="p">(</span><span class="n">time_step_accuracy</span><span class="p">)</span>
<a name="ln-156"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a name="ln-157"></a>            <span class="c">! Do nothing</span>
<a name="ln-158"></a>            <span class="k">continue</span>
<a name="ln-159"></a><span class="k">          case</span> <span class="p">(</span><span class="s2">&quot;RK2&quot;</span><span class="p">,</span> <span class="s2">&quot;RK4&quot;</span><span class="p">)</span>
<a name="ln-160"></a>            <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">U_store</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-161"></a>            <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">R_store</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-162"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;TVDRK2&quot;</span><span class="p">,</span> <span class="s2">&quot;TVDRK3&quot;</span><span class="p">,</span> <span class="s2">&quot;TVDRK4&quot;</span><span class="p">)</span>
<a name="ln-163"></a>            <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">U_store</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-164"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;implicit&quot;</span><span class="p">)</span>
<a name="ln-165"></a>            <span class="k">call </span><span class="n">setup_lusgs</span><span class="p">()</span>
<a name="ln-166"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;plusgs&quot;</span><span class="p">)</span>
<a name="ln-167"></a>            <span class="k">call </span><span class="n">setup_plusgs</span><span class="p">()</span>
<a name="ln-168"></a>          <span class="k">case </span><span class="n">default</span>
<a name="ln-169"></a>            <span class="n">Fatal_error</span>
<a name="ln-170"></a>        <span class="k">end select</span>
<a name="ln-171"></a>
<a name="ln-172"></a><span class="k">      end subroutine </span><span class="n">setup_update</span>
<a name="ln-173"></a>
<a name="ln-174"></a>
<a name="ln-175"></a>      <span class="k">subroutine </span><span class="n">destroy_update</span><span class="p">()</span>
<a name="ln-176"></a>        <span class="c">!&lt; Dellocate memory from all variables</span>
<a name="ln-177"></a>        <span class="k">implicit none</span>
<a name="ln-178"></a>
<a name="ln-179"></a><span class="k">        select case</span> <span class="p">(</span><span class="n">time_step_accuracy</span><span class="p">)</span>
<a name="ln-180"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a name="ln-181"></a>            <span class="c">! Do nothing</span>
<a name="ln-182"></a>            <span class="k">continue</span>
<a name="ln-183"></a><span class="k">          case</span> <span class="p">(</span><span class="s2">&quot;RK2&quot;</span><span class="p">,</span> <span class="s2">&quot;RK4&quot;</span><span class="p">)</span>
<a name="ln-184"></a>            <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">U_store</span><span class="p">)</span>
<a name="ln-185"></a>            <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">R_store</span><span class="p">)</span>
<a name="ln-186"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;TVDRK2&quot;</span><span class="p">,</span><span class="s2">&quot;TVDRK3&quot;</span><span class="p">,</span> <span class="s2">&quot;TVDRK4&quot;</span><span class="p">)</span>
<a name="ln-187"></a>            <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">U_store</span><span class="p">)</span>
<a name="ln-188"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;implicit&quot;</span><span class="p">)</span>
<a name="ln-189"></a>            <span class="k">call </span><span class="n">destroy_lusgs</span><span class="p">()</span>
<a name="ln-190"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;plusgs&quot;</span><span class="p">)</span>
<a name="ln-191"></a>            <span class="k">call </span><span class="n">destroy_plusgs</span><span class="p">()</span>
<a name="ln-192"></a>          <span class="k">case </span><span class="n">default</span>
<a name="ln-193"></a>            <span class="n">Fatal_error</span>
<a name="ln-194"></a>        <span class="k">end select</span>
<a name="ln-195"></a><span class="k">        call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span>
<a name="ln-196"></a>        <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span>
<a name="ln-197"></a>        <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<a name="ln-198"></a>        <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">aux</span><span class="p">)</span>
<a name="ln-199"></a>
<a name="ln-200"></a>      <span class="k">end subroutine </span><span class="n">destroy_update</span>
<a name="ln-201"></a>
<a name="ln-202"></a>
<a name="ln-203"></a>      <span class="k">subroutine </span><span class="n">get_next_solution</span><span class="p">()</span>
<a name="ln-204"></a>        <span class="c">!&lt; Get solution at next time-step using scheme</span>
<a name="ln-205"></a>        <span class="c">!&lt; given in the input file.</span>
<a name="ln-206"></a>        <span class="k">implicit none</span>
<a name="ln-207"></a><span class="k">        select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">time_step_accuracy</span><span class="p">))</span>
<a name="ln-208"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a name="ln-209"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-210"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">()</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-211"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.</span> <span class="p">,</span><span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span> 
<a name="ln-212"></a>              <span class="c">!call update_with(&quot;primitive&quot;, 1. ,1., .FALSE.) </span>
<a name="ln-213"></a>              <span class="c">!call update_laminar_variables_primitive(1. ,1., .FALSE.) </span>
<a name="ln-214"></a>              <span class="c">!if(turbulence/=&#39;none&#39;)then</span>
<a name="ln-215"></a>              <span class="c">!  call update_turbulent_variables_primitive(1. ,1., .FALSE.) </span>
<a name="ln-216"></a>              <span class="c">!end if</span>
<a name="ln-217"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;RK4&quot;</span><span class="p">)</span>
<a name="ln-218"></a>              <span class="n">R_store</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-219"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-220"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-221"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">()</span>
<a name="ln-222"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-223"></a>              <span class="c">!call update_laminar_variables_primitive(0.5, 1., .FALSE., .True., R_store, U_store) </span>
<a name="ln-224"></a>              <span class="c">!call update_turbulent_variables_primitive(0.5, 1., .FALSE., .True., R_store, U_store) </span>
<a name="ln-225"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-226"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-227"></a>              <span class="c">!call update_laminar_variables_primitive(0.5, 2., .FALSE., .True., R_store, U_store) </span>
<a name="ln-228"></a>              <span class="c">!call update_turbulent_variables_primitive(0.5, 2., .FALSE., .True., R_store, U_store) </span>
<a name="ln-229"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-230"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-231"></a>              <span class="c">!call update_laminar_variables_primitive(1.0, 2., .FALSE., .True., R_store, U_store) </span>
<a name="ln-232"></a>              <span class="c">!call update_turbulent_variables_primitive(1.0, 2., .FALSE., .True., R_store, U_store) </span>
<a name="ln-233"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-234"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-235"></a>              <span class="c">!call update_laminar_variables_primitive(1./6., 1., .TRUE., .FALSE., R_store, U_store) </span>
<a name="ln-236"></a>              <span class="c">!call update_turbulent_variables_primitive(1./6., 1., .TRUE., .FALSE., R_store, U_store) </span>
<a name="ln-237"></a>            <span class="k">case</span><span class="p">(</span><span class="s2">&quot;RK2&quot;</span><span class="p">)</span>
<a name="ln-238"></a>              <span class="n">R_store</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-239"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-240"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-241"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">()</span>
<a name="ln-242"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-243"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-244"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-245"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;TVDRK3&quot;</span><span class="p">)</span>
<a name="ln-246"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-247"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-248"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">()</span>
<a name="ln-249"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-250"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-251"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-252"></a>              <span class="n">qp</span> <span class="o">=</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">U_store</span> <span class="o">+</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">qp</span>
<a name="ln-253"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-254"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-255"></a>              <span class="n">qp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">U_store</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">qp</span>
<a name="ln-256"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;TVDRK2&quot;</span><span class="p">)</span>
<a name="ln-257"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-258"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-259"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">()</span>
<a name="ln-260"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-261"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-262"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-263"></a>              <span class="n">qp</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">U_store</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">qp</span>
<a name="ln-264"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;TVDRK4&quot;</span><span class="p">)</span>
<a name="ln-265"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-266"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-267"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">()</span>
<a name="ln-268"></a>              <span class="k">call </span><span class="n">update_laminar_variables_conservative</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">un</span><span class="o">=</span><span class="n">U_store</span><span class="p">)</span> 
<a name="ln-269"></a>              <span class="k">if</span><span class="p">(</span><span class="n">turbulence</span><span class="o">/=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-270"></a><span class="k">                call </span><span class="n">update_turbulent_variables_conservative</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">un</span><span class="o">=</span><span class="n">U_store</span><span class="p">)</span>
<a name="ln-271"></a>              <span class="k">end if</span>
<a name="ln-272"></a><span class="k">              call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-273"></a>              <span class="k">call </span><span class="n">update_laminar_variables_conservative</span><span class="p">(</span><span class="mf">0.333333</span><span class="p">,</span> <span class="n">un</span><span class="o">=</span><span class="n">U_store</span><span class="p">)</span> 
<a name="ln-274"></a>              <span class="c">!if(turbulence/=&#39;none&#39;)then</span>
<a name="ln-275"></a>              <span class="c">!  call update_turbulent_variables_conservative(0.333333, un=U_store)</span>
<a name="ln-276"></a>              <span class="c">!end if</span>
<a name="ln-277"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-278"></a>              <span class="k">call </span><span class="n">update_laminar_variables_conservative</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">un</span><span class="o">=</span><span class="n">U_store</span><span class="p">)</span> 
<a name="ln-279"></a>              <span class="c">!if(turbulence/=&#39;none&#39;)then</span>
<a name="ln-280"></a>              <span class="c">!  call update_turbulent_variables_conservative(0.5, un=U_store)</span>
<a name="ln-281"></a>              <span class="c">!end if</span>
<a name="ln-282"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-283"></a>              <span class="k">call </span><span class="n">update_laminar_variables_conservative</span><span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="n">un</span><span class="o">=</span><span class="n">U_store</span><span class="p">)</span> 
<a name="ln-284"></a>              <span class="c">!if(turbulence/=&#39;none&#39;)then</span>
<a name="ln-285"></a>              <span class="c">!  call update_turbulent_variables_conservative(1.00, un=U_store)</span>
<a name="ln-286"></a>              <span class="c">!end if</span>
<a name="ln-287"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;implicit&quot;</span><span class="p">)</span>
<a name="ln-288"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-289"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">()</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-290"></a>              <span class="k">call </span><span class="n">update_with_lusgs</span><span class="p">()</span>
<a name="ln-291"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;plusgs&quot;</span><span class="p">)</span>
<a name="ln-292"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-293"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">()</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-294"></a>              <span class="k">call </span><span class="n">update_with_plusgs</span><span class="p">()</span>
<a name="ln-295"></a>            <span class="k">case </span><span class="n">default</span>
<a name="ln-296"></a>              <span class="n">Fatal_error</span>
<a name="ln-297"></a>        <span class="k">end select</span>
<a name="ln-298"></a><span class="k">      end subroutine </span><span class="n">get_next_solution</span>
<a name="ln-299"></a>
<a name="ln-300"></a>      <span class="k">subroutine </span><span class="n">update_with</span><span class="p">(</span><span class="k">type</span><span class="p">,</span> <span class="n">time_factor</span><span class="p">,</span> <span class="n">store_factor</span><span class="p">,</span> <span class="k">use</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="n">un</span><span class="p">)</span>
<a name="ln-301"></a>        <span class="c">!&lt; A generalized scheme to updat the solution explicitly using</span>
<a name="ln-302"></a>        <span class="c">!&lt; any RK method and even first order euler explicit.</span>
<a name="ln-303"></a>        <span class="k">implicit none</span>
<a name="ln-304"></a><span class="k">        </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="k">type</span>
<a name="ln-305"></a><span class="k">        </span><span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">time_factor</span> <span class="c">! time factor</span>
<a name="ln-306"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">store_factor</span>
<a name="ln-307"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">use</span>
<a name="ln-308"></a><span class="k">        </span><span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">un</span>
<a name="ln-309"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">Rn</span>
<a name="ln-310"></a>        <span class="kt">real</span>               <span class="kd">::</span> <span class="n">TF</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c">!time factor</span>
<a name="ln-311"></a>        <span class="kt">real</span>               <span class="kd">::</span> <span class="n">SF</span> <span class="o">=</span> <span class="mf">1.0</span><span class="c">!store factor</span>
<a name="ln-312"></a>        <span class="kt">Logical</span>               <span class="kd">::</span> <span class="n">TU</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to use or not</span>
<a name="ln-313"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Quse</span>
<a name="ln-314"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-315"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">KE</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-316"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">beta</span>
<a name="ln-317"></a>
<a name="ln-318"></a>        <span class="c">!sa variables</span>
<a name="ln-319"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">vort</span>
<a name="ln-320"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">fv1</span>
<a name="ln-321"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">fv2</span>
<a name="ln-322"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">fw</span>
<a name="ln-323"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">g</span>
<a name="ln-324"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">scap</span>
<a name="ln-325"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">rsa</span>
<a name="ln-326"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">kd2</span>
<a name="ln-327"></a>        <span class="kt">real</span> <span class="kd">::</span> <span class="n">xi</span> 
<a name="ln-328"></a>
<a name="ln-329"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">time_factor</span><span class="p">))</span> <span class="n">TF</span><span class="o">=</span><span class="n">time_factor</span>
<a name="ln-330"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">store_factor</span><span class="p">))</span> <span class="n">SF</span><span class="o">=</span><span class="n">store_factor</span>
<a name="ln-331"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">use</span><span class="p">))</span> <span class="n">TU</span><span class="o">=</span><span class="k">use</span>
<a name="ln-332"></a>        <span class="c">!check if user want to update from particular solution</span>
<a name="ln-333"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">un</span><span class="p">))</span><span class="k">then</span>
<a name="ln-334"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">un</span><span class="p">(:,:,:,:)</span>
<a name="ln-335"></a>        <span class="k">else</span>
<a name="ln-336"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">qp</span><span class="p">(:,:,:,:)</span>
<a name="ln-337"></a>        <span class="k">end if</span>
<a name="ln-338"></a>
<a name="ln-339"></a><span class="k">        select case</span><span class="p">(</span><span class="k">type</span><span class="p">)</span>
<a name="ln-340"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;primitive&#39;</span><span class="p">)</span>
<a name="ln-341"></a>            <span class="c">!include &quot;update_primitive.inc&quot;</span>
<a name="ln-342"></a>
<a name="ln-343"></a>            <span class="c">!update primitive variable</span>
<a name="ln-344"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-345"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-346"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-347"></a>            
<a name="ln-348"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-349"></a>            
<a name="ln-350"></a>                  <span class="c">! finding primitive residue</span>
<a name="ln-351"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-352"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">x_mom_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-353"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">y_mom_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-354"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">z_mom_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-355"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-356"></a>                         <span class="o">-</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x_mom_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-357"></a>                         <span class="o">-</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">y_mom_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-358"></a>                         <span class="o">-</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">z_mom_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-359"></a>                         <span class="o">+</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">energy_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-360"></a>            
<a name="ln-361"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span>
<a name="ln-362"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-363"></a>                      <span class="c">!do nothing</span>
<a name="ln-364"></a>                      <span class="k">continue</span>
<a name="ln-365"></a><span class="k">                    case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-366"></a>                      <span class="n">beta</span> <span class="o">=</span> <span class="n">beta1</span><span class="o">*</span><span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">beta2</span>
<a name="ln-367"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">TKE_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-368"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-369"></a>                             <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">bstar</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">TKE_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-370"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-371"></a>                             <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">omega_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-372"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-373"></a>                      <span class="n">eta</span>  <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-374"></a>                      <span class="n">fphi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">cd1</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-375"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">TKE_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-376"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-377"></a>                             <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">((</span><span class="mf">2.5</span><span class="o">*</span><span class="p">((</span><span class="n">cmu</span><span class="o">**</span><span class="mf">0.75</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="mf">1.5</span><span class="p">)</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mf">1.e-20</span><span class="p">))&amp;</span>
<a name="ln-378"></a>                             <span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))))</span><span class="o">*</span><span class="n">TKE_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-379"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-380"></a>                             <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">fphi</span><span class="o">/</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">kl_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-381"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-382"></a>                      <span class="n">Fatal_error</span>
<a name="ln-383"></a>                  <span class="k">end select</span>
<a name="ln-384"></a>            
<a name="ln-385"></a>                        
<a name="ln-386"></a>                 <span class="c">!check if user want to store residue</span>
<a name="ln-387"></a>                  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-388"></a><span class="k">                    </span><span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">+</span> <span class="n">SF</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-389"></a>                    <span class="k">if</span><span class="p">(</span><span class="n">TU</span><span class="p">)</span> <span class="n">R</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,:)</span>
<a name="ln-390"></a>                  <span class="k">end if</span>
<a name="ln-391"></a>                 
<a name="ln-392"></a>            
<a name="ln-393"></a>                 <span class="c">!update</span>
<a name="ln-394"></a>                 <span class="n">u2</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(:)</span> <span class="o">-</span> <span class="n">R</span><span class="p">(:)</span><span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">volume</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-395"></a>            
<a name="ln-396"></a>                  <span class="c">!check solution for non pyhysical results</span>
<a name="ln-397"></a>                  <span class="k">if</span><span class="p">((</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span><span class="k">then</span>
<a name="ln-398"></a><span class="k">                    </span><span class="n">Fatal_error</span>
<a name="ln-399"></a>                  <span class="k">else</span> <span class="c">!update</span>
<a name="ln-400"></a>                    <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-401"></a>                    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-402"></a>                     <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-403"></a>                       <span class="k">if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-404"></a>                       <span class="k">if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-405"></a>                     <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-406"></a>                       <span class="c">! do nothing</span>
<a name="ln-407"></a>                       <span class="k">continue</span>
<a name="ln-408"></a><span class="k">                    end select</span>
<a name="ln-409"></a><span class="k">                  end if</span>
<a name="ln-410"></a><span class="k">                end do</span>
<a name="ln-411"></a><span class="k">              end do</span>
<a name="ln-412"></a><span class="k">            end do</span>
<a name="ln-413"></a><span class="k">            </span>
<a name="ln-414"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;conservative&#39;</span><span class="p">)</span>
<a name="ln-415"></a>            <span class="c">!include &quot;update_conservative.inc&quot;</span>
<a name="ln-416"></a>
<a name="ln-417"></a>            <span class="c">!update conservative variable</span>
<a name="ln-418"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-419"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-420"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-421"></a>
<a name="ln-422"></a>                  <span class="c">! getting conservative variable</span>
<a name="ln-423"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-424"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span> <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">:)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-425"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span>
<a name="ln-426"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-427"></a>                      <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.0</span><span class="c">!u1(6)</span>
<a name="ln-428"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span><span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-429"></a>                      <span class="n">KE</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-430"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-431"></a>                      <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-432"></a>                  <span class="k">end select</span>
<a name="ln-433"></a><span class="k">                  </span><span class="n">u1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">KE</span>
<a name="ln-434"></a>
<a name="ln-435"></a>                 <span class="c">! get R</span>
<a name="ln-436"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> 
<a name="ln-437"></a>                  <span class="c">! point implicit destruction term</span>
<a name="ln-438"></a>                  <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-439"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-440"></a>                      <span class="c">!do nothing</span>
<a name="ln-441"></a>                      <span class="k">continue</span>
<a name="ln-442"></a><span class="k">                    case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-443"></a>                      <span class="n">beta</span> <span class="o">=</span> <span class="n">beta1</span><span class="o">*</span><span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">beta2</span>
<a name="ln-444"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-445"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-446"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-447"></a>                      <span class="n">eta</span>  <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-448"></a>                      <span class="n">fphi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">cd1</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-449"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">((</span><span class="mf">2.5</span><span class="o">*</span><span class="p">((</span><span class="n">cmu</span><span class="o">**</span><span class="mf">0.75</span><span class="p">)</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="mf">1.5</span><span class="p">)</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mf">1.e-20</span><span class="p">))&amp;</span>
<a name="ln-450"></a>                             <span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-451"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">fphi</span><span class="o">/</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-452"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-453"></a>                      <span class="n">vort</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span>     <span class="p">((</span><span class="n">gradw_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">-</span> <span class="n">gradv_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-454"></a>                                      <span class="o">+</span> <span class="p">(</span><span class="n">gradu_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">-</span> <span class="n">gradw_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-455"></a>                                      <span class="o">+</span> <span class="p">(</span><span class="n">gradv_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">-</span> <span class="n">gradu_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-456"></a>                                       <span class="p">)&amp;</span>
<a name="ln-457"></a>                                 <span class="p">)</span>
<a name="ln-458"></a>                      <span class="n">kd2</span>  <span class="o">=</span> <span class="p">(</span><span class="n">kappa_sa</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-459"></a>                      <span class="n">xi</span>   <span class="o">=</span> <span class="n">U1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">density</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-460"></a>                      <span class="n">fv1</span>  <span class="o">=</span> <span class="n">xi</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">xi</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">cv1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-461"></a>                      <span class="n">fv2</span>  <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">xi</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi</span><span class="o">*</span><span class="n">fv1</span><span class="p">)</span>
<a name="ln-462"></a>                      <span class="n">scap</span> <span class="o">=</span> <span class="n">vort</span> <span class="o">+</span> <span class="n">U1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">fv2</span><span class="o">/</span><span class="p">(</span><span class="n">kd2</span><span class="p">)</span>
<a name="ln-463"></a>                      <span class="n">rsa</span>    <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">U1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Scap</span><span class="o">*</span><span class="n">kd2</span><span class="p">),</span> <span class="mi">1</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-464"></a>                      <span class="n">g</span>    <span class="o">=</span> <span class="n">rsa</span> <span class="o">+</span> <span class="n">cw2</span><span class="o">*</span><span class="p">(</span><span class="n">rsa</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="n">rsa</span><span class="p">)</span>
<a name="ln-465"></a>                      <span class="n">fw</span>   <span class="o">=</span> <span class="n">g</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">cw3</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">g</span><span class="o">**</span><span class="mi">6</span><span class="o">+</span><span class="n">cw3</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">6.0</span><span class="p">)</span>
<a name="ln-466"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cb1</span><span class="o">*</span><span class="n">scap</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cw1</span><span class="o">*</span><span class="n">fw</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-467"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-468"></a>                      <span class="n">Fatal_error</span>
<a name="ln-469"></a>                  <span class="k">end select</span>
<a name="ln-470"></a>
<a name="ln-471"></a>                 <span class="c">!check if user want to store residue</span>
<a name="ln-472"></a>                 <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-473"></a><span class="k">                   </span><span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">+</span> <span class="n">SF</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-474"></a>                   <span class="k">if</span><span class="p">(</span><span class="n">TU</span><span class="p">)</span> <span class="n">R</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,:)</span>
<a name="ln-475"></a>                 <span class="k">end if</span>
<a name="ln-476"></a>
<a name="ln-477"></a>                 <span class="c">!update</span>
<a name="ln-478"></a>                 <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">-</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">volume</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-479"></a>
<a name="ln-480"></a>                <span class="c">! getting primitve variable back variable</span>
<a name="ln-481"></a>                  <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-482"></a>                  <span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span><span class="o">/</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-483"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span>
<a name="ln-484"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-485"></a>                      <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.0</span><span class="c">!u2(6)</span>
<a name="ln-486"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-487"></a>                      <span class="c">!u2(6) = u2(6)*u2(1)</span>
<a name="ln-488"></a>                      <span class="n">KE</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-489"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-490"></a>                      <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-491"></a>                  <span class="k">end select</span>
<a name="ln-492"></a><span class="k">                  </span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">KE</span><span class="p">)</span>
<a name="ln-493"></a>
<a name="ln-494"></a>                  <span class="c">!check solution for non pyhysical results</span>
<a name="ln-495"></a>                  <span class="k">if</span><span class="p">((</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">u2</span><span class="p">)))</span><span class="k">then</span>
<a name="ln-496"></a><span class="k">                    print</span><span class="o">*</span><span class="p">,</span> <span class="n">u2</span><span class="p">(:)</span>
<a name="ln-497"></a>                    <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;R: &quot;</span><span class="p">,</span> <span class="n">R</span>
<a name="ln-498"></a>                    <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;old &quot;</span><span class="p">,</span> <span class="n">U1</span>
<a name="ln-499"></a>                    <span class="n">Fatal_error</span>
<a name="ln-500"></a>                  <span class="k">else</span> <span class="c">!update</span>
<a name="ln-501"></a>                    <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-502"></a>                    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-503"></a>                     <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-504"></a>                       <span class="k">if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">&gt;=</span><span class="mf">0.</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-505"></a><span class="k">                         </span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-506"></a>                       <span class="k">else</span>
<a name="ln-507"></a>                       <span class="c">!  qp(i,j,k,6) = tk_inf</span>
<a name="ln-508"></a>                       <span class="c">!  qp(i,j,k,6) = (max(qp(i-1,j,k,6),0.) + max(qp(i+1,j,k,6),0.) &amp;</span>
<a name="ln-509"></a>                       <span class="c">!                +max(qp(i,j-1,k,6),0.) + max(qp(i,j+1,k,6),0.) &amp;</span>
<a name="ln-510"></a>                       <span class="c">!                )/4</span>
<a name="ln-511"></a>                       <span class="c">!  qp(i,j,k,6) = 1.e-3*maxval(qp(i-1:i+1,j-1:j+1,k-1:k+1,6))</span>
<a name="ln-512"></a>                       <span class="k">end if</span>
<a name="ln-513"></a><span class="k">                       if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">&gt;=</span><span class="mf">0.</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-514"></a><span class="k">                        </span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-515"></a>                       <span class="k">else</span>
<a name="ln-516"></a>                       <span class="c">!  qp(i,j,k,7) = tkl_inf</span>
<a name="ln-517"></a>                       <span class="c">!  qp(i,j,k,7) = (max(qp(i-1,j,k,7),0.) + max(qp(i+1,j,k,7),0.) &amp;</span>
<a name="ln-518"></a>                       <span class="c">!                +max(qp(i,j-1,k,7),0.) + max(qp(i,j+1,k,7),0.) &amp;</span>
<a name="ln-519"></a>                       <span class="c">!                )/4</span>
<a name="ln-520"></a>                       <span class="k">end if</span>
<a name="ln-521"></a><span class="k">                     case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-522"></a>                       <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mf">1.e-12</span><span class="p">)</span>
<a name="ln-523"></a>                     <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-524"></a>                       <span class="c">! do nothing</span>
<a name="ln-525"></a>                       <span class="k">continue</span>
<a name="ln-526"></a><span class="k">                    end select</span>
<a name="ln-527"></a><span class="k">                  end if</span>
<a name="ln-528"></a>                  <span class="c">!print*, i,j, R(1:n_var)</span>
<a name="ln-529"></a>
<a name="ln-530"></a>                <span class="k">end do</span>
<a name="ln-531"></a><span class="k">              end do</span>
<a name="ln-532"></a><span class="k">            end do</span>
<a name="ln-533"></a>
<a name="ln-534"></a><span class="k">          case </span><span class="n">DEFAULT</span>
<a name="ln-535"></a>            <span class="n">Fatal_error</span>
<a name="ln-536"></a>        <span class="k">end select</span>
<a name="ln-537"></a>
<a name="ln-538"></a><span class="k">      end subroutine </span><span class="n">update_with</span>
<a name="ln-539"></a>
<a name="ln-540"></a>
<a name="ln-541"></a>      <span class="k">subroutine </span><span class="n">get_total_conservative_Residue</span><span class="p">()</span>
<a name="ln-542"></a>        <span class="c">!&lt; Main loop of whole code. Find residual</span>
<a name="ln-543"></a>        <span class="c">!&lt; </span>
<a name="ln-544"></a>        <span class="c">!&lt; For each iteration it apply boundary conditions,</span>
<a name="ln-545"></a>        <span class="c">!&lt; use higher order method to reconstruct state at</span>
<a name="ln-546"></a>        <span class="c">!&lt; face, evalute fluxes at each face, calculate </span>
<a name="ln-547"></a>        <span class="c">!&lt; inviscid residual, and introuduce additional </span>
<a name="ln-548"></a>        <span class="c">!&lt; residual due to  viscosity, turbulence and source</span>
<a name="ln-549"></a>        <span class="c">!&lt; terms.</span>
<a name="ln-550"></a>        <span class="k">implicit none</span>
<a name="ln-551"></a>
<a name="ln-552"></a><span class="c">!        call send_recv(3) ! parallel call-argument:no of layers </span>
<a name="ln-553"></a>        <span class="k">call </span><span class="n">apply_interface</span><span class="p">()</span>
<a name="ln-554"></a>        <span class="k">call </span><span class="n">populate_ghost_primitive</span><span class="p">()</span>
<a name="ln-555"></a>        <span class="k">call </span><span class="n">compute_face_interpolant</span><span class="p">()</span>
<a name="ln-556"></a>        <span class="k">call </span><span class="n">reconstruct_boundary_state</span><span class="p">(</span><span class="n">interpolant</span><span class="p">)</span>
<a name="ln-557"></a>        <span class="k">call </span><span class="n">compute_fluxes</span><span class="p">()</span>
<a name="ln-558"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">mu_ref</span> <span class="o">/=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-559"></a><span class="k">          call </span><span class="n">evaluate_all_gradients</span><span class="p">()</span>
<a name="ln-560"></a>          <span class="k">call </span><span class="n">calculate_viscosity</span><span class="p">()</span>
<a name="ln-561"></a>          <span class="k">call </span><span class="n">compute_viscous_fluxes</span><span class="p">(</span><span class="n">F_p</span><span class="p">,</span> <span class="n">G_p</span><span class="p">,</span> <span class="n">H_p</span><span class="p">)</span>
<a name="ln-562"></a><span class="c">!          call compute_turbulent_fluxes(F_p, G_p, H_p)</span>
<a name="ln-563"></a>        <span class="k">end if</span>
<a name="ln-564"></a><span class="k">        call </span><span class="n">compute_residue</span><span class="p">()</span>
<a name="ln-565"></a>        <span class="k">call </span><span class="n">add_source_term_residue</span><span class="p">()</span>
<a name="ln-566"></a>
<a name="ln-567"></a>      <span class="k">end subroutine </span><span class="n">get_total_conservative_Residue</span>
<a name="ln-568"></a>
<a name="ln-569"></a>
<a name="ln-570"></a>      <span class="k">subroutine </span><span class="n">update_laminar_variables_primitive</span><span class="p">(</span><span class="n">time_factor</span><span class="p">,</span> <span class="n">store_factor</span><span class="p">,</span> <span class="k">use</span><span class="p">,</span> <span class="n">tostore</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="n">un</span><span class="p">)</span>
<a name="ln-571"></a>        <span class="c">!&lt; Update first five primitive variables in time</span>
<a name="ln-572"></a>        <span class="k">implicit none</span>
<a name="ln-573"></a><span class="k">        </span><span class="kt">real</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">time_factor</span>
<a name="ln-574"></a>        <span class="kt">real</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">store_factor</span>
<a name="ln-575"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">use</span>
<a name="ln-576"></a><span class="k">        </span><span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">tostore</span>
<a name="ln-577"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">un</span>
<a name="ln-578"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span> <span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">Rn</span>
<a name="ln-579"></a>
<a name="ln-580"></a>        <span class="c">!local variables</span>
<a name="ln-581"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">TF</span>       <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!time factor</span>
<a name="ln-582"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">SF</span>       <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!store factor</span>
<a name="ln-583"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">SFU</span>      <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!store factor to use inside ijk loop</span>
<a name="ln-584"></a>        <span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">R_switch</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">!R_store use switch based on TU</span>
<a name="ln-585"></a>        <span class="kt">Logical</span>                           <span class="kd">::</span> <span class="n">TU</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to use R_store or not</span>
<a name="ln-586"></a>        <span class="kt">Logical</span>                           <span class="kd">::</span> <span class="n">TS</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to store R_store or not</span>
<a name="ln-587"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Quse</span>
<a name="ln-588"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Rstore</span>
<a name="ln-589"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">Res</span>
<a name="ln-590"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">t1</span> <span class="c">!temp variable 1/density</span>
<a name="ln-591"></a>        <span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-592"></a>
<a name="ln-593"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">time_factor</span><span class="p">))</span> <span class="n">TF</span><span class="o">=</span><span class="n">time_factor</span>
<a name="ln-594"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">store_factor</span><span class="p">))</span> <span class="n">SF</span><span class="o">=</span><span class="n">store_factor</span>
<a name="ln-595"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">use</span><span class="p">))</span> <span class="n">TU</span><span class="o">=</span><span class="k">use</span>
<a name="ln-596"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">tostore</span><span class="p">))</span> <span class="n">TS</span><span class="o">=</span><span class="n">tostore</span>
<a name="ln-597"></a>        <span class="k">if</span><span class="p">(</span><span class="n">TU</span><span class="p">)</span><span class="k">then</span>
<a name="ln-598"></a><span class="k">          </span><span class="n">R_switch</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-599"></a>          <span class="n">SFU</span><span class="o">=</span><span class="n">SF</span>
<a name="ln-600"></a>        <span class="k">else</span>
<a name="ln-601"></a><span class="k">          </span><span class="n">R_switch</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-602"></a>          <span class="n">SFU</span><span class="o">=</span><span class="mf">1.0</span>
<a name="ln-603"></a>        <span class="k">end if</span>
<a name="ln-604"></a>
<a name="ln-605"></a>        <span class="c">!check if user want to update from particular solution</span>
<a name="ln-606"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">un</span><span class="p">))</span><span class="k">then</span>
<a name="ln-607"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">un</span><span class="p">(:,:,:,:)</span>
<a name="ln-608"></a>        <span class="k">else</span>
<a name="ln-609"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">qp</span><span class="p">(:,:,:,:)</span>
<a name="ln-610"></a>        <span class="k">end if</span>
<a name="ln-611"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span><span class="k">then</span>
<a name="ln-612"></a><span class="k">          </span><span class="n">Rstore</span><span class="o">=&gt;</span><span class="n">Rn</span>
<a name="ln-613"></a>        <span class="k">else</span>
<a name="ln-614"></a><span class="k">          </span><span class="n">Rstore</span><span class="o">=&gt;</span><span class="n">aux</span><span class="c">!making it point to junk values </span>
<a name="ln-615"></a>          <span class="n">R_switch</span><span class="o">=</span><span class="mi">0</span> <span class="c">!but never used as switch is zero</span>
<a name="ln-616"></a>        <span class="k">end if</span>
<a name="ln-617"></a>
<a name="ln-618"></a>
<a name="ln-619"></a>        <span class="c">!--- Start update---!</span>
<a name="ln-620"></a>        <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-621"></a>          <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-622"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-623"></a>        
<a name="ln-624"></a>              <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-625"></a>              <span class="n">t1</span>      <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-626"></a>              <span class="n">Res</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span> <span class="n">Residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-627"></a>        
<a name="ln-628"></a>              <span class="c">! finding primitive residue</span>
<a name="ln-629"></a>              <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Res</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-630"></a>              <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Res</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">Res</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">t1</span>
<a name="ln-631"></a>              <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Res</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">Res</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">t1</span>
<a name="ln-632"></a>              <span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Res</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">Res</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">*</span><span class="n">t1</span>
<a name="ln-633"></a>              <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">u1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">u1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">*</span><span class="n">Res</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-634"></a>                     <span class="o">-</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Res</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-635"></a>                     <span class="o">-</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Res</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-636"></a>                     <span class="o">-</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Res</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-637"></a>                     <span class="o">+</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">Res</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-638"></a>        
<a name="ln-639"></a>                    
<a name="ln-640"></a>             <span class="c">!store residue</span>
<a name="ln-641"></a>              <span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-642"></a>             
<a name="ln-643"></a>        
<a name="ln-644"></a>             <span class="c">!update</span>
<a name="ln-645"></a>             <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">SFU</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">R_switch</span><span class="o">*</span><span class="n">Rstore</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">))&amp;</span>
<a name="ln-646"></a>                                <span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">volume</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-647"></a>        
<a name="ln-648"></a>             <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-649"></a>            <span class="k">end do</span>
<a name="ln-650"></a><span class="k">          end do</span>
<a name="ln-651"></a><span class="k">        end do</span>
<a name="ln-652"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-653"></a><span class="k">          </span><span class="n">Rn</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-654"></a>                                      <span class="o">+</span> <span class="n">SF</span><span class="o">*</span><span class="n">aux</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-655"></a>        <span class="k">end if</span>
<a name="ln-656"></a><span class="k">        </span>
<a name="ln-657"></a><span class="k">        if</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">qp</span><span class="p">(:,:,:,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">any</span><span class="p">(</span><span class="n">qp</span><span class="p">(:,:,:,</span><span class="mi">5</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span><span class="k">then</span>
<a name="ln-658"></a><span class="k">          </span><span class="n">Fatal_error</span>
<a name="ln-659"></a>        <span class="k">end if</span>
<a name="ln-660"></a><span class="k">        nullify</span><span class="p">(</span><span class="n">Rstore</span><span class="p">)</span>
<a name="ln-661"></a>        <span class="k">nullify</span><span class="p">(</span><span class="n">Quse</span><span class="p">)</span>
<a name="ln-662"></a>
<a name="ln-663"></a>      <span class="k">end subroutine </span><span class="n">update_laminar_variables_primitive</span>
<a name="ln-664"></a>
<a name="ln-665"></a>      <span class="k">subroutine </span><span class="n">update_laminar_variables_conservative</span><span class="p">(</span><span class="n">time_factor</span><span class="p">,</span> <span class="n">store_factor</span><span class="p">,</span> <span class="k">use</span><span class="p">,</span> <span class="n">tostore</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="n">un</span><span class="p">)</span>
<a name="ln-666"></a>        <span class="c">!&lt; Update first five conservative variables in time</span>
<a name="ln-667"></a>        <span class="k">implicit none</span>
<a name="ln-668"></a><span class="k">        </span><span class="kt">real</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">time_factor</span>
<a name="ln-669"></a>        <span class="kt">real</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">store_factor</span>
<a name="ln-670"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">use</span>
<a name="ln-671"></a><span class="k">        </span><span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">tostore</span>
<a name="ln-672"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">un</span>
<a name="ln-673"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span> <span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">Rn</span>
<a name="ln-674"></a>
<a name="ln-675"></a>        <span class="c">!local variables</span>
<a name="ln-676"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">TF</span>       <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!time factor</span>
<a name="ln-677"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">SF</span>       <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!store factor</span>
<a name="ln-678"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">SFU</span>      <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!store factor to use inside ijk loop</span>
<a name="ln-679"></a>        <span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">R_switch</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">!R_store use switch based on TU</span>
<a name="ln-680"></a>        <span class="kt">Logical</span>                           <span class="kd">::</span> <span class="n">TU</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to use R_store or not</span>
<a name="ln-681"></a>        <span class="kt">Logical</span>                           <span class="kd">::</span> <span class="n">TS</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to store R_store or not</span>
<a name="ln-682"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Quse</span>
<a name="ln-683"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Rstore</span>
<a name="ln-684"></a>        <span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-685"></a>
<a name="ln-686"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">time_factor</span><span class="p">))</span> <span class="n">TF</span><span class="o">=</span><span class="n">time_factor</span>
<a name="ln-687"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">store_factor</span><span class="p">))</span> <span class="n">SF</span><span class="o">=</span><span class="n">store_factor</span>
<a name="ln-688"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">use</span><span class="p">))</span> <span class="n">TU</span><span class="o">=</span><span class="k">use</span>
<a name="ln-689"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">tostore</span><span class="p">))</span> <span class="n">TS</span><span class="o">=</span><span class="n">tostore</span>
<a name="ln-690"></a>        <span class="k">if</span><span class="p">(</span><span class="n">TU</span><span class="p">)</span><span class="k">then</span>
<a name="ln-691"></a><span class="k">          </span><span class="n">R_switch</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-692"></a>          <span class="n">SFU</span><span class="o">=</span><span class="n">SF</span>
<a name="ln-693"></a>        <span class="k">else</span>
<a name="ln-694"></a><span class="k">          </span><span class="n">R_switch</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-695"></a>          <span class="n">SFU</span><span class="o">=</span><span class="mf">1.0</span>
<a name="ln-696"></a>        <span class="k">end if</span>
<a name="ln-697"></a>
<a name="ln-698"></a>        <span class="c">!check if user want to update from particular solution</span>
<a name="ln-699"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">un</span><span class="p">))</span><span class="k">then</span>
<a name="ln-700"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">un</span><span class="p">(:,:,:,:)</span>
<a name="ln-701"></a>        <span class="k">else</span>
<a name="ln-702"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">qp</span><span class="p">(:,:,:,:)</span>
<a name="ln-703"></a>        <span class="k">end if</span>
<a name="ln-704"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span><span class="k">then</span>
<a name="ln-705"></a><span class="k">          </span><span class="n">Rstore</span><span class="o">=&gt;</span><span class="n">Rn</span>
<a name="ln-706"></a>        <span class="k">else</span>
<a name="ln-707"></a><span class="k">          </span><span class="n">Rstore</span><span class="o">=&gt;</span><span class="n">aux</span><span class="c">!making it point to junk values </span>
<a name="ln-708"></a>          <span class="n">R_switch</span><span class="o">=</span><span class="mi">0</span> <span class="c">!but never used as switch is zero</span>
<a name="ln-709"></a>        <span class="k">end if</span>
<a name="ln-710"></a>
<a name="ln-711"></a>
<a name="ln-712"></a>        <span class="c">!--- Start update---!</span>
<a name="ln-713"></a>
<a name="ln-714"></a>        <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-715"></a>          <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-716"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-717"></a>
<a name="ln-718"></a>              <span class="c">! getting conservative variable</span>
<a name="ln-719"></a>              <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-720"></a>              <span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span> <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">:)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-721"></a>              <span class="n">u1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-722"></a>
<a name="ln-723"></a>             <span class="c">! get R</span>
<a name="ln-724"></a>              <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>                                                              
<a name="ln-725"></a>
<a name="ln-726"></a>             <span class="c">!store conservative variables</span>
<a name="ln-727"></a>             <span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-728"></a>
<a name="ln-729"></a>             <span class="c">!update</span>
<a name="ln-730"></a>             <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">SFU</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">R_switch</span><span class="o">*</span><span class="n">Rstore</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">))&amp;</span>
<a name="ln-731"></a>                                <span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">volume</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-732"></a>        
<a name="ln-733"></a>
<a name="ln-734"></a>              <span class="c">! getting primitve variable back variable</span>
<a name="ln-735"></a>              <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-736"></a>              <span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span><span class="o">/</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-737"></a>              <span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-738"></a>
<a name="ln-739"></a>              <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-740"></a>
<a name="ln-741"></a>            <span class="k">end do</span>
<a name="ln-742"></a><span class="k">          end do</span>
<a name="ln-743"></a><span class="k">        end do</span>
<a name="ln-744"></a>
<a name="ln-745"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-746"></a><span class="k">          </span><span class="n">Rn</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-747"></a>                                      <span class="o">+</span> <span class="n">SF</span><span class="o">*</span><span class="n">aux</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-748"></a>        <span class="k">end if</span>
<a name="ln-749"></a><span class="k">        </span>
<a name="ln-750"></a><span class="k">        if</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">qp</span><span class="p">(:,:,:,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">any</span><span class="p">(</span><span class="n">qp</span><span class="p">(:,:,:,</span><span class="mi">5</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span><span class="k">then</span>
<a name="ln-751"></a><span class="k">          </span><span class="n">Fatal_error</span>
<a name="ln-752"></a>        <span class="k">end if</span>
<a name="ln-753"></a><span class="k">        nullify</span><span class="p">(</span><span class="n">Rstore</span><span class="p">)</span>
<a name="ln-754"></a>        <span class="k">nullify</span><span class="p">(</span><span class="n">Quse</span><span class="p">)</span>
<a name="ln-755"></a>
<a name="ln-756"></a>      <span class="k">end subroutine </span><span class="n">update_laminar_variables_conservative</span>
<a name="ln-757"></a>
<a name="ln-758"></a>
<a name="ln-759"></a>      <span class="k">subroutine </span><span class="n">update_turbulent_variables_primitive</span><span class="p">(</span><span class="n">time_factor</span><span class="p">,</span> <span class="n">store_factor</span><span class="p">,</span> <span class="k">use</span><span class="p">,</span> <span class="n">tostore</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="n">un</span><span class="p">)</span>
<a name="ln-760"></a>        <span class="c">!&lt; Update primitive turbulence variables in time</span>
<a name="ln-761"></a>        <span class="k">implicit none</span>
<a name="ln-762"></a>        <span class="c">!arguments</span>
<a name="ln-763"></a>        <span class="kt">real</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">time_factor</span> <span class="c">! time factor</span>
<a name="ln-764"></a>        <span class="kt">real</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">store_factor</span>
<a name="ln-765"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">use</span>
<a name="ln-766"></a><span class="k">        </span><span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">tostore</span>
<a name="ln-767"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">un</span>
<a name="ln-768"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span> <span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">Rn</span>
<a name="ln-769"></a>
<a name="ln-770"></a>        <span class="c">!local variables</span>
<a name="ln-771"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">TF</span>       <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!time factor</span>
<a name="ln-772"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">SF</span>       <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!store factor</span>
<a name="ln-773"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">SFU</span>      <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!store factor to use in ijk loop</span>
<a name="ln-774"></a>        <span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">R_switch</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">!R_store use switch based on TU</span>
<a name="ln-775"></a>        <span class="kt">Logical</span>                           <span class="kd">::</span> <span class="n">TU</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to use R_store or not</span>
<a name="ln-776"></a>        <span class="kt">Logical</span>                           <span class="kd">::</span> <span class="n">TS</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to store R_store or not</span>
<a name="ln-777"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Quse</span>
<a name="ln-778"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Rstore</span>
<a name="ln-779"></a>        <span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-780"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">beta</span>
<a name="ln-781"></a>
<a name="ln-782"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">time_factor</span><span class="p">))</span> <span class="n">TF</span><span class="o">=</span><span class="n">time_factor</span>
<a name="ln-783"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">store_factor</span><span class="p">))</span> <span class="n">SF</span><span class="o">=</span><span class="n">store_factor</span>
<a name="ln-784"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">use</span><span class="p">))</span> <span class="n">TU</span><span class="o">=</span><span class="k">use</span>
<a name="ln-785"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">tostore</span><span class="p">))</span> <span class="n">TS</span><span class="o">=</span><span class="n">tostore</span>
<a name="ln-786"></a>        <span class="k">if</span><span class="p">(</span><span class="n">TU</span><span class="p">)</span><span class="k">then</span>
<a name="ln-787"></a><span class="k">          </span><span class="n">R_switch</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-788"></a>          <span class="n">SFU</span><span class="o">=</span><span class="n">SF</span>
<a name="ln-789"></a>        <span class="k">else</span>
<a name="ln-790"></a><span class="k">          </span><span class="n">R_switch</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-791"></a>          <span class="n">SFU</span><span class="o">=</span><span class="mf">1.0</span>
<a name="ln-792"></a>        <span class="k">end if</span>
<a name="ln-793"></a>
<a name="ln-794"></a>        <span class="c">!check if user want to update from particular solution</span>
<a name="ln-795"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">un</span><span class="p">))</span><span class="k">then</span>
<a name="ln-796"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">un</span><span class="p">(:,:,:,:)</span>
<a name="ln-797"></a>        <span class="k">else</span>
<a name="ln-798"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">qp</span><span class="p">(:,:,:,:)</span>
<a name="ln-799"></a>        <span class="k">end if</span>
<a name="ln-800"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span><span class="k">then</span>
<a name="ln-801"></a><span class="k">          </span><span class="n">Rstore</span><span class="o">=&gt;</span><span class="n">Rn</span>
<a name="ln-802"></a>        <span class="k">else</span>
<a name="ln-803"></a><span class="k">          </span><span class="n">Rstore</span><span class="o">=&gt;</span><span class="n">aux</span><span class="c">!making it point to junk values </span>
<a name="ln-804"></a>          <span class="n">R_switch</span><span class="o">=</span><span class="mi">0</span> <span class="c">!but never used as switch is zero</span>
<a name="ln-805"></a>        <span class="k">end if</span>
<a name="ln-806"></a>
<a name="ln-807"></a>
<a name="ln-808"></a>        <span class="c">!--- Start update---!</span>
<a name="ln-809"></a>
<a name="ln-810"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span>
<a name="ln-811"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-812"></a>            <span class="c">!do nothing</span>
<a name="ln-813"></a>            <span class="k">continue</span>
<a name="ln-814"></a><span class="k">          </span>
<a name="ln-815"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-816"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-817"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-818"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-819"></a>                  <span class="c">!update primitive variable</span>
<a name="ln-820"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-821"></a>                  <span class="n">beta</span> <span class="o">=</span> <span class="n">beta1</span><span class="o">*</span><span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">beta2</span>
<a name="ln-822"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-823"></a>                         <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">bstar</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">TKE_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-824"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-825"></a>                         <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">omega_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-826"></a>                  <span class="c">!store residue</span>
<a name="ln-827"></a>                  <span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-828"></a>                  <span class="c">!update</span>
<a name="ln-829"></a>                  <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">SFU</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">+</span><span class="n">R_switch</span><span class="o">*</span><span class="n">Rstore</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">))&amp;</span>
<a name="ln-830"></a>                                              <span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">volume</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-831"></a>                <span class="k">end do</span>
<a name="ln-832"></a><span class="k">              end do</span>
<a name="ln-833"></a><span class="k">            end do</span>
<a name="ln-834"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-835"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-836"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-837"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-838"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-839"></a>                  <span class="n">eta</span>  <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-840"></a>                  <span class="n">fphi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">cd1</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-841"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-842"></a>                         <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">((</span><span class="mf">2.5</span><span class="o">*</span><span class="p">((</span><span class="n">cmu</span><span class="o">**</span><span class="mf">0.75</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="mf">1.5</span><span class="p">)</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mf">1.e-20</span><span class="p">))&amp;</span>
<a name="ln-843"></a>                         <span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))))</span><span class="o">*</span><span class="n">TKE_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-844"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-845"></a>                         <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">fphi</span><span class="o">/</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">kl_residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-846"></a>                  <span class="c">!store residue</span>
<a name="ln-847"></a>                  <span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-848"></a>                  <span class="c">!update</span>
<a name="ln-849"></a>                  <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">SFU</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">+</span><span class="n">R_switch</span><span class="o">*</span><span class="n">Rstore</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">))&amp;</span>
<a name="ln-850"></a>                                              <span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">volume</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-851"></a>                  <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="err">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">))</span>
<a name="ln-852"></a>                <span class="k">end do</span>
<a name="ln-853"></a><span class="k">              end do</span>
<a name="ln-854"></a><span class="k">            end do</span>
<a name="ln-855"></a><span class="k">          case </span><span class="n">DEFAULT</span>
<a name="ln-856"></a>            <span class="n">Fatal_error</span>
<a name="ln-857"></a>        <span class="k">end select</span>
<a name="ln-858"></a>
<a name="ln-859"></a>        <span class="c">!--- end update ---!</span>
<a name="ln-860"></a>        
<a name="ln-861"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-862"></a><span class="k">          </span><span class="n">Rn</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-863"></a>                                          <span class="o">+</span> <span class="n">SF</span><span class="o">*</span><span class="n">aux</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-864"></a>        <span class="k">end if</span>
<a name="ln-865"></a>        
<a name="ln-866"></a>        <span class="c">!if(any(qp(:,:,:,6)&lt;0.) .and. any(qp(:,:,:,n_var)&lt;0))then</span>
<a name="ln-867"></a>        <span class="c">!  Fatal_error</span>
<a name="ln-868"></a>        <span class="c">!end if</span>
<a name="ln-869"></a>        <span class="k">nullify</span><span class="p">(</span><span class="n">Rstore</span><span class="p">)</span>
<a name="ln-870"></a>
<a name="ln-871"></a>      <span class="k">end subroutine </span><span class="n">update_turbulent_variables_primitive</span>
<a name="ln-872"></a>
<a name="ln-873"></a>      <span class="k">subroutine </span><span class="n">update_turbulent_variables_conservative</span><span class="p">(</span><span class="n">time_factor</span><span class="p">,</span> <span class="n">store_factor</span><span class="p">,</span> <span class="k">use</span><span class="p">,</span> <span class="n">tostore</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="n">un</span><span class="p">)</span>
<a name="ln-874"></a>        <span class="c">!&lt; Update conservative turbulence variables in time</span>
<a name="ln-875"></a>        <span class="k">implicit none</span>
<a name="ln-876"></a>        <span class="c">!arguments</span>
<a name="ln-877"></a>        <span class="kt">real</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">time_factor</span>
<a name="ln-878"></a>        <span class="kt">real</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">store_factor</span>
<a name="ln-879"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">use</span>
<a name="ln-880"></a><span class="k">        </span><span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">tostore</span>
<a name="ln-881"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">un</span>
<a name="ln-882"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span> <span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">Rn</span>
<a name="ln-883"></a>
<a name="ln-884"></a>        <span class="c">!local variables</span>
<a name="ln-885"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">TF</span>       <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!time factor</span>
<a name="ln-886"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">SF</span>       <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!store factor</span>
<a name="ln-887"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">SFU</span>      <span class="o">=</span> <span class="mf">1.0</span>     <span class="c">!store factor to use inside ijk loop</span>
<a name="ln-888"></a>        <span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">R_switch</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">!R_store use switch based on TU</span>
<a name="ln-889"></a>        <span class="kt">Logical</span>                           <span class="kd">::</span> <span class="n">TU</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to use R_store or not</span>
<a name="ln-890"></a>        <span class="kt">Logical</span>                           <span class="kd">::</span> <span class="n">TS</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to store R_store or not</span>
<a name="ln-891"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Quse</span>
<a name="ln-892"></a>        <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Rstore</span>
<a name="ln-893"></a>        <span class="kt">real</span>                              <span class="kd">::</span> <span class="n">beta</span>
<a name="ln-894"></a>        <span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-895"></a>
<a name="ln-896"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">time_factor</span><span class="p">))</span> <span class="n">TF</span><span class="o">=</span><span class="n">time_factor</span>
<a name="ln-897"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">store_factor</span><span class="p">))</span> <span class="n">SF</span><span class="o">=</span><span class="n">store_factor</span>
<a name="ln-898"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">use</span><span class="p">))</span> <span class="n">TU</span><span class="o">=</span><span class="k">use</span>
<a name="ln-899"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">tostore</span><span class="p">))</span> <span class="n">TS</span><span class="o">=</span><span class="n">tostore</span>
<a name="ln-900"></a>        <span class="k">if</span><span class="p">(</span><span class="n">TU</span><span class="p">)</span><span class="k">then</span>
<a name="ln-901"></a><span class="k">          </span><span class="n">R_switch</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-902"></a>          <span class="n">SFU</span><span class="o">=</span><span class="n">SF</span>
<a name="ln-903"></a>        <span class="k">else</span>
<a name="ln-904"></a><span class="k">          </span><span class="n">R_switch</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-905"></a>          <span class="n">SFU</span><span class="o">=</span><span class="mf">1.0</span>
<a name="ln-906"></a>        <span class="k">end if</span>
<a name="ln-907"></a>
<a name="ln-908"></a>        <span class="c">!check if user want to update from particular solution</span>
<a name="ln-909"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">un</span><span class="p">))</span><span class="k">then</span>
<a name="ln-910"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">un</span><span class="p">(:,:,:,:)</span>
<a name="ln-911"></a>        <span class="k">else</span>
<a name="ln-912"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">qp</span><span class="p">(:,:,:,:)</span>
<a name="ln-913"></a>        <span class="k">end if</span>
<a name="ln-914"></a><span class="k">        if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span><span class="k">then</span>
<a name="ln-915"></a><span class="k">          </span><span class="n">Rstore</span><span class="o">=&gt;</span><span class="n">Rn</span>
<a name="ln-916"></a>        <span class="k">else</span>
<a name="ln-917"></a><span class="k">          </span><span class="n">Rstore</span><span class="o">=&gt;</span><span class="n">aux</span><span class="c">!making it point to junk values </span>
<a name="ln-918"></a>          <span class="n">R_switch</span><span class="o">=</span><span class="mi">0</span> <span class="c">!but never used as switch is zero</span>
<a name="ln-919"></a>        <span class="k">end if</span>
<a name="ln-920"></a>
<a name="ln-921"></a>
<a name="ln-922"></a>        <span class="c">!--- Start update---!</span>
<a name="ln-923"></a>
<a name="ln-924"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">turbulence</span><span class="p">)</span>
<a name="ln-925"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-926"></a>            <span class="c">!do nothing</span>
<a name="ln-927"></a>            <span class="k">continue</span>
<a name="ln-928"></a><span class="k">          </span>
<a name="ln-929"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-930"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-931"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-932"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-933"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-934"></a>                  <span class="c">!get R</span>
<a name="ln-935"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> 
<a name="ln-936"></a>                  <span class="c">!point implicit</span>
<a name="ln-937"></a>                  <span class="n">beta</span> <span class="o">=</span> <span class="n">beta1</span><span class="o">*</span><span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">beta2</span>
<a name="ln-938"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-939"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-940"></a>                  <span class="c">!update</span>
<a name="ln-941"></a>                  <span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">SFU</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)&amp;</span>
<a name="ln-942"></a>                                              <span class="o">+</span><span class="n">R_switch</span><span class="o">*</span><span class="n">Rstore</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">))&amp;</span>
<a name="ln-943"></a>                                             <span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">volume</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-944"></a>                  <span class="k">if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-945"></a>                  <span class="k">if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-946"></a>                <span class="k">end do</span>
<a name="ln-947"></a><span class="k">              end do</span>
<a name="ln-948"></a><span class="k">            end do</span>
<a name="ln-949"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-950"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-951"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-952"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-953"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-954"></a>                  <span class="c">!get R</span>
<a name="ln-955"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> 
<a name="ln-956"></a>                  <span class="c">!point implicit</span>
<a name="ln-957"></a>                  <span class="n">eta</span>  <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-958"></a>                  <span class="n">fphi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">cd1</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-959"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">((</span><span class="mf">2.5</span><span class="o">*</span><span class="p">((</span><span class="n">cmu</span><span class="o">**</span><span class="mf">0.75</span><span class="p">)</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="mf">1.5</span><span class="p">)</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mf">1.e-20</span><span class="p">))&amp;</span>
<a name="ln-960"></a>                         <span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-961"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">fphi</span><span class="o">/</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-962"></a>                  <span class="c">!update</span>
<a name="ln-963"></a>                  <span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">R_switch</span><span class="o">*</span><span class="n">SF</span><span class="o">*</span><span class="n">Rstore</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)))&amp;</span>
<a name="ln-964"></a>                                             <span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">volume</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-965"></a>                  <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.e-10</span><span class="p">,</span> <span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">/</span><span class="n">aux</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-966"></a>                <span class="k">end do</span>
<a name="ln-967"></a><span class="k">              end do</span>
<a name="ln-968"></a><span class="k">            end do</span>
<a name="ln-969"></a><span class="k">          case </span><span class="n">DEFAULT</span>
<a name="ln-970"></a>            <span class="n">Fatal_error</span>
<a name="ln-971"></a>        <span class="k">end select</span>
<a name="ln-972"></a>
<a name="ln-973"></a>        <span class="c">!--- end update ---!</span>
<a name="ln-974"></a>        
<a name="ln-975"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-976"></a><span class="k">          </span><span class="n">Rn</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-977"></a>                                          <span class="o">+</span> <span class="n">SF</span><span class="o">*</span><span class="n">residue</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-978"></a>        <span class="k">end if</span>
<a name="ln-979"></a><span class="k">        </span>
<a name="ln-980"></a><span class="k">        if</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">qp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">))</span><span class="k">then</span>
<a name="ln-981"></a><span class="k">          </span><span class="n">Fatal_error</span>
<a name="ln-982"></a>        <span class="k">end if</span>
<a name="ln-983"></a><span class="k">        nullify</span><span class="p">(</span><span class="n">Rstore</span><span class="p">)</span>
<a name="ln-984"></a>
<a name="ln-985"></a>      <span class="k">end subroutine </span><span class="n">update_turbulent_variables_conservative</span>
<a name="ln-986"></a>
<a name="ln-987"></a><span class="k">end module </span><span class="n">update</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2019-09-24T22:49:06.131269 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST-3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>