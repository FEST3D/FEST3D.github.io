<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST-3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>update.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140495700-1"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
   
     gtag('config', 'UA-140495700-1');
   </script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>update.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.5% of total for source files.">387 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/update.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">update.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/update.html">update</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/update.f90.html#src">update.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>Time integration module</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~update.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileupdatef90EfferentGraph" width="641pt" height="1436pt"
 viewBox="0.00 0.00 641.00 1435.99" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~update.f90~~EfferentGraph" class="graph" transform="scale(.849 .849) rotate(0) translate(4 1687.3727)">
<title>sourcefile~~update.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1687.3727 751,-1687.3727 751,4 -4,4"/>
<!-- sourcefile~update.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~update.f90</title>
<polygon fill="none" stroke="#000000" points="747,-819.9131 683,-819.9131 683,-795.9131 747,-795.9131 747,-819.9131"/>
<text text-anchor="middle" x="715" y="-805.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">update.f90</text>
</g>
<!-- sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~global_kkl.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/global_kkl.f90.html" xlink:title="global_kkl.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="314.5,-817.9131 236.5,-817.9131 236.5,-793.9131 314.5,-793.9131 314.5,-817.9131"/>
<text text-anchor="middle" x="275.5" y="-803.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_kkl.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M712.917,-820.0343C703.6624,-872.2842 664.4496,-1077.1885 613,-1111.9131"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-1111.9131C580.876,-1133.5943 576.1514,-1079.9881 543,-1059.9131 467.8449,-1014.4025 420.2767,-1042.2065 365,-973.9131 322.6815,-921.6294 373.275,-877.5507 329,-826.9131 327.2759,-824.9413 325.3429,-823.153 323.262,-821.5314"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.9524,-818.4592 314.6311,-816.0673 321.2081,-824.3736 324.9524,-818.4592"/>
</g>
<!-- sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~face_interpolant.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/face_interpolant.f90.html" xlink:title="face_interpolant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="329,-1434.9131 222,-1434.9131 222,-1410.9131 329,-1410.9131 329,-1434.9131"/>
<text text-anchor="middle" x="275.5" y="-1420.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">face_interpolant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-1461.9131C584.7752,-1483.1689 488.8233,-1467.895 454,-1461.9131"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M454,-1461.9131C414.0222,-1455.0458 369.4445,-1445.3079 334.8376,-1437.2808"/>
<polygon fill="#ff0000" stroke="#ff0000" points="335.4288,-1433.8247 324.8948,-1434.9581 333.8364,-1440.6412 335.4288,-1433.8247"/>
</g>
<!-- sourcefile~wall_dist.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~wall_dist.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/wall_dist.f90.html" xlink:title="wall_dist.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="311,-277.9131 240,-277.9131 240,-253.9131 311,-253.9131 311,-277.9131"/>
<text text-anchor="middle" x="275.5" y="-263.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wall_dist.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-97.9131C588.3337,-71.6163 576.6138,-125.8722 543,-138.9131 505.2915,-153.5426 493.9352,-151.4998 454,-157.9131"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M454,-157.9131C413.5498,-164.4092 397.8766,-157.4682 365,-181.9131 340.6529,-200.016 351.5305,-219.5939 329,-239.9131 325.3573,-243.1983 321.2245,-246.1595 316.9088,-248.8038"/>
<polygon fill="#ff0000" stroke="#ff0000" points="314.9502,-245.8873 307.8921,-253.7889 318.3372,-252.0134 314.9502,-245.8873"/>
</g>
<!-- sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~global_sa.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/global_sa.f90.html" xlink:title="global_sa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="313.5,-859.9131 237.5,-859.9131 237.5,-835.9131 313.5,-835.9131 313.5,-859.9131"/>
<text text-anchor="middle" x="275.5" y="-845.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_sa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-1111.9131C601.1084,-1120.1997 375.9366,-1040.4245 365,-1030.9131 314.7219,-987.1871 289.973,-908.7051 280.4086,-870.307"/>
<polygon fill="#ff0000" stroke="#ff0000" points="283.7205,-869.1038 278.0101,-860.1796 276.909,-870.7171 283.7205,-869.1038"/>
</g>
<!-- sourcefile~scheme.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~scheme.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/scheme.f90.html" xlink:title="scheme.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647,-1513.9131 579,-1513.9131 579,-1489.9131 647,-1489.9131 647,-1513.9131"/>
<text text-anchor="middle" x="613" y="-1499.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scheme.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~scheme.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~scheme.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M714.3472,-819.9944C709.6585,-905.3846 680.3441,-1416.2596 647,-1475.9131 645.5724,-1478.4671 643.7796,-1480.8505 641.7678,-1483.0554"/>
<polygon fill="#ff0000" stroke="#ff0000" points="639.3378,-1480.5344 634.296,-1489.8527 644.0483,-1485.7124 639.3378,-1480.5344"/>
</g>
<!-- sourcefile~gradients.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~gradients.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/gradients.f90.html" xlink:title="gradients.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="313,-437.9131 238,-437.9131 238,-413.9131 313,-413.9131 313,-437.9131"/>
<text text-anchor="middle" x="275.5" y="-423.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">gradients.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-423.9131C577.3216,-380.8836 407.3613,-403.1032 323.0923,-417.2145"/>
<polygon fill="#ff0000" stroke="#ff0000" points="322.281,-413.8022 313.0111,-418.9326 323.457,-420.7027 322.281,-413.8022"/>
</g>
<!-- sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~viscosity.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/viscosity.f90.html" xlink:title="viscosity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="489,-741.9131 419,-741.9131 419,-717.9131 489,-717.9131 489,-741.9131"/>
<text text-anchor="middle" x="454" y="-727.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">viscosity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M682.8554,-797.8968C671.532,-794.3921 658.7096,-790.4502 647,-786.9131 596.3884,-771.625 538.173,-754.4939 499.0284,-743.0408"/>
<polygon fill="#ff0000" stroke="#ff0000" points="499.8374,-739.6308 489.257,-740.1839 497.8729,-746.3496 499.8374,-739.6308"/>
</g>
<!-- sourcefile~time.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~time.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/time.f90.html" xlink:title="time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="640,-1237.9131 586,-1237.9131 586,-1213.9131 640,-1213.9131 640,-1237.9131"/>
<text text-anchor="middle" x="613" y="-1223.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~time.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M712.9138,-820.1681C705.5454,-862.7888 679.4329,-1008.3592 647,-1125.9131 639.4415,-1153.3092 628.5733,-1184.1856 621.1732,-1204.287"/>
<polygon fill="#ff0000" stroke="#ff0000" points="617.8625,-1203.1483 617.6554,-1213.7411 624.4231,-1205.5894 617.8625,-1203.1483"/>
</g>
<!-- sourcefile~boundary_state_reconstruction.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~boundary_state_reconstruction.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/boundary_state_reconstruction.f90.html" xlink:title="boundary_state_reconstruction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="543,-1433.9131 365,-1433.9131 365,-1409.9131 543,-1409.9131 543,-1433.9131"/>
<text text-anchor="middle" x="454" y="-1419.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">boundary_state_reconstruction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~boundary_state_reconstruction.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~boundary_state_reconstruction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M714.1012,-820.1194C707.6259,-906.3444 666.8149,-1421.3857 613,-1461.9131"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-1461.9131C608.5476,-1465.2661 550.0067,-1449.5376 505.2405,-1436.8248"/>
<polygon fill="#ff0000" stroke="#ff0000" points="505.9258,-1433.3807 495.3492,-1434.0017 504.0046,-1440.1119 505.9258,-1433.3807"/>
</g>
<!-- sourcefile~interface1.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~interface1.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/interface1.f90.html" xlink:title="interface1.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="314.5,-1275.9131 236.5,-1275.9131 236.5,-1251.9131 314.5,-1251.9131 314.5,-1275.9131"/>
<text text-anchor="middle" x="275.5" y="-1261.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interface1.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~interface1.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~interface1.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-1111.9131C580.9955,-1133.7703 577.0425,-1145.3893 543,-1163.9131 470.6379,-1203.2879 379.5193,-1233.6772 324.4764,-1250.1575"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.2264,-1246.8774 314.6312,-1253.072 325.2134,-1253.5895 323.2264,-1246.8774"/>
</g>
<!-- sourcefile~plusgs.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~plusgs.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/plusgs.f90.html" xlink:title="plusgs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.5,-819.9131 582.5,-819.9131 582.5,-795.9131 643.5,-795.9131 643.5,-819.9131"/>
<text text-anchor="middle" x="613" y="-805.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">plusgs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~plusgs.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~plusgs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M682.7266,-807.9131C673.5542,-807.9131 663.4433,-807.9131 653.8342,-807.9131"/>
<polygon fill="#ff0000" stroke="#ff0000" points="653.6725,-804.4132 643.6725,-807.9131 653.6725,-811.4132 653.6725,-804.4132"/>
</g>
<!-- sourcefile~viscous.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~viscous.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/viscous.f90.html" xlink:title="viscous.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="646,-711.9131 580,-711.9131 580,-687.9131 646,-687.9131 646,-711.9131"/>
<text text-anchor="middle" x="613" y="-697.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">viscous.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~viscous.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~viscous.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M703.7674,-795.6987C690.3473,-781.1419 667.1747,-756.1213 647,-734.9131 642.2487,-729.9184 637.0826,-724.5625 632.2454,-719.5798"/>
<polygon fill="#ff0000" stroke="#ff0000" points="634.5062,-716.8847 625.0219,-712.1626 629.4914,-721.7685 634.5062,-716.8847"/>
</g>
<!-- sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~utils.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/utils.f90.html" xlink:title="utils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="173.5,-569.9131 119.5,-569.9131 119.5,-545.9131 173.5,-545.9131 173.5,-569.9131"/>
<text text-anchor="middle" x="146.5" y="-555.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-1111.9131C553.8453,-1150.5718 520.8941,-1089.1326 454,-1111.9131"/>
</g>
<!-- sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~vartypes.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/vartypes.f90.html" xlink:title="vartypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-1395.9131 0,-1395.9131 0,-1371.9131 71,-1371.9131 71,-1395.9131"/>
<text text-anchor="middle" x="35.5" y="-1381.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vartypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M714.0858,-795.7283C707.2575,-706.1395 663.1052,-151.3303 613,-97.9131"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-97.9131C580.4486,-63.21 586.2677,-36.7073 543,-16.9131 471.0597,15.9983 443.5864,-7.817 365,-16.9131 324.4129,-21.6109 316.2945,-35.6348 275.5,-37.9131"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275.5,-37.9131C218.2137,-40.236 191.5333,-2.4291 146.5,-37.9131"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M146.5,-37.9131C101.069,-73.7105 117.5493,-105.0436 107,-161.9131 61.9027,-405.0258 39.7141,-1215.836 36.0484,-1361.4257"/>
<polygon fill="#ff0000" stroke="#ff0000" points="32.541,-1361.6819 35.7913,-1371.7658 39.5389,-1361.856 32.541,-1361.6819"/>
</g>
<!-- sourcefile~bc_primitive.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~bc_primitive.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/bc_primitive.f90.html" xlink:title="bc_primitive.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="498,-49.9131 410,-49.9131 410,-25.9131 498,-25.9131 498,-49.9131"/>
<text text-anchor="middle" x="454" y="-35.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bc_primitive.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~bc_primitive.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~bc_primitive.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-97.9131C585.6267,-68.7304 542.6357,-53.6287 508.2551,-45.8789"/>
<polygon fill="#ff0000" stroke="#ff0000" points="508.8555,-42.4286 498.3488,-43.7923 507.4127,-49.2783 508.8555,-42.4286"/>
</g>
<!-- sourcefile~source.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~source.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/source.f90.html" xlink:title="source.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="644.5,-302.9131 581.5,-302.9131 581.5,-278.9131 644.5,-278.9131 644.5,-302.9131"/>
<text text-anchor="middle" x="613" y="-288.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">source.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~source.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~source.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M713.4184,-795.7699C706.9606,-746.9833 681.2981,-560.6269 647,-409.9131 639.1857,-375.5751 627.4409,-336.4282 620.0015,-312.7049"/>
<polygon fill="#ff0000" stroke="#ff0000" points="623.2721,-311.4394 616.9159,-302.963 616.5989,-313.5531 623.2721,-311.4394"/>
</g>
<!-- sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~global_sst.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/global_sst.f90.html" xlink:title="global_sst.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="315,-395.9131 236,-395.9131 236,-371.9131 315,-371.9131 315,-395.9131"/>
<text text-anchor="middle" x="275.5" y="-381.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_sst.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M713.1165,-795.8487C703.8178,-737.5225 661.3129,-485.08 613,-423.9131"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M613,-423.9131C545.7985,-338.8322 401.1883,-355.281 324.9154,-371.3424"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.0906,-367.9399 315.0684,-373.4942 325.5851,-374.7786 324.0906,-367.9399"/>
</g>
<!-- sourcefile~lusgs.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~lusgs.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/lusgs.f90.html" xlink:title="lusgs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="640.5,-878.9131 585.5,-878.9131 585.5,-854.9131 640.5,-854.9131 640.5,-878.9131"/>
<text text-anchor="middle" x="613" y="-864.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lusgs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~lusgs.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~lusgs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M693.8655,-820.1379C678.9966,-828.7386 658.8984,-840.364 642.4587,-849.8733"/>
<polygon fill="#ff0000" stroke="#ff0000" points="640.6621,-846.869 633.7584,-854.9058 644.1671,-852.9284 640.6621,-846.869"/>
</g>
<!-- sourcefile~face_interpolant.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~face_interpolant.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M269.487,-1410.7131C258.1309,-1387.0774 233.6274,-1333.1236 222,-1284.9131 188.4506,-1145.8081 155.416,-687.5518 148.0281,-580.4437"/>
<polygon fill="#ff5400" stroke="#ff5400" points="151.4994,-579.9039 147.3238,-570.1666 144.5158,-580.3825 151.4994,-579.9039"/>
</g>
<!-- sourcefile~face_interpolant.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~face_interpolant.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M225.4903,-1410.8642C212.6661,-1408.0152 198.8613,-1405.1568 186,-1402.9131 151.0723,-1396.8198 111.2589,-1391.8807 81.3578,-1388.567"/>
<polygon fill="#ff5400" stroke="#ff5400" points="81.5392,-1385.0661 71.2191,-1387.4634 80.7817,-1392.025 81.5392,-1385.0661"/>
</g>
<!-- sourcefile~weno_nm.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~weno_nm.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/weno_nm.f90.html" xlink:title="weno_NM.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="186,-1355.9131 107,-1355.9131 107,-1331.9131 186,-1331.9131 186,-1355.9131"/>
<text text-anchor="middle" x="146.5" y="-1341.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">weno_NM.f90</text>
</a>
</g>
</g>
<!-- sourcefile~face_interpolant.f90&#45;&gt;sourcefile~weno_nm.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~face_interpolant.f90&#45;&gt;sourcefile~weno_nm.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M255.6265,-1410.7425C234.0684,-1397.5403 199.4646,-1376.3488 175.0111,-1361.3734"/>
<polygon fill="#ff5400" stroke="#ff5400" points="176.5403,-1358.2057 166.1844,-1355.9679 172.8845,-1364.1752 176.5403,-1358.2057"/>
</g>
<!-- sourcefile~muscl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~muscl.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/muscl.f90.html" xlink:title="muscl.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="175.5,-1519.9131 117.5,-1519.9131 117.5,-1495.9131 175.5,-1495.9131 175.5,-1519.9131"/>
<text text-anchor="middle" x="146.5" y="-1505.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">muscl.f90</text>
</a>
</g>
</g>
<!-- sourcefile~face_interpolant.f90&#45;&gt;sourcefile~muscl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~face_interpolant.f90&#45;&gt;sourcefile~muscl.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M259.7692,-1435.1316C242.2279,-1448.5241 212.7924,-1470.3124 186,-1486.9131 183.8626,-1488.2374 181.6341,-1489.5627 179.3717,-1490.8674"/>
<polygon fill="#ff5400" stroke="#ff5400" points="177.6327,-1487.8296 170.5988,-1495.7527 181.0383,-1493.9453 177.6327,-1487.8296"/>
</g>
<!-- sourcefile~ppm.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~ppm.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node27"><a xlink:href=".././sourcefile/ppm.f90.html" xlink:title="ppm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="173.5,-1477.9131 119.5,-1477.9131 119.5,-1453.9131 173.5,-1453.9131 173.5,-1477.9131"/>
<text text-anchor="middle" x="146.5" y="-1463.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ppm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~face_interpolant.f90&#45;&gt;sourcefile~ppm.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~face_interpolant.f90&#45;&gt;sourcefile~ppm.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M239.223,-1435.0054C221.7803,-1440.8196 200.9075,-1447.7773 183.3861,-1453.6177"/>
<polygon fill="#ff5400" stroke="#ff5400" points="181.8883,-1450.4276 173.5083,-1456.9103 184.1019,-1457.0684 181.8883,-1450.4276"/>
</g>
<!-- sourcefile~weno.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~weno.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node29"><a xlink:href=".././sourcefile/weno.f90.html" xlink:title="weno.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="174.5,-1435.9131 118.5,-1435.9131 118.5,-1411.9131 174.5,-1411.9131 174.5,-1435.9131"/>
<text text-anchor="middle" x="146.5" y="-1421.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">weno.f90</text>
</a>
</g>
</g>
<!-- sourcefile~face_interpolant.f90&#45;&gt;sourcefile~weno.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~face_interpolant.f90&#45;&gt;sourcefile~weno.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M221.9131,-1423.3285C209.5112,-1423.4246 196.5549,-1423.5251 184.9507,-1423.615"/>
<polygon fill="#ff5400" stroke="#ff5400" points="184.7011,-1420.1168 174.7286,-1423.6943 184.7555,-1427.1165 184.7011,-1420.1168"/>
</g>
<!-- sourcefile~wall_dist.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~wall_dist.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M262.8756,-278.08C250.9012,-290.228 233.1308,-309.9214 222,-329.9131 182.8985,-400.1425 159.8739,-493.8888 150.8859,-535.9116"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="147.4214,-535.3812 148.8112,-545.8845 154.2746,-536.807 147.4214,-535.3812"/>
</g>
<!-- sourcefile~wall_dist.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~wall_dist.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M239.7838,-274.23C213.3422,-281.0399 176.8046,-291.8396 146.5,-305.9131"/>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M578.9754,-1491.1014C567.5925,-1487.6462 554.799,-1483.9371 543,-1480.9131 503.8194,-1470.8714 493.863,-1468.7607 454,-1461.9131"/>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M593.9746,-1489.8392C588.6744,-1485.8557 583.2194,-1481.1018 579,-1475.9131 555.6722,-1447.2264 569.7135,-1426.4767 543,-1400.9131 480.8515,-1341.4398 426.1336,-1385.4291 365,-1324.9131 336.7132,-1296.9121 350.7204,-1276.2661 329,-1242.9131 290.5457,-1183.864 251.789,-1189.7735 222,-1125.9131 175.373,-1025.9561 152.8742,-672.9813 147.6888,-580.3247"/>
<polygon fill="#aaff00" stroke="#aaff00" points="151.1719,-579.9201 147.1298,-570.1267 144.1824,-580.3033 151.1719,-579.9201"/>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M578.8033,-1513.65C567.5212,-1517.1233 554.8312,-1520.6092 543,-1522.9131 425.7945,-1545.7364 394.634,-1555.9827 275.5,-1547.9131"/>
</g>
<!-- sourcefile~van_leer.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~van_leer.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/van_leer.f90.html" xlink:title="van_leer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="182.5,-1679.9131 110.5,-1679.9131 110.5,-1655.9131 182.5,-1655.9131 182.5,-1679.9131"/>
<text text-anchor="middle" x="146.5" y="-1665.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">van_leer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~van_leer.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~van_leer.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M454,-1663.9131C364.916,-1691.8768 254.0425,-1683.5012 192.7231,-1675.3857"/>
<polygon fill="#aaff00" stroke="#aaff00" points="192.977,-1671.8876 182.5923,-1673.9869 192.0195,-1678.8218 192.977,-1671.8876"/>
</g>
<!-- sourcefile~ausmup.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~ausmup.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/ausmup.f90.html" xlink:title="ausmUP.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="311,-1639.9131 240,-1639.9131 240,-1615.9131 311,-1615.9131 311,-1639.9131"/>
<text text-anchor="middle" x="275.5" y="-1625.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ausmUP.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~ausmup.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~ausmup.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M454,-1663.9131C404.2763,-1679.1783 344.7356,-1659.9513 308.5358,-1644.2629"/>
<polygon fill="#aaff00" stroke="#aaff00" points="309.5279,-1640.8716 298.972,-1639.9634 306.6576,-1647.2561 309.5279,-1640.8716"/>
</g>
<!-- sourcefile~slau.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~slau.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node30"><a xlink:href=".././sourcefile/slau.f90.html" xlink:title="slau.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="173.5,-1599.9131 119.5,-1599.9131 119.5,-1575.9131 173.5,-1575.9131 173.5,-1599.9131"/>
<text text-anchor="middle" x="146.5" y="-1585.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">slau.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~slau.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~slau.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M610.759,-1514.1437C604.9691,-1542.0653 586.7904,-1610.7196 543,-1644.9131 511.1206,-1669.8059 492.6658,-1652.0427 454,-1663.9131"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M454,-1663.9131C415.3342,-1675.7835 400.2727,-1664.7068 365,-1644.9131 344.7117,-1633.5281 349.866,-1617.2012 329,-1606.9131 282.9056,-1584.186 222.4279,-1582.5583 184.0024,-1584.4624"/>
<polygon fill="#aaff00" stroke="#aaff00" points="183.5507,-1580.9832 173.7794,-1585.0785 183.9719,-1587.9705 183.5507,-1580.9832"/>
</g>
<!-- sourcefile~ldfss0.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~ldfss0.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node32"><a xlink:href=".././sourcefile/ldfss0.f90.html" xlink:title="ldfss0.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="483,-1635.9131 425,-1635.9131 425,-1611.9131 483,-1611.9131 483,-1635.9131"/>
<text text-anchor="middle" x="454" y="-1621.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ldfss0.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~ldfss0.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~ldfss0.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M608.12,-1514.0391C598.8302,-1535.507 576.4958,-1580.0845 543,-1602.9131 528.4424,-1612.8346 509.7825,-1618.1006 493.3121,-1620.8829"/>
<polygon fill="#aaff00" stroke="#aaff00" points="492.7938,-1617.4214 483.3962,-1622.3137 493.7936,-1624.3496 492.7938,-1617.4214"/>
</g>
<!-- sourcefile~ausmp.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~ausmp.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node33"><a xlink:href=".././sourcefile/ausmp.f90.html" xlink:title="ausmP.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="486,-1513.9131 422,-1513.9131 422,-1489.9131 486,-1489.9131 486,-1513.9131"/>
<text text-anchor="middle" x="454" y="-1499.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ausmP.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~ausmp.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~ausmp.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M578.8905,-1501.9131C554.7505,-1501.9131 522.2136,-1501.9131 496.4021,-1501.9131"/>
<polygon fill="#aaff00" stroke="#aaff00" points="496.1559,-1498.4132 486.1558,-1501.9131 496.1558,-1505.4132 496.1559,-1498.4132"/>
</g>
<!-- sourcefile~ausm.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~ausm.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node34"><a xlink:href=".././sourcefile/ausm.f90.html" xlink:title="ausm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="482.5,-1593.9131 425.5,-1593.9131 425.5,-1569.9131 482.5,-1569.9131 482.5,-1593.9131"/>
<text text-anchor="middle" x="454" y="-1579.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ausm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scheme.f90&#45;&gt;sourcefile~ausm.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~scheme.f90&#45;&gt;sourcefile~ausm.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M600.0855,-1514.301C586.7596,-1526.4672 564.8877,-1544.777 543,-1555.9131 527.3472,-1563.877 508.8713,-1569.7752 492.8215,-1573.9218"/>
<polygon fill="#aaff00" stroke="#aaff00" points="491.5635,-1570.6261 482.679,-1576.398 493.2238,-1577.4264 491.5635,-1570.6261"/>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M243.911,-438.0395C236.2776,-441.811 228.4651,-446.444 222,-451.9131 193.4736,-476.0446 170.2961,-513.2333 157.4611,-536.5391"/>
<polygon fill="#54ff00" stroke="#54ff00" points="154.2449,-535.1311 152.6082,-545.5988 160.4154,-538.4365 154.2449,-535.1311"/>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M237.8415,-414.1765C232.2554,-411.5902 226.7781,-408.5203 222,-404.9131 177.8368,-371.5726 196.6872,-282.6061 146.5,-305.9131"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M418.712,-738.2604C402.1098,-742.6809 382.2216,-748.6958 365,-755.9131 343.3934,-764.968 320.345,-777.9296 303.0494,-788.3868"/>
<polygon fill="#00ff00" stroke="#00ff00" points="300.7668,-785.6813 294.0783,-793.898 304.431,-791.6457 300.7668,-785.6813"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M443.7635,-717.7354C424.8484,-694.5225 384.5719,-641.6319 365,-589.9131 328.8458,-494.3755 362.1642,-459.5294 329,-362.9131 319.3952,-334.9316 302.016,-305.554 289.6736,-286.5613"/>
<polygon fill="#00ff00" stroke="#00ff00" points="292.5204,-284.5213 284.0753,-278.1235 286.6874,-288.3913 292.5204,-284.5213"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M418.7933,-733.5156C401.0314,-736.8759 380.1102,-743.3688 365,-755.9131 337.7782,-778.5123 355.1798,-803.1146 329,-826.9131 327.0619,-828.6749 324.9587,-830.2963 322.7447,-831.7874"/>
<polygon fill="#00ff00" stroke="#00ff00" points="320.7169,-828.9149 313.7706,-836.9149 324.1897,-834.9927 320.7169,-828.9149"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M427.3792,-717.9013C406.9402,-707.2381 379.7899,-689.6606 365,-665.9131 314.0126,-584.0449 386.7947,-529.1264 329,-451.9131 326.6987,-448.8386 323.9371,-446.1087 320.8975,-443.6882"/>
<polygon fill="#00ff00" stroke="#00ff00" points="322.5901,-440.6103 312.3271,-437.9792 318.7093,-446.4361 322.5901,-440.6103"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M418.8609,-726.9045C381.663,-722.6323 322.0165,-712.6267 275.5,-689.9131"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M275.5,-465.9131C262.0764,-444.5473 241.132,-463.3648 222,-446.9131 168.1018,-400.5658 210.972,-275.9723 146.5,-305.9131"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M426.7669,-717.8017C406.2701,-707.1832 379.3386,-689.7138 365,-665.9131 304.5732,-565.6106 401.4323,-496.9216 329,-404.9131 327.3798,-402.855 325.5294,-400.9983 323.513,-399.3231"/>
<polygon fill="#00ff00" stroke="#00ff00" points="325.3194,-396.3215 315.0487,-393.7208 321.4558,-402.1588 325.3194,-396.3215"/>
</g>
<!-- sourcefile~copy_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~copy_bc.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/copy_bc.f90.html" xlink:title="copy_bc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="181.5,-194.9131 111.5,-194.9131 111.5,-170.9131 181.5,-170.9131 181.5,-194.9131"/>
<text text-anchor="middle" x="146.5" y="-180.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">copy_bc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~copy_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~copy_bc.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M432.1294,-717.7757C412.426,-705.9274 383.7555,-686.2986 365,-662.9131 304.8323,-587.8924 326.6605,-547.3431 275.5,-465.9131"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M275.5,-465.9131C262.0764,-444.5473 238.8059,-465.7347 222,-446.9131 174.8963,-394.1597 206.0835,-359.7241 186,-291.9131 176.8714,-261.0909 163.7594,-226.3036 155.187,-204.4943"/>
<polygon fill="#00ff00" stroke="#00ff00" points="158.4311,-203.1803 151.4895,-195.1763 151.9247,-205.7622 158.4311,-203.1803"/>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M607.4589,-1238.0665C597.4465,-1258.7441 574.426,-1300.8611 543,-1324.9131 508.3725,-1351.4154 394.5392,-1387.9023 327.039,-1408.0461"/>
<polygon fill="#00ff55" stroke="#00ff55" points="326.0227,-1404.6968 317.4311,-1410.8964 328.0136,-1411.4077 326.0227,-1404.6968"/>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M607.9279,-1213.8446C600.3552,-1195.2943 586.2139,-1158.4977 579,-1125.9131 546.9181,-981.0014 617.7353,-922.1444 543,-793.9131 531.0585,-773.4238 509.6554,-757.7175 490.8309,-746.9924"/>
<polygon fill="#00ff55" stroke="#00ff55" points="492.3097,-743.813 481.8497,-742.1284 488.9761,-749.9683 492.3097,-743.813"/>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M585.6048,-1222.8709C524.1266,-1214.8234 372.9467,-1188.0964 275.5,-1111.9131"/>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M585.8347,-1232.1142C540.199,-1242.5411 445.2564,-1264.2746 365,-1282.9131 325.2011,-1292.1559 316.2513,-1306.8654 275.5,-1303.9131"/>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M275.5,-1303.9131C218.3091,-1299.875 199.5465,-1282.1604 146.5,-1303.9131"/>
</g>
<!-- sourcefile~read.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~read.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/read.f90.html" xlink:title="read.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="481,-1315.9131 427,-1315.9131 427,-1291.9131 481,-1291.9131 481,-1315.9131"/>
<text text-anchor="middle" x="454" y="-1301.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">read.f90</text>
</a>
</g>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~read.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~read.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M599.749,-1238.0352C586.3355,-1249.7298 564.5522,-1267.1929 543,-1277.9131 526.6483,-1286.0465 507.3099,-1292.0774 490.8437,-1296.2719"/>
<polygon fill="#00ff55" stroke="#00ff55" points="489.9119,-1292.8962 481.0146,-1298.6486 491.5571,-1299.7002 489.9119,-1292.8962"/>
</g>
<!-- sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M364.75,-1422.4131C356.1704,-1422.4612 347.5907,-1422.5092 339.3282,-1422.5555"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="339.0361,-1419.057 329.0559,-1422.6131 339.0754,-1426.0569 339.0361,-1419.057"/>
</g>
<!-- sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~boundary_state_reconstruction.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M436.7001,-1409.8114C393.7462,-1379.8547 284.9945,-1304.6009 275.5,-1303.9131"/>
</g>
<!-- sourcefile~interface1.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~interface1.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M238.1411,-1251.881C231.8885,-1248.3076 226.1083,-1243.7351 222,-1237.9131 183.1433,-1182.8473 153.8429,-690.9637 147.6945,-580.0594"/>
<polygon fill="#00ffff" stroke="#00ffff" points="151.186,-579.8074 147.1435,-570.0141 144.1965,-580.1908 151.186,-579.8074"/>
</g>
<!-- sourcefile~interface1.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~interface1.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M236.4879,-1274.0652C210.5678,-1281.2813 176.0046,-1291.8142 146.5,-1303.9131"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M146.5,-1303.9131C128.4757,-1311.3043 123.3235,-1312.2806 107,-1322.9131 88.2561,-1335.1221 69.0827,-1351.7486 55.3152,-1364.5598"/>
<polygon fill="#00ffff" stroke="#00ffff" points="52.7343,-1362.1835 47.878,-1371.5998 57.5465,-1367.2672 52.7343,-1362.1835"/>
</g>
<!-- sourcefile~mapping.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~mapping.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node31"><a xlink:href=".././sourcefile/mapping.f90.html" xlink:title="mapping.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="182.5,-1275.9131 110.5,-1275.9131 110.5,-1251.9131 182.5,-1251.9131 182.5,-1275.9131"/>
<text text-anchor="middle" x="146.5" y="-1261.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mapping.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interface1.f90&#45;&gt;sourcefile~mapping.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~interface1.f90&#45;&gt;sourcefile~mapping.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M236.4457,-1263.9131C222.721,-1263.9131 207.1656,-1263.9131 192.8965,-1263.9131"/>
<polygon fill="#00ffff" stroke="#00ffff" points="192.7784,-1260.4132 182.7783,-1263.9131 192.7783,-1267.4132 192.7784,-1260.4132"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M582.2931,-805.0653C550.1026,-802.7427 498.161,-800.8726 454,-807.9131"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M607.1586,-795.8428C599.4316,-779.3311 585.9781,-748.5882 579,-720.9131 546.7068,-592.8378 615.0082,-536.6422 543,-425.9131 490.7413,-345.5533 382.7263,-299.7964 321.137,-279.2312"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="321.8925,-275.7964 311.3003,-276.0292 319.7258,-282.4527 321.8925,-275.7964"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M582.3648,-814.5984C550.2328,-821.7588 498.3383,-833.7434 454,-845.9131"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M605.6337,-795.673C593.6935,-776.2893 568.8336,-737.7711 543,-708.9131 472.4454,-630.0983 424.4501,-638.4084 365,-550.9131 338.6875,-512.1878 360.3474,-486.6887 329,-451.9131 326.1219,-448.7202 322.7653,-445.8783 319.1619,-443.3576"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="320.7791,-440.2448 310.4151,-438.0448 317.1451,-446.2276 320.7791,-440.2448"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M588.5047,-795.8965C561.5435,-782.6703 518.0277,-761.3229 487.8239,-746.506"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="489.0425,-743.2053 478.5231,-741.9433 485.9595,-749.4899 489.0425,-743.2053"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M599.4166,-820.1284C592.4244,-827.0743 584.2823,-836.2905 579,-845.9131 550.5624,-897.7171 580.3584,-928.1234 543,-973.9131 521.8577,-999.8269 301.6934,-1132.708 275.5,-1111.9131"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M275.5,-1111.9131C188.9646,-1044.2601 155.4133,-675.8514 148.1067,-580.4697"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="151.5772,-579.9422 147.344,-570.2298 144.5966,-580.4622 151.5772,-579.9422"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M601.4438,-820.0212C588.5488,-832.6132 566.4028,-851.6222 543,-859.9131 408.47,-907.5729 328.2207,-964.2385 222,-868.9131 175.0266,-826.7578 203.7438,-279.329 146.5,-305.9131"/>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M607.4916,-795.7515C600.1419,-779.1363 587.1145,-748.2765 579,-720.9131 556.5477,-645.2009 587.3726,-612.2393 543,-546.9131 489.806,-468.5998 443.4418,-482.9173 365,-429.9131 348.8597,-419.0068 346.1828,-414.0896 329,-404.9131 325.7737,-403.1901 322.3744,-401.5299 318.9178,-399.95"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="320.2813,-396.7264 309.7137,-395.9669 317.5012,-403.1507 320.2813,-396.7264"/>
</g>
<!-- sourcefile~viscous.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~viscous.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M606.3061,-711.9377C595.453,-730.3022 572.2522,-765.1746 543,-783.9131 508.5025,-806.0116 494.4576,-801.463 454,-807.9131"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M454,-807.9131C410.8242,-814.7966 361.0275,-813.4861 325.0187,-810.9222"/>
<polygon fill="#0054ff" stroke="#0054ff" points="325.0172,-807.4118 314.7778,-810.133 324.4793,-814.3911 325.0172,-807.4118"/>
</g>
<!-- sourcefile~viscous.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~viscous.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M609.514,-712.0617C601.8025,-736.7031 580.9089,-792.6952 543,-821.9131 510.551,-846.9228 493.5074,-835.0694 454,-845.9131"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M454,-845.9131C411.1582,-857.672 360.3263,-856.889 323.8857,-853.9229"/>
<polygon fill="#0054ff" stroke="#0054ff" points="323.8102,-850.4021 313.5365,-852.9907 323.1822,-857.3738 323.8102,-850.4021"/>
</g>
<!-- sourcefile~viscous.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~viscous.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M606.4304,-687.8056C595.2382,-667.9017 570.9509,-627.706 543,-599.9131 460.9981,-518.3746 428.851,-510.2451 329,-451.9131 323.4409,-448.6655 317.4165,-445.4577 311.4831,-442.4629"/>
<polygon fill="#0054ff" stroke="#0054ff" points="312.8326,-439.2264 302.3141,-437.9571 309.7453,-445.5088 312.8326,-439.2264"/>
</g>
<!-- sourcefile~viscous.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~viscous.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M579.6684,-706.2021C556.2746,-710.616 524.7187,-716.5699 499.081,-721.4072"/>
<polygon fill="#0054ff" stroke="#0054ff" points="498.3948,-717.9749 489.2171,-723.2684 499.6927,-724.8535 498.3948,-717.9749"/>
</g>
<!-- sourcefile~viscous.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~viscous.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M579.7355,-702.3426C505.4217,-707.2274 328.3069,-715.6982 275.5,-689.9131"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M275.5,-689.9131C224.143,-663.4208 181.1253,-608.7462 160.1845,-578.7438"/>
<polygon fill="#0054ff" stroke="#0054ff" points="162.938,-576.5695 154.4096,-570.2833 157.1565,-580.5158 162.938,-576.5695"/>
</g>
<!-- sourcefile~viscous.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~viscous.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M611.4526,-687.7845C602.0068,-613.96 552.2167,-227.8832 543,-219.9131 483.1597,-168.1665 432.9001,-179.3157 365,-219.9131 335.9864,-237.2603 357.0753,-268.085 329,-286.9131 261.2708,-332.3342 220.5403,-271.7319 146.5,-305.9131"/>
</g>
<!-- sourcefile~viscous.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~viscous.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M611.2786,-687.8056C604.5724,-642.311 578.7864,-482.4301 543,-447.9131 484.4767,-391.4657 385.4603,-381.7949 325.7096,-381.6476"/>
<polygon fill="#0054ff" stroke="#0054ff" points="325.3655,-378.1497 315.389,-381.716 325.412,-385.1496 325.3655,-378.1497"/>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M425.399,-50.0188C405.5677,-59.8473 380.1026,-75.5787 365,-96.9131 327.133,-150.4052 370.3388,-189.0563 329,-239.9131 326.3253,-243.2037 323.1322,-246.1075 319.6557,-248.6641"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="317.7435,-245.732 311.1406,-254.0177 321.4694,-251.6581 317.7435,-245.732"/>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M409.9484,-36.5476C373.7978,-35.7553 321.2932,-35.3556 275.5,-37.9131"/>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M424.5848,-49.9604C404.6313,-59.6758 379.3601,-75.2943 365,-96.9131 317.4455,-168.5052 358.1188,-206.0493 329,-286.9131 318.9769,-314.7475 301.6821,-344.1548 289.4737,-363.1946"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="286.4845,-361.3707 283.9432,-371.6562 292.344,-365.2004 286.4845,-361.3707"/>
</g>
<!-- sourcefile~ft_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~ft_bc.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/ft_bc.f90.html" xlink:title="FT_bc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="306,-89.9131 245,-89.9131 245,-65.9131 306,-65.9131 306,-89.9131"/>
<text text-anchor="middle" x="275.5" y="-75.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FT_bc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~ft_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~ft_bc.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M409.8764,-47.8007C381.1885,-54.2294 344.0593,-62.5497 316.1014,-68.8147"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="315.2414,-65.4206 306.2487,-71.0226 316.7721,-72.2512 315.2414,-65.4206"/>
</g>
<!-- sourcefile~bc_primitive.f90&#45;&gt;sourcefile~copy_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~bc_primitive.f90&#45;&gt;sourcefile~copy_bc.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M409.7164,-46.321C394.8656,-50.2964 378.6288,-55.9685 365,-63.9131 345.721,-75.1513 347.4008,-86.2882 329,-98.9131 285.5699,-128.7107 229.8762,-152.5823 191.4979,-167.1511"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="189.7881,-164.0535 181.6451,-170.8315 192.2377,-170.6109 189.7881,-164.0535"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M604.9901,-303.1355C560.6862,-370.7401 345.6027,-698.9416 289.1122,-785.1419"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="286.1386,-783.294 283.5847,-793.5764 291.9934,-787.1309 286.1386,-783.294"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M608.5966,-278.6626C599.7994,-255.9743 577.8488,-207.4105 543,-181.9131 509.9364,-157.7218 494.4502,-151.417 454,-157.9131"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M608.7071,-303.2477C601.4259,-324.6693 586.6979,-370.2589 579,-409.9131 564.4789,-484.7156 589.9625,-690.9065 543,-750.9131 515.3959,-786.1844 392.6848,-820.1561 323.4505,-836.9726"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="322.548,-833.5898 313.6413,-839.3274 324.1821,-840.3964 322.548,-833.5898"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M583.1817,-302.9699C531.4825,-323.8543 421.8366,-368.0608 329,-404.9131 324.7643,-406.5945 320.3372,-408.3443 315.9216,-410.0847"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="314.3771,-406.9311 306.3528,-413.8493 316.9399,-413.4452 314.3771,-406.9311"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M609.5715,-303.123C599.9896,-336.9394 571.743,-434.5561 543,-513.9131 516.7542,-586.3756 480.436,-670.2719 463.4584,-708.7046"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="460.2448,-707.3177 459.3913,-717.8781 466.644,-710.1549 460.2448,-707.3177"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M595.947,-278.7195C567.4605,-259.7632 507.9895,-226.1604 454,-233.9131"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M454,-233.9131C413.4474,-239.7363 401.5122,-239.3313 365,-257.9131 346.6892,-267.2318 345.3827,-274.5143 329,-286.9131 282.4883,-322.1144 257.8236,-316.879 222,-362.9131 179.9949,-416.8905 158.9247,-497.0344 150.7262,-535.5953"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="147.2275,-535.2373 148.6668,-545.7339 154.0874,-536.6308 147.2275,-535.2373"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M610.4975,-278.7391C602.2031,-239.7035 574.3531,-118.9318 543,-96.9131 478.2591,-51.4468 436.4903,-63.0353 365,-96.9131 342.167,-107.7332 347.7361,-123.9609 329,-140.9131 286.6792,-179.2045 264.1472,-173.4307 222,-211.9131 182.4283,-248.044 195.0657,-283.2696 146.5,-305.9131"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M146.5,-305.9131C47.047,-352.4205 36.6734,-1210.3303 35.6172,-1361.3161"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="32.1152,-1361.6285 35.5522,-1371.6504 39.1151,-1361.6726 32.1152,-1361.6285"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M454,-233.9131C413.4474,-239.7363 395.1344,-230.1581 365,-257.9131 330.2551,-289.9146 360.5708,-322.7763 329,-357.9131 326.127,-361.1106 322.7739,-363.9556 319.1727,-366.4784"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="317.1558,-363.6084 310.429,-371.7938 320.7921,-369.5899 317.1558,-363.6084"/>
</g>
<!-- sourcefile~cc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~cc.f90</title>
<g id="a_sourcefile~~update.f90~~EfferentGraph_node28"><a xlink:href=".././sourcefile/cc.f90.html" xlink:title="CC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="481,-129.9131 427,-129.9131 427,-105.9131 481,-105.9131 481,-129.9131"/>
<text text-anchor="middle" x="454" y="-115.5131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~cc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~cc.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M610.6856,-278.5732C604.7415,-250.3604 586.2606,-180.7448 543,-143.9131 528.5534,-131.6134 508.5431,-125.1281 491.1548,-121.7104"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="491.7269,-118.2575 481.2817,-120.0319 490.5536,-125.1585 491.7269,-118.2575"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M603.9825,-879.0686C591.8378,-894.5723 568.7554,-921.1392 543,-935.9131 507.463,-956.298 494.9053,-962.1879 454,-959.9131"/>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M454,-959.9131C405.867,-957.2363 396.6347,-934.2888 365,-897.9131 341.7828,-871.2164 355.1798,-850.7116 329,-826.9131 327.2903,-825.3589 325.4521,-823.914 323.5228,-822.5715"/>
<polygon fill="#ff0055" stroke="#ff0055" points="324.9887,-819.3731 314.595,-817.3182 321.4387,-825.4062 324.9887,-819.3731"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M598.5843,-854.6109C591.5345,-847.7741 583.5972,-838.6858 579,-828.9131 533.2744,-731.7106 586.9647,-687.9247 543,-589.9131 492.3675,-477.0369 443.5955,-471.4507 365,-375.9131 339.3166,-344.6933 309.7589,-308.2675 291.8636,-286.1585"/>
<polygon fill="#ff0055" stroke="#ff0055" points="294.4007,-283.7296 285.3901,-278.1565 288.9585,-288.1323 294.4007,-283.7296"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M454,-959.9131C386.2658,-956.1463 323.0041,-899.0743 293.2732,-867.8951"/>
<polygon fill="#ff0055" stroke="#ff0055" points="295.5007,-865.1509 286.1268,-860.2132 290.3755,-869.9188 295.5007,-865.1509"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M585.1073,-862.7968C532.4323,-853.4203 418.7914,-825.2257 365,-750.9131 286.5168,-642.4887 406.6755,-560.9176 329,-451.9131 326.8032,-448.8303 324.1386,-446.0972 321.1852,-443.677"/>
<polygon fill="#ff0055" stroke="#ff0055" points="323.051,-440.7131 312.8159,-437.9757 319.11,-446.4983 323.051,-440.7131"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M601.8591,-854.7661C585.3561,-836.8653 555.0663,-804.3877 543,-793.9131 523.3622,-776.8657 499.3325,-759.7835 481.1939,-747.5602"/>
<polygon fill="#ff0055" stroke="#ff0055" points="483.0702,-744.6046 472.8078,-741.9714 479.1882,-750.4296 483.0702,-744.6046"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M610.4592,-879.0256C603.6984,-909.0739 582.9943,-988.4669 543,-1041.9131 512.849,-1082.2053 501.6378,-1095.6902 454,-1111.9131"/>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M454,-1111.9131C416.4509,-1124.7003 306.75,-1136.3442 275.5,-1111.9131"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M611.3996,-879.0624C605.0424,-925.476 580.1036,-1090.7481 543,-1125.9131 484.2862,-1181.5592 443.3038,-1143.6073 365,-1163.9131 248.9178,-1194.0156 198.7742,-1165.7203 107,-1242.9131 69.4217,-1274.5208 49.4466,-1330.8139 40.8236,-1361.8525"/>
<polygon fill="#ff0055" stroke="#ff0055" points="37.3934,-1361.1349 38.2367,-1371.6961 44.1635,-1362.9141 37.3934,-1361.1349"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M599.4827,-854.6611C592.51,-847.7044 584.3652,-838.4896 579,-828.9131 551.7845,-780.3357 576.0953,-753.692 543,-708.9131 486.4389,-632.3844 417.6947,-669.1537 365,-589.9131 318.6165,-520.1631 382.6076,-469.277 329,-404.9131 327.3517,-402.934 325.4918,-401.1406 323.4799,-399.5154"/>
<polygon fill="#ff0055" stroke="#ff0055" points="325.3795,-396.5757 315.0914,-394.0446 321.5556,-402.439 325.3795,-396.5757"/>
</g>
<!-- sourcefile~ft_bc.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~ft_bc.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245.5058,-65.8038C209.9298,-51.8746 154.4195,-31.6729 146.5,-37.9131"/>
</g>
<!-- sourcefile~ft_bc.f90&#45;&gt;sourcefile~copy_bc.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~ft_bc.f90&#45;&gt;sourcefile~copy_bc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M253.7314,-89.9408C243.7413,-95.8085 231.936,-103.2464 222,-110.9131 200.9966,-127.1195 179.3123,-148.3502 164.6017,-163.5508"/>
<polygon fill="#ff0000" stroke="#ff0000" points="161.9647,-161.2442 157.5852,-170.8915 167.025,-166.081 161.9647,-161.2442"/>
</g>
<!-- sourcefile~weno_nm.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~weno_nm.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M113.1963,-1355.9144C102.3204,-1359.8337 90.0829,-1364.2436 78.5931,-1368.3841"/>
<polygon fill="#ff6600" stroke="#ff6600" points="77.385,-1365.099 69.1638,-1371.782 79.7582,-1371.6845 77.385,-1365.099"/>
</g>
<!-- sourcefile~van_leer.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~van_leer.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M122.0549,-1655.7488C116.4406,-1651.978 110.9635,-1647.3548 107,-1641.9131 52.7858,-1567.4792 39.6615,-1453.7336 36.4982,-1406.1021"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="39.9842,-1405.757 35.9134,-1395.9755 32.9958,-1406.1606 39.9842,-1405.757"/>
</g>
<!-- sourcefile~muscl.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~muscl.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M119.4429,-1495.7649C115.043,-1493.1772 110.7161,-1490.2142 107,-1486.9131 80.3481,-1463.2381 58.5353,-1427.7028 46.2771,-1405.17"/>
<polygon fill="#cbff00" stroke="#cbff00" points="49.2491,-1403.3031 41.4781,-1396.1015 43.062,-1406.5772 49.2491,-1403.3031"/>
</g>
<!-- sourcefile~read.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~read.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M426.7389,-1305.1347C391.6906,-1306.4251 328.9718,-1307.787 275.5,-1303.9131"/>
</g>
<!-- sourcefile~copy_bc.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~copy_bc.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M140.8324,-195.0051C131.8636,-214.7741 114.6357,-255.4679 107,-291.9131 61.9064,-507.1452 39.9007,-1226.0488 36.1006,-1361.7228"/>
<polygon fill="#00ff00" stroke="#00ff00" points="32.6009,-1361.6653 35.8231,-1371.7582 39.5982,-1361.8588 32.6009,-1361.6653"/>
</g>
<!-- sourcefile~ausmup.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~ausmup.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M239.968,-1634.2306C202.6088,-1638.7423 144.1925,-1639.4657 107,-1608.9131 74.9857,-1582.6142 48.945,-1457.5326 39.4085,-1406.089"/>
<polygon fill="#00ff66" stroke="#00ff66" points="42.8109,-1405.2359 37.5801,-1396.0224 35.9236,-1406.487 42.8109,-1405.2359"/>
</g>
<!-- sourcefile~ppm.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~ppm.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M121.781,-1453.8375C116.7703,-1451.0963 111.6231,-1448.0589 107,-1444.9131 88.5059,-1432.3289 69.3148,-1415.7291 55.4769,-1403.0235"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="57.6965,-1400.3078 47.9938,-1396.0525 52.9251,-1405.4298 57.6965,-1400.3078"/>
</g>
<!-- sourcefile~cc.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~cc.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M426.7389,-119.5382C407.305,-122.0646 381.7542,-128.3635 365,-143.9131 331.6002,-174.9115 359.6788,-206.2195 329,-239.9131 325.9854,-243.224 322.4572,-246.1592 318.6759,-248.7509"/>
<polygon fill="#00cbff" stroke="#00cbff" points="316.8765,-245.7489 310.0947,-253.8888 320.4724,-251.7547 316.8765,-245.7489"/>
</g>
<!-- sourcefile~cc.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~cc.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M275.5,-225.9131C257.5213,-243.6178 238.8856,-226.1629 222,-244.9131 182.7418,-288.5065 157.1048,-471.0304 149.1442,-535.3573"/>
<polygon fill="#00cbff" stroke="#00cbff" points="145.6303,-535.2619 147.9024,-545.6102 152.5795,-536.1037 145.6303,-535.2619"/>
</g>
<!-- sourcefile~cc.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~cc.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M426.6701,-121.1462C407.9375,-124.4394 383.269,-130.9944 365,-143.9131 342.6422,-159.7231 349.1677,-175.3903 329,-193.9131 308.594,-212.6547 295.2413,-206.4726 275.5,-225.9131"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M275.5,-225.9131C257.5213,-243.6178 244.0167,-232.5861 222,-244.9131 184.3591,-265.988 185.6259,-287.743 146.5,-305.9131"/>
</g>
<!-- sourcefile~weno.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~weno.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M118.49,-1413.8194C106.3968,-1409.4615 91.9739,-1404.2641 78.5706,-1399.434"/>
<polygon fill="#0066ff" stroke="#0066ff" points="79.6333,-1396.0967 69.0389,-1395.9992 77.2601,-1402.6822 79.6333,-1396.0967"/>
</g>
<!-- sourcefile~slau.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~slau.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M122.8785,-1575.7047C117.118,-1571.8871 111.3648,-1567.2524 107,-1561.9131 67.8416,-1514.0118 47.8627,-1441.8911 39.8487,-1405.9308"/>
<polygon fill="#0000ff" stroke="#0000ff" points="43.2403,-1405.0523 37.7378,-1395.9984 36.3932,-1406.5076 43.2403,-1405.0523"/>
</g>
<!-- sourcefile~mapping.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~mapping.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M125.0247,-1276.1698C118.8848,-1280.1585 112.3997,-1284.8693 107,-1289.9131 83.0913,-1312.2458 61.2096,-1343.2572 48.1164,-1363.4525"/>
<polygon fill="#6500ff" stroke="#6500ff" points="45.1569,-1361.584 42.7433,-1371.9003 51.0634,-1365.3408 45.1569,-1361.584"/>
</g>
<!-- sourcefile~ldfss0.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~ldfss0.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M424.7645,-1619.5765C407.0107,-1616.3233 384.1545,-1611.0142 365,-1602.9131 321.9994,-1584.7266 322.0816,-1551.0683 275.5,-1547.9131"/>
</g>
<!-- sourcefile~ausmp.f90&#45;&gt;sourcefile~face_interpolant.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~ausmp.f90&#45;&gt;sourcefile~face_interpolant.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M421.6012,-1494.5342C404.4182,-1490.1052 383.1631,-1483.7952 365,-1475.9131 342.5704,-1466.1795 318.8305,-1451.9161 301.4407,-1440.6374"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="303.2419,-1437.6327 292.9664,-1435.0512 299.3893,-1443.4772 303.2419,-1437.6327"/>
</g>
<!-- sourcefile~ausmp.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~ausmp.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M421.9147,-1511.2576C374.5933,-1524.875 290.089,-1548.5047 275.5,-1547.9131"/>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M275.5,-1547.9131C200.1984,-1544.8597 168.6641,-1572.2396 107,-1528.9131 65.3209,-1499.6285 46.8025,-1438.992 39.5532,-1406.1734"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="42.9449,-1405.2899 37.5096,-1396.1955 36.0873,-1406.6945 42.9449,-1405.2899"/>
</g>
<!-- sourcefile~ausm.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~update.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~ausm.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M425.2166,-1574.2071C390.1647,-1565.3415 329.0069,-1551.5374 275.5,-1547.9131"/>
</g>
</g>
</svg>
</div><script>var pansourcefileupdatef90EfferentGraph = svgPanZoom('#sourcefileupdatef90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~update.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileupdatef90AfferentGraph" width="257pt" height="32pt"
 viewBox="0.00 0.00 257.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~update.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~update.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 253,-28 253,4 -4,4"/>
<!-- sourcefile~update.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~update.f90</title>
<polygon fill="none" stroke="#000000" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">update.f90</text>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~update.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="159,-24 100,-24 100,0 159,0 159,-24"/>
<text text-anchor="middle" x="129.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~update.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~update.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M99.9822,-12C91.8447,-12 82.8557,-12 74.1525,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="74.1352,-8.5001 64.1352,-12 74.1351,-15.5001 74.1352,-8.5001"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~update.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="249,-24 195,-24 195,0 249,0 249,-24"/>
<text text-anchor="middle" x="222" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~update.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M194.7472,-12C186.791,-12 177.9269,-12 169.361,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="169.1413,-8.5001 159.1413,-12 169.1413,-15.5001 169.1413,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/update.html">update</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/update.f90.html#src">update.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>  <span class="c">!&lt; Time integration module</span>
<a name="ln-2"></a><span class="k">module </span><span class="n">update</span>
<a name="ln-3"></a>  <span class="c">!&lt; This module march the solution is time.</span>
<a name="ln-4"></a>  <span class="k">use </span><span class="n">vartypes</span>
<a name="ln-5"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cphi1</span>
<a name="ln-6"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cphi2</span>
<a name="ln-7"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">fphi</span>
<a name="ln-8"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">eta</span>
<a name="ln-9"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cd1</span>
<a name="ln-10"></a>  <span class="k">use </span><span class="n">global_kkl</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cmu</span>
<a name="ln-11"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">beta1</span>
<a name="ln-12"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">beta2</span>
<a name="ln-13"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">bstar</span>
<a name="ln-14"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sst_F1</span>
<a name="ln-15"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cb1</span>
<a name="ln-16"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cw1</span>
<a name="ln-17"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cw2</span>
<a name="ln-18"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cw3</span>
<a name="ln-19"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cv1</span>
<a name="ln-20"></a>  <span class="k">use </span><span class="n">global_sa</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">kappa_sa</span>
<a name="ln-21"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradu_x</span>
<a name="ln-22"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradu_y</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradu_z</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradv_x</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradv_y</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradv_z</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradw_x</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradw_y</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">gradients</span>  <span class="p">,</span><span class="n">only</span> <span class="p">:</span>   <span class="n">gradw_z</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">wall_dist</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dist</span>
<a name="ln-31"></a>  <span class="k">use </span><span class="n">viscosity</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mu</span>
<a name="ln-32"></a>  <span class="k">use </span><span class="n">viscosity</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mu_t</span>
<a name="ln-33"></a>
<a name="ln-34"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">alloc</span>
<a name="ln-35"></a>
<a name="ln-36"></a>  <span class="c">!subroutine for residual calculation</span>
<a name="ln-37"></a>  <span class="k">use </span><span class="n">interface1</span><span class="p">,</span>                      <span class="n">only</span><span class="p">:</span> <span class="n">apply_interface</span>
<a name="ln-38"></a>  <span class="k">use </span><span class="n">bc_primitive</span><span class="p">,</span>                   <span class="n">only</span><span class="p">:</span> <span class="n">populate_ghost_primitive</span>
<a name="ln-39"></a>  <span class="k">use </span><span class="n">face_interpolant</span><span class="p">,</span>               <span class="n">only</span><span class="p">:</span> <span class="n">compute_face_interpolant</span>
<a name="ln-40"></a>  <span class="k">use </span><span class="n">boundary_state_reconstruction</span><span class="p">,</span>  <span class="n">only</span><span class="p">:</span> <span class="n">reconstruct_boundary_state</span>
<a name="ln-41"></a>  <span class="k">use </span><span class="n">scheme</span><span class="p">,</span>                         <span class="n">only</span><span class="p">:</span> <span class="n">compute_fluxes</span>
<a name="ln-42"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span>                      <span class="n">only</span><span class="p">:</span> <span class="n">evaluate_all_gradients</span>
<a name="ln-43"></a>  <span class="k">use </span><span class="n">viscosity</span>                      <span class="p">,</span><span class="n">only</span><span class="p">:</span> <span class="n">calculate_viscosity</span>
<a name="ln-44"></a>  <span class="k">use </span><span class="n">viscous</span><span class="p">,</span>                        <span class="n">only</span><span class="p">:</span> <span class="n">compute_viscous_fluxes</span>
<a name="ln-45"></a>  <span class="k">use </span><span class="n">scheme</span><span class="p">,</span>                         <span class="n">only</span><span class="p">:</span> <span class="n">compute_residue</span>
<a name="ln-46"></a>  <span class="k">use </span><span class="n">source</span><span class="p">,</span>                         <span class="n">only</span><span class="p">:</span> <span class="n">add_source_term_residue</span>
<a name="ln-47"></a>
<a name="ln-48"></a>  <span class="k">use </span><span class="nb">time</span><span class="p">,</span>                           <span class="n">only</span> <span class="p">:</span> <span class="n">compute_time_step</span>
<a name="ln-49"></a>  <span class="c">!--- sst implicit update ---!</span>
<a name="ln-50"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sst_F1</span>
<a name="ln-51"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_k1</span>
<a name="ln-52"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_k2</span>
<a name="ln-53"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_w1</span>
<a name="ln-54"></a>  <span class="k">use </span><span class="n">global_sst</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_w2</span>
<a name="ln-55"></a>
<a name="ln-56"></a>  <span class="k">use </span><span class="n">plusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">update_with_plusgs</span>
<a name="ln-57"></a>  <span class="k">use </span><span class="n">plusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">setup_plusgs</span>
<a name="ln-58"></a>  <span class="k">use </span><span class="n">lusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">update_with_lusgs</span>
<a name="ln-59"></a>  <span class="k">use </span><span class="n">lusgs</span>     <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">setup_lusgs</span>
<a name="ln-60"></a><span class="cp">#include &quot;debug.h&quot;</span>
<a name="ln-61"></a><span class="cp">#include &quot;error.h&quot;</span>
<a name="ln-62"></a>    <span class="k">private</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">U_store</span>
<a name="ln-65"></a>    <span class="c">!&lt; Array to store the intermediate solution</span>
<a name="ln-66"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">R_store</span>
<a name="ln-67"></a>    <span class="c">!&lt; Array to store the intermediate Residue</span>
<a name="ln-68"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">aux</span>
<a name="ln-69"></a>    <span class="c">!&lt; Array to store some auxilary intermediate variables</span>
<a name="ln-70"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span>      <span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u1</span>
<a name="ln-71"></a>    <span class="c">!&lt; Variable array old for each cell center</span>
<a name="ln-72"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span>      <span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u2</span>
<a name="ln-73"></a>    <span class="c">!&lt; Variable array new for each cell center</span>
<a name="ln-74"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span>      <span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">R</span>
<a name="ln-75"></a>    <span class="c">!&lt; Residue array for each cell center</span>
<a name="ln-76"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imx</span><span class="p">,</span> <span class="n">jmx</span><span class="p">,</span> <span class="n">kmx</span><span class="p">,</span> <span class="n">n_var</span>
<a name="ln-77"></a>
<a name="ln-78"></a>    <span class="c">! Public methods</span>
<a name="ln-79"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">setup_update</span>
<a name="ln-80"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">get_next_solution</span>
<a name="ln-81"></a>
<a name="ln-82"></a>    <span class="k">contains</span>
<a name="ln-83"></a>
<a name="ln-84"></a>
<a name="ln-85"></a><span class="k">      subroutine </span><span class="n">setup_update</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span><span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-86"></a>        <span class="c">!&lt; Allocate memory to variables required based </span>
<a name="ln-87"></a>        <span class="c">!&lt; on the time-integration scheme.</span>
<a name="ln-88"></a>        <span class="k">implicit none</span>
<a name="ln-89"></a><span class="k">        type</span><span class="p">(</span><span class="n">controltype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">control</span>
<a name="ln-90"></a>        <span class="c">!&lt; Control parameters</span>
<a name="ln-91"></a>        <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-92"></a>        <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-93"></a>        <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-94"></a>        <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-95"></a>        <span class="k">type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-96"></a>        <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-97"></a>
<a name="ln-98"></a>        <span class="n">imx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">imx</span>
<a name="ln-99"></a>        <span class="n">jmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">jmx</span>
<a name="ln-100"></a>        <span class="n">kmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">kmx</span>
<a name="ln-101"></a>
<a name="ln-102"></a>        <span class="n">n_var</span> <span class="o">=</span> <span class="n">control</span><span class="p">%</span><span class="n">n_var</span>
<a name="ln-103"></a>
<a name="ln-104"></a>        <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-105"></a>        <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">u2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-106"></a>        <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">R</span> <span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-107"></a>        <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-108"></a>
<a name="ln-109"></a>        <span class="k">select case</span> <span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">time_step_accuracy</span><span class="p">)</span>
<a name="ln-110"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a name="ln-111"></a>            <span class="c">! Do nothing</span>
<a name="ln-112"></a>            <span class="k">continue</span>
<a name="ln-113"></a><span class="k">          case</span> <span class="p">(</span><span class="s2">&quot;RK2&quot;</span><span class="p">,</span> <span class="s2">&quot;RK4&quot;</span><span class="p">)</span>
<a name="ln-114"></a>            <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">U_store</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-115"></a>            <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">R_store</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-116"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;TVDRK2&quot;</span><span class="p">,</span> <span class="s2">&quot;TVDRK3&quot;</span><span class="p">)</span>
<a name="ln-117"></a>            <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">U_store</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-118"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;implicit&quot;</span><span class="p">)</span>
<a name="ln-119"></a>            <span class="k">call </span><span class="n">setup_lusgs</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-120"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;plusgs&quot;</span><span class="p">)</span>
<a name="ln-121"></a>            <span class="k">call </span><span class="n">setup_plusgs</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-122"></a>          <span class="k">case </span><span class="n">default</span>
<a name="ln-123"></a>            <span class="n">Fatal_error</span>
<a name="ln-124"></a>        <span class="k">end select</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="k">      end subroutine </span><span class="n">setup_update</span>
<a name="ln-127"></a>
<a name="ln-128"></a>
<a name="ln-129"></a>    <span class="k">subroutine </span><span class="n">get_next_solution</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-130"></a>        <span class="c">!&lt; Get solution at next time-step using scheme</span>
<a name="ln-131"></a>        <span class="c">!&lt; given in the input file.</span>
<a name="ln-132"></a>        <span class="k">implicit none</span>
<a name="ln-133"></a><span class="k">        type</span><span class="p">(</span><span class="n">controltype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">control</span>
<a name="ln-134"></a>        <span class="c">!&lt; Control parameters</span>
<a name="ln-135"></a>        <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-136"></a>        <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-137"></a>        <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-138"></a>        <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-139"></a>        <span class="k">type</span><span class="p">(</span><span class="n">boundarytype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bc</span>
<a name="ln-140"></a>        <span class="c">!&lt; boundary conditions and fixed values</span>
<a name="ln-141"></a>        <span class="k">type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-142"></a>        <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-143"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="kd">::</span> <span class="n">qp</span>
<a name="ln-144"></a>        <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-145"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="kd">::</span> <span class="n">Temp</span>
<a name="ln-146"></a>        <span class="c">!&lt; Store Temperature variable at cell center</span>
<a name="ln-147"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">residue</span>
<a name="ln-148"></a>        <span class="c">!&lt; Store residue at each cell-center</span>
<a name="ln-149"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">delta_t</span>
<a name="ln-150"></a>        <span class="c">!&lt; Local time increment value at each cell center</span>
<a name="ln-151"></a>        <span class="c">!&lt; Store residue at each cell-center</span>
<a name="ln-152"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span>
<a name="ln-153"></a>        <span class="c">!&lt; Store fluxes throught the I faces</span>
<a name="ln-154"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">G</span>
<a name="ln-155"></a>        <span class="c">!&lt; Store fluxes throught the J faces</span>
<a name="ln-156"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span>
<a name="ln-157"></a>        <span class="c">!&lt; Store fluxes throught the K faces</span>
<a name="ln-158"></a>        <span class="k">type</span><span class="p">(</span><span class="n">celltype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cells</span>
<a name="ln-159"></a>        <span class="c">!&lt; Input cell quantities: volume</span>
<a name="ln-160"></a>        <span class="k">type</span><span class="p">(</span><span class="n">facetype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ifaces</span>
<a name="ln-161"></a>        <span class="c">!&lt; Store face quantites for I faces </span>
<a name="ln-162"></a>        <span class="k">type</span><span class="p">(</span><span class="n">facetype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Jfaces</span>
<a name="ln-163"></a>        <span class="c">!&lt; Store face quantites for J faces </span>
<a name="ln-164"></a>        <span class="k">type</span><span class="p">(</span><span class="n">facetype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Kfaces</span>
<a name="ln-165"></a>        <span class="c">!&lt; Store face quantites for K faces </span>
<a name="ln-166"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CFL</span> 
<a name="ln-167"></a>        <span class="n">CFL</span> <span class="o">=</span> <span class="n">control</span><span class="p">%</span><span class="n">CFL</span>
<a name="ln-168"></a>        <span class="c">!finding the updated Temperature using ideal gas law</span>
<a name="ln-169"></a>        <span class="c">!T=P/(R_gas*Rho)</span>
<a name="ln-170"></a>        <span class="n">Temp</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(:,:,:,</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">R_gas</span><span class="o">*</span><span class="n">qp</span><span class="p">(:,:,:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-171"></a>        <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">time_step_accuracy</span><span class="p">))</span>
<a name="ln-172"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a name="ln-173"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-174"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">CFL</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-175"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.</span> <span class="p">,</span><span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span> 
<a name="ln-176"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;RK4&quot;</span><span class="p">)</span>
<a name="ln-177"></a>              <span class="n">R_store</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-178"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-179"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-180"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">CFL</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-181"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-182"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-183"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-184"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-185"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-186"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-187"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-188"></a>            <span class="k">case</span><span class="p">(</span><span class="s2">&quot;RK2&quot;</span><span class="p">)</span>
<a name="ln-189"></a>              <span class="n">R_store</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-190"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-191"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-192"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">CFL</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-193"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-194"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-195"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">R_store</span><span class="p">,</span> <span class="n">U_store</span><span class="p">)</span> 
<a name="ln-196"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;TVDRK3&quot;</span><span class="p">)</span>
<a name="ln-197"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-198"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-199"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">CFL</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-200"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-201"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-202"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-203"></a>              <span class="n">qp</span> <span class="o">=</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">U_store</span> <span class="o">+</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">qp</span>
<a name="ln-204"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-205"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-206"></a>              <span class="n">qp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">U_store</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">qp</span>
<a name="ln-207"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;TVDRK2&quot;</span><span class="p">)</span>
<a name="ln-208"></a>              <span class="n">U_store</span> <span class="o">=</span> <span class="n">qp</span>
<a name="ln-209"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-210"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">CFL</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-211"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-212"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-213"></a>              <span class="k">call </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="s2">&quot;conservative&quot;</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> 
<a name="ln-214"></a>              <span class="n">qp</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">U_store</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">qp</span>
<a name="ln-215"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;implicit&quot;</span><span class="p">)</span>
<a name="ln-216"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-217"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">CFL</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-218"></a>              <span class="k">call </span><span class="n">update_with_lusgs</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span><span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span><span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-219"></a>            <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;plusgs&quot;</span><span class="p">)</span>
<a name="ln-220"></a>              <span class="k">call </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-221"></a>              <span class="k">call </span><span class="n">compute_time_step</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">CFL</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span> <span class="c">! has to be after get_..._Residue()</span>
<a name="ln-222"></a>              <span class="k">call </span><span class="n">update_with_plusgs</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span><span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span><span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-223"></a>            <span class="k">case </span><span class="n">default</span>
<a name="ln-224"></a>              <span class="n">Fatal_error</span>
<a name="ln-225"></a>        <span class="k">end select</span>
<a name="ln-226"></a><span class="k">      end subroutine </span><span class="n">get_next_solution</span>
<a name="ln-227"></a>
<a name="ln-228"></a>      <span class="k">subroutine </span><span class="n">update_with</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="k">type</span><span class="p">,</span> <span class="n">time_factor</span><span class="p">,</span> <span class="n">store_factor</span><span class="p">,</span> <span class="k">use</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="n">un</span><span class="p">)</span>
<a name="ln-229"></a>        <span class="c">!&lt; A generalized scheme to updat the solution explicitly using</span>
<a name="ln-230"></a>        <span class="c">!&lt; any RK method and even first order euler explicit.</span>
<a name="ln-231"></a>        <span class="k">implicit none</span>
<a name="ln-232"></a><span class="k">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span><span class="kd">::</span> <span class="n">qp</span>
<a name="ln-233"></a>        <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-234"></a>        <span class="k">type</span><span class="p">(</span><span class="n">celltype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cells</span>
<a name="ln-235"></a>        <span class="c">!&lt; Cell center quantities: volume</span>
<a name="ln-236"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">delta_t</span>
<a name="ln-237"></a>        <span class="c">!&lt; Local time increment value at each cell center</span>
<a name="ln-238"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">residue</span>
<a name="ln-239"></a>        <span class="c">!&lt; Store residue at each cell-center</span>
<a name="ln-240"></a>        <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-241"></a>        <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-242"></a>        <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-243"></a>        <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-244"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="k">type</span>
<a name="ln-245"></a><span class="k">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">time_factor</span> <span class="c">! time factor</span>
<a name="ln-246"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">store_factor</span>
<a name="ln-247"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="k">use</span>
<a name="ln-248"></a><span class="k">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">un</span>
<a name="ln-249"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">Rn</span>
<a name="ln-250"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">TF</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c">!time factor</span>
<a name="ln-251"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">SF</span> <span class="o">=</span> <span class="mf">1.0</span><span class="c">!store factor</span>
<a name="ln-252"></a>        <span class="kt">Logical</span>               <span class="kd">::</span> <span class="n">TU</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!to use or not</span>
<a name="ln-253"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:,:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">Quse</span>
<a name="ln-254"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-255"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">KE</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-256"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">beta</span>
<a name="ln-257"></a>
<a name="ln-258"></a>        <span class="c">!sa variables</span>
<a name="ln-259"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vort</span>
<a name="ln-260"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fv1</span>
<a name="ln-261"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fv2</span>
<a name="ln-262"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fw</span>
<a name="ln-263"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g</span>
<a name="ln-264"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scap</span>
<a name="ln-265"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rsa</span>
<a name="ln-266"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kd2</span>
<a name="ln-267"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xi</span> 
<a name="ln-268"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mass_residue</span>
<a name="ln-269"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x_mom_residue</span><span class="p">,</span> <span class="n">y_mom_residue</span><span class="p">,</span> <span class="n">z_mom_residue</span>
<a name="ln-270"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">energy_residue</span>
<a name="ln-271"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TKE_residue</span><span class="p">,</span> <span class="n">Omega_residue</span><span class="p">,</span> <span class="n">kl_residue</span>
<a name="ln-272"></a>
<a name="ln-273"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">time_factor</span><span class="p">))</span> <span class="n">TF</span><span class="o">=</span><span class="n">time_factor</span>
<a name="ln-274"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">store_factor</span><span class="p">))</span> <span class="n">SF</span><span class="o">=</span><span class="n">store_factor</span>
<a name="ln-275"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="k">use</span><span class="p">))</span> <span class="n">TU</span><span class="o">=</span><span class="k">use</span>
<a name="ln-276"></a>        <span class="c">!check if user want to update from particular solution</span>
<a name="ln-277"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">un</span><span class="p">))</span><span class="k">then</span>
<a name="ln-278"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">un</span><span class="p">(:,:,:,:)</span>
<a name="ln-279"></a>        <span class="k">else</span>
<a name="ln-280"></a><span class="k">          </span><span class="n">Quse</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">=&gt;</span><span class="n">qp</span><span class="p">(:,:,:,:)</span>
<a name="ln-281"></a>        <span class="k">end if</span>
<a name="ln-282"></a>
<a name="ln-283"></a><span class="k">        select case</span><span class="p">(</span><span class="k">type</span><span class="p">)</span>
<a name="ln-284"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;primitive&#39;</span><span class="p">)</span>
<a name="ln-285"></a>
<a name="ln-286"></a>            <span class="c">!update primitive variable</span>
<a name="ln-287"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-288"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-289"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-290"></a>
<a name="ln-291"></a>                  <span class="n">mass_residue</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-292"></a>                  <span class="n">x_mom_residue</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-293"></a>                  <span class="n">y_mom_residue</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-294"></a>                  <span class="n">z_mom_residue</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-295"></a>                  <span class="n">energy_residue</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-296"></a>            
<a name="ln-297"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-298"></a>            
<a name="ln-299"></a>                  <span class="c">! finding primitive residue</span>
<a name="ln-300"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mass_residue</span>
<a name="ln-301"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span> <span class="o">+</span> <span class="n">x_mom_residue</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-302"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span> <span class="o">+</span> <span class="n">y_mom_residue</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-303"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span> <span class="o">+</span> <span class="n">z_mom_residue</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-304"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-305"></a>                         <span class="o">-</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x_mom_residue</span>               <span class="p">&amp;</span>
<a name="ln-306"></a>                         <span class="o">-</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">y_mom_residue</span>               <span class="p">&amp;</span>
<a name="ln-307"></a>                         <span class="o">-</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">z_mom_residue</span>               <span class="p">&amp;</span>
<a name="ln-308"></a>                         <span class="o">+</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">energy_residue</span>
<a name="ln-309"></a>            
<a name="ln-310"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">)</span>
<a name="ln-311"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-312"></a>                      <span class="c">!do nothing</span>
<a name="ln-313"></a>                      <span class="k">continue</span>
<a name="ln-314"></a><span class="k">                    case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-315"></a>                      <span class="n">TKE_residue</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-316"></a>                      <span class="n">omega_residue</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-317"></a>                      <span class="n">beta</span> <span class="o">=</span> <span class="n">beta1</span><span class="o">*</span><span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">beta2</span>
<a name="ln-318"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">TKE_residue</span>
<a name="ln-319"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">&amp;</span>
<a name="ln-320"></a>                             <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">bstar</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">TKE_residue</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-321"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">&amp;</span>
<a name="ln-322"></a>                             <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">omega_residue</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-323"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-324"></a>                      <span class="n">TKE_residue</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-325"></a>                      <span class="n">kl_residue</span>  <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-326"></a>                      <span class="n">eta</span>  <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-327"></a>                      <span class="n">fphi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">cd1</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-328"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">TKE_residue</span>
<a name="ln-329"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">&amp;</span>
<a name="ln-330"></a>                             <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">((</span><span class="mf">2.5</span><span class="o">*</span><span class="p">((</span><span class="n">cmu</span><span class="o">**</span><span class="mf">0.75</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="mf">1.5</span><span class="p">)</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mf">1.e-20</span><span class="p">))&amp;</span>
<a name="ln-331"></a>                             <span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))))</span><span class="o">*</span><span class="n">TKE_residue</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-332"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">mass_residue</span><span class="p">&amp;</span>
<a name="ln-333"></a>                             <span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">fphi</span><span class="o">/</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">kl_residue</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-334"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-335"></a>                      <span class="n">Fatal_error</span>
<a name="ln-336"></a>                  <span class="k">end select</span>
<a name="ln-337"></a>            
<a name="ln-338"></a>                        
<a name="ln-339"></a>                 <span class="c">!check if user want to store residue</span>
<a name="ln-340"></a>                  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-341"></a><span class="k">                    </span><span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">+</span> <span class="n">SF</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-342"></a>                    <span class="k">if</span><span class="p">(</span><span class="n">TU</span><span class="p">)</span> <span class="n">R</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,:)</span>
<a name="ln-343"></a>                  <span class="k">end if</span>
<a name="ln-344"></a>                 
<a name="ln-345"></a>            
<a name="ln-346"></a>                 <span class="c">!update</span>
<a name="ln-347"></a>                 <span class="n">u2</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(:)</span> <span class="o">-</span> <span class="n">R</span><span class="p">(:)</span><span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">cells</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)%</span><span class="n">volume</span><span class="p">)</span>
<a name="ln-348"></a>            
<a name="ln-349"></a>                  <span class="c">!check solution for non pyhysical results</span>
<a name="ln-350"></a>                  <span class="k">if</span><span class="p">((</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span><span class="k">then</span>
<a name="ln-351"></a><span class="k">                    </span><span class="n">Fatal_error</span>
<a name="ln-352"></a>                  <span class="k">else</span> <span class="c">!update</span>
<a name="ln-353"></a>                    <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-354"></a>                    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-355"></a>                     <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-356"></a>                       <span class="k">if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-357"></a>                       <span class="k">if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-358"></a>                     <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-359"></a>                       <span class="c">! do nothing</span>
<a name="ln-360"></a>                       <span class="k">continue</span>
<a name="ln-361"></a><span class="k">                    end select</span>
<a name="ln-362"></a><span class="k">                  end if</span>
<a name="ln-363"></a><span class="k">                end do</span>
<a name="ln-364"></a><span class="k">              end do</span>
<a name="ln-365"></a><span class="k">            end do</span>
<a name="ln-366"></a><span class="k">            </span>
<a name="ln-367"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;conservative&#39;</span><span class="p">)</span>
<a name="ln-368"></a>            <span class="c">!include &quot;update_conservative.inc&quot;</span>
<a name="ln-369"></a>
<a name="ln-370"></a>            <span class="c">!update conservative variable</span>
<a name="ln-371"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-372"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-373"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-374"></a>
<a name="ln-375"></a>                  <span class="c">! getting conservative variable</span>
<a name="ln-376"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-377"></a>                  <span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span> <span class="o">=</span> <span class="n">Quse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">:)</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-378"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">)</span>
<a name="ln-379"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-380"></a>                      <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.0</span><span class="c">!u1(6)</span>
<a name="ln-381"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span><span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-382"></a>                      <span class="n">KE</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-383"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-384"></a>                      <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-385"></a>                  <span class="k">end select</span>
<a name="ln-386"></a><span class="k">                  </span><span class="n">u1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">KE</span>
<a name="ln-387"></a>
<a name="ln-388"></a>                 <span class="c">! get R</span>
<a name="ln-389"></a>                  <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> 
<a name="ln-390"></a>                  <span class="c">! point implicit destruction term</span>
<a name="ln-391"></a>                  <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-392"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-393"></a>                      <span class="c">!do nothing</span>
<a name="ln-394"></a>                      <span class="k">continue</span>
<a name="ln-395"></a><span class="k">                    case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-396"></a>                      <span class="n">beta</span> <span class="o">=</span> <span class="n">beta1</span><span class="o">*</span><span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">beta2</span>
<a name="ln-397"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-398"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-399"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-400"></a>                      <span class="n">eta</span>  <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-401"></a>                      <span class="n">fphi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">cd1</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-402"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">((</span><span class="mf">2.5</span><span class="o">*</span><span class="p">((</span><span class="n">cmu</span><span class="o">**</span><span class="mf">0.75</span><span class="p">)</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="mf">1.5</span><span class="p">)</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">u1</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mf">1.e-20</span><span class="p">))&amp;</span>
<a name="ln-403"></a>                             <span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
<a name="ln-404"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">fphi</span><span class="o">/</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-405"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-406"></a>                      <span class="n">vort</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span>     <span class="p">((</span><span class="n">gradw_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">-</span> <span class="n">gradv_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-407"></a>                                      <span class="o">+</span> <span class="p">(</span><span class="n">gradu_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">-</span> <span class="n">gradw_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-408"></a>                                      <span class="o">+</span> <span class="p">(</span><span class="n">gradv_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">-</span> <span class="n">gradu_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-409"></a>                                       <span class="p">)&amp;</span>
<a name="ln-410"></a>                                 <span class="p">)</span>
<a name="ln-411"></a>                      <span class="n">kd2</span>  <span class="o">=</span> <span class="p">(</span><span class="n">kappa_sa</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-412"></a>                      <span class="n">xi</span>   <span class="o">=</span> <span class="n">U1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-413"></a>                      <span class="n">fv1</span>  <span class="o">=</span> <span class="n">xi</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">xi</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">cv1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-414"></a>                      <span class="n">fv2</span>  <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">xi</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi</span><span class="o">*</span><span class="n">fv1</span><span class="p">)</span>
<a name="ln-415"></a>                      <span class="n">scap</span> <span class="o">=</span> <span class="n">vort</span> <span class="o">+</span> <span class="n">U1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">fv2</span><span class="o">/</span><span class="p">(</span><span class="n">kd2</span><span class="p">)</span>
<a name="ln-416"></a>                      <span class="n">rsa</span>    <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">U1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Scap</span><span class="o">*</span><span class="n">kd2</span><span class="p">),</span> <span class="mi">1</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-417"></a>                      <span class="n">g</span>    <span class="o">=</span> <span class="n">rsa</span> <span class="o">+</span> <span class="n">cw2</span><span class="o">*</span><span class="p">(</span><span class="n">rsa</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="n">rsa</span><span class="p">)</span>
<a name="ln-418"></a>                      <span class="n">fw</span>   <span class="o">=</span> <span class="n">g</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">cw3</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">g</span><span class="o">**</span><span class="mi">6</span><span class="o">+</span><span class="n">cw3</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">6.0</span><span class="p">)</span>
<a name="ln-419"></a>                      <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cb1</span><span class="o">*</span><span class="n">scap</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cw1</span><span class="o">*</span><span class="n">fw</span><span class="o">*</span><span class="n">u1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-420"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-421"></a>                      <span class="n">Fatal_error</span>
<a name="ln-422"></a>                  <span class="k">end select</span>
<a name="ln-423"></a>
<a name="ln-424"></a>                 <span class="c">!check if user want to store residue</span>
<a name="ln-425"></a>                 <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">Rn</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-426"></a><span class="k">                   </span><span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">+</span> <span class="n">SF</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span>
<a name="ln-427"></a>                   <span class="k">if</span><span class="p">(</span><span class="n">TU</span><span class="p">)</span> <span class="n">R</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">Rn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,:)</span>
<a name="ln-428"></a>                 <span class="k">end if</span>
<a name="ln-429"></a>
<a name="ln-430"></a>                 <span class="c">!update</span>
<a name="ln-431"></a>                 <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">=</span> <span class="n">u1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span> <span class="o">-</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n_var</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">TF</span><span class="o">*</span><span class="n">delta_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">cells</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)%</span><span class="n">volume</span><span class="p">)</span>
<a name="ln-432"></a>
<a name="ln-433"></a>                <span class="c">! getting primitve variable back variable</span>
<a name="ln-434"></a>                  <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-435"></a>                  <span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span><span class="o">/</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-436"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">)</span>
<a name="ln-437"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-438"></a>                      <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.0</span><span class="c">!u2(6)</span>
<a name="ln-439"></a>                    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-440"></a>                      <span class="c">!u2(6) = u2(6)*u2(1)</span>
<a name="ln-441"></a>                      <span class="n">KE</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-442"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-443"></a>                      <span class="n">KE</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-444"></a>                  <span class="k">end select</span>
<a name="ln-445"></a><span class="k">                  </span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">gm</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="n">KE</span><span class="p">)</span>
<a name="ln-446"></a>
<a name="ln-447"></a>                  <span class="c">!check solution for non pyhysical results</span>
<a name="ln-448"></a>                  <span class="k">if</span><span class="p">((</span><span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">u2</span><span class="p">)))</span><span class="k">then</span>
<a name="ln-449"></a><span class="k">                    print</span><span class="o">*</span><span class="p">,</span> <span class="n">u2</span><span class="p">(:)</span>
<a name="ln-450"></a>                    <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;R: &quot;</span><span class="p">,</span> <span class="n">R</span>
<a name="ln-451"></a>                    <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;old &quot;</span><span class="p">,</span> <span class="n">U1</span>
<a name="ln-452"></a>                    <span class="n">Fatal_error</span>
<a name="ln-453"></a>                  <span class="k">else</span> <span class="c">!update</span>
<a name="ln-454"></a>                    <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-455"></a>                    <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-456"></a>                     <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-457"></a>                       <span class="k">if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">&gt;=</span><span class="mf">0.</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-458"></a><span class="k">                         </span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-459"></a>                       <span class="k">else</span>
<a name="ln-460"></a>                       <span class="c">!  qp(i,j,k,6) = tk_inf</span>
<a name="ln-461"></a>                       <span class="c">!  qp(i,j,k,6) = (max(qp(i-1,j,k,6),0.) + max(qp(i+1,j,k,6),0.) &amp;</span>
<a name="ln-462"></a>                       <span class="c">!                +max(qp(i,j-1,k,6),0.) + max(qp(i,j+1,k,6),0.) &amp;</span>
<a name="ln-463"></a>                       <span class="c">!                )/4</span>
<a name="ln-464"></a>                       <span class="c">!  qp(i,j,k,6) = 1.e-3*maxval(qp(i-1:i+1,j-1:j+1,k-1:k+1,6))</span>
<a name="ln-465"></a>                       <span class="k">end if</span>
<a name="ln-466"></a><span class="k">                       if</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">&gt;=</span><span class="mf">0.</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-467"></a><span class="k">                        </span><span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">u2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-468"></a>                       <span class="k">else</span>
<a name="ln-469"></a>                       <span class="c">!  qp(i,j,k,7) = tkl_inf</span>
<a name="ln-470"></a>                       <span class="c">!  qp(i,j,k,7) = (max(qp(i-1,j,k,7),0.) + max(qp(i+1,j,k,7),0.) &amp;</span>
<a name="ln-471"></a>                       <span class="c">!                +max(qp(i,j-1,k,7),0.) + max(qp(i,j+1,k,7),0.) &amp;</span>
<a name="ln-472"></a>                       <span class="c">!                )/4</span>
<a name="ln-473"></a>                       <span class="k">end if</span>
<a name="ln-474"></a><span class="k">                     case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-475"></a>                       <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">u2</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mf">1.e-12</span><span class="p">)</span>
<a name="ln-476"></a>                     <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-477"></a>                       <span class="c">! do nothing</span>
<a name="ln-478"></a>                       <span class="k">continue</span>
<a name="ln-479"></a><span class="k">                    end select</span>
<a name="ln-480"></a><span class="k">                  end if</span>
<a name="ln-481"></a>                  <span class="c">!print*, i,j, R(1:n_var)</span>
<a name="ln-482"></a>
<a name="ln-483"></a>                <span class="k">end do</span>
<a name="ln-484"></a><span class="k">              end do</span>
<a name="ln-485"></a><span class="k">            end do</span>
<a name="ln-486"></a>
<a name="ln-487"></a><span class="k">          case </span><span class="n">DEFAULT</span>
<a name="ln-488"></a>            <span class="n">Fatal_error</span>
<a name="ln-489"></a>        <span class="k">end select</span>
<a name="ln-490"></a>
<a name="ln-491"></a><span class="k">      end subroutine </span><span class="n">update_with</span>
<a name="ln-492"></a>
<a name="ln-493"></a>
<a name="ln-494"></a>      <span class="c">!subroutine get_total_conservative_Residue(qp, Temp, residue, F,G,H, control, scheme, flow, dims)</span>
<a name="ln-495"></a>      <span class="k">subroutine </span><span class="n">get_total_conservative_Residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Temp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-496"></a>        <span class="c">!&lt; For each iteration it apply boundary conditions,</span>
<a name="ln-497"></a>        <span class="c">!&lt; use higher order method to reconstruct state at</span>
<a name="ln-498"></a>        <span class="c">!&lt; face, evalute fluxes at each face, calculate </span>
<a name="ln-499"></a>        <span class="c">!&lt; inviscid residual, and introuduce additional </span>
<a name="ln-500"></a>        <span class="c">!&lt; residual due to  viscosity, turbulence and source</span>
<a name="ln-501"></a>        <span class="c">!&lt; terms.</span>
<a name="ln-502"></a>        <span class="k">implicit none</span>
<a name="ln-503"></a><span class="k">        type</span><span class="p">(</span><span class="n">controltype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">control</span>
<a name="ln-504"></a>        <span class="c">!&lt; Control parameters</span>
<a name="ln-505"></a>        <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-506"></a>        <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-507"></a>        <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-508"></a>        <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-509"></a>        <span class="k">type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-510"></a>        <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-511"></a>        <span class="k">type</span><span class="p">(</span><span class="n">boundarytype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bc</span>
<a name="ln-512"></a>        <span class="c">!&lt; boundary conditions and fixed values</span>
<a name="ln-513"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="kd">::</span> <span class="n">qp</span>
<a name="ln-514"></a>        <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-515"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="kd">::</span> <span class="n">Temp</span>
<a name="ln-516"></a>        <span class="c">!&lt; Store Temperature variable at cell center</span>
<a name="ln-517"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">residue</span>
<a name="ln-518"></a>        <span class="c">!&lt; Store residue at each cell-center</span>
<a name="ln-519"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span>
<a name="ln-520"></a>        <span class="c">!&lt; Store fluxes throught the I faces</span>
<a name="ln-521"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">G</span>
<a name="ln-522"></a>        <span class="c">!&lt; Store fluxes throught the J faces</span>
<a name="ln-523"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span>
<a name="ln-524"></a>        <span class="c">!&lt; Store fluxes throught the K faces</span>
<a name="ln-525"></a>        <span class="k">type</span><span class="p">(</span><span class="n">celltype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cells</span>
<a name="ln-526"></a>        <span class="c">!&lt; Input cell quantities: volume</span>
<a name="ln-527"></a>        <span class="k">type</span><span class="p">(</span><span class="n">facetype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ifaces</span>
<a name="ln-528"></a>        <span class="c">!&lt; Input varaible which stores I faces&#39; area and unit normal</span>
<a name="ln-529"></a>        <span class="k">type</span><span class="p">(</span><span class="n">facetype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Jfaces</span>
<a name="ln-530"></a>        <span class="c">!&lt; Input varaible which stores J faces&#39; area and unit normal</span>
<a name="ln-531"></a>        <span class="k">type</span><span class="p">(</span><span class="n">facetype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Kfaces</span>
<a name="ln-532"></a>        <span class="c">!&lt; Input varaible which stores K faces&#39; area and unit normal</span>
<a name="ln-533"></a>
<a name="ln-534"></a>        <span class="k">call </span><span class="n">apply_interface</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-535"></a>        <span class="k">call </span><span class="n">populate_ghost_primitive</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span> <span class="n">Jfaces</span><span class="p">,</span> <span class="n">Kfaces</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-536"></a>        <span class="k">call </span><span class="n">compute_face_interpolant</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-537"></a>        <span class="k">call </span><span class="n">reconstruct_boundary_state</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-538"></a>        <span class="k">call </span><span class="n">compute_fluxes</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span><span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-539"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span> <span class="o">/=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-540"></a><span class="k">          call </span><span class="n">evaluate_all_gradients</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">cells</span><span class="p">,</span><span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span><span class="n">scheme</span><span class="p">,</span><span class="n">bc</span><span class="p">,</span><span class="n">dims</span><span class="p">)</span>
<a name="ln-541"></a>          <span class="k">call </span><span class="n">calculate_viscosity</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-542"></a>          <span class="k">call </span><span class="n">compute_viscous_fluxes</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">qp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span><span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-543"></a>        <span class="k">end if</span>
<a name="ln-544"></a><span class="k">        call </span><span class="n">compute_residue</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">dims</span><span class="p">)</span>
<a name="ln-545"></a>        <span class="k">call </span><span class="n">add_source_term_residue</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">Ifaces</span><span class="p">,</span><span class="n">Jfaces</span><span class="p">,</span><span class="n">Kfaces</span><span class="p">,</span><span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-546"></a>
<a name="ln-547"></a>      <span class="k">end subroutine </span><span class="n">get_total_conservative_Residue</span>
<a name="ln-548"></a>
<a name="ln-549"></a><span class="k">end module </span><span class="n">update</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-02-10T20:32:54.471560 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST-3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>