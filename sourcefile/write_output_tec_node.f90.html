<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST-3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>write_output_tec_node.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140495700-1"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
   
     gtag('config', 'UA-140495700-1');
   </script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>write_output_tec_node.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.3% of total for source files.">201 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/write_output_tec_node.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">write_output_tec_node.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/write_output_tec_node.html">write_output_tec_node</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/write_output_tec_node.f90.html#src">write_output_tec_node.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>Writing solution in the output file in tecplot format with
 node data instead of cell-center data.</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~write_output_tec_node.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilewrite_output_tec_nodef90EfferentGraph" width="475pt" height="381pt"
 viewBox="0.00 0.00 475.00 380.59" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 376.5888)">
<title>sourcefile~~write_output_tec_node.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-376.5888 471,-376.5888 471,4 -4,4"/>
<!-- sourcefile~write_output_tec_node.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~write_output_tec_node.f90</title>
<polygon fill="none" stroke="#000000" points="467,-188.943 328,-188.943 328,-164.943 467,-164.943 467,-188.943"/>
<text text-anchor="middle" x="397.5" y="-174.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">write_output_tec_node.f90</text>
</g>
<!-- sourcefile~vartypes.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~vartypes.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/vartypes.f90.html" xlink:title="vartypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-289.943 0,-289.943 0,-265.943 71,-265.943 71,-289.943"/>
<text text-anchor="middle" x="35.5" y="-275.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vartypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257,-359.943C194.3114,-384.1484 168.245,-368.5981 107,-340.943 85.1174,-331.062 65.0672,-312.1377 51.8042,-297.5988"/>
<polygon fill="#ff0000" stroke="#ff0000" points="54.4004,-295.2511 45.1656,-290.058 49.1464,-299.8766 54.4004,-295.2511"/>
</g>
<!-- sourcefile~viscosity.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~viscosity.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/viscosity.f90.html" xlink:title="viscosity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="292,-188.943 222,-188.943 222,-164.943 292,-164.943 292,-188.943"/>
<text text-anchor="middle" x="257" y="-174.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">viscosity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M327.6616,-176.943C319.1378,-176.943 310.606,-176.943 302.568,-176.943"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.328,-173.4431 292.328,-176.943 302.3279,-180.4431 302.328,-173.4431"/>
</g>
<!-- sourcefile~wall_dist.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~wall_dist.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/wall_dist.f90.html" xlink:title="wall_dist.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="182,-331.943 111,-331.943 111,-307.943 182,-307.943 182,-331.943"/>
<text text-anchor="middle" x="146.5" y="-317.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wall_dist.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M393.3107,-189.0968C380.1647,-224.922 335.8421,-329.5005 257,-359.943"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257,-359.943C242.3582,-365.5966 205.4017,-350.0057 178.2423,-336.6647"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.6048,-333.4325 169.0969,-332.0781 176.4667,-339.6897 179.6048,-333.4325"/>
</g>
<!-- sourcefile~utils.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~utils.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/utils.f90.html" xlink:title="utils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="62.5,-107.943 8.5,-107.943 8.5,-83.943 62.5,-83.943 62.5,-107.943"/>
<text text-anchor="middle" x="35.5" y="-93.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390.3158,-164.5815C372.3584,-135.0942 322.2368,-61.0715 257,-33.943"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257,-33.943C194.8433,-8.0954 168.193,15.11 107,-12.943 79.3883,-25.6012 58.4005,-54.7689 46.5183,-74.9205"/>
<polygon fill="#ff0000" stroke="#ff0000" points="43.4232,-73.2838 41.5679,-83.715 49.5232,-76.7175 43.4232,-73.2838"/>
</g>
<!-- sourcefile~global_sst.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~global_sst.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/global_sst.f90.html" xlink:title="global_sst.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="186,-45.943 107,-45.943 107,-21.943 186,-21.943 186,-45.943"/>
<text text-anchor="middle" x="146.5" y="-31.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_sst.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257,-33.943C238.0694,-26.0708 215.6869,-24.7714 196.0338,-25.9288"/>
<polygon fill="#ff0000" stroke="#ff0000" points="195.7237,-22.4424 186.038,-26.7362 196.2873,-29.4196 195.7237,-22.4424"/>
</g>
<!-- sourcefile~gradients.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~gradients.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/gradients.f90.html" xlink:title="gradients.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="184,-87.943 109,-87.943 109,-63.943 184,-63.943 184,-87.943"/>
<text text-anchor="middle" x="146.5" y="-73.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">gradients.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257,-33.943C249.7114,-30.9121 211.274,-46.6934 181.7594,-59.7702"/>
<polygon fill="#ff0000" stroke="#ff0000" points="180.2404,-56.6155 172.5411,-63.8936 183.0987,-63.0053 180.2404,-56.6155"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M238.4704,-189.0196C224.4031,-197.9104 204.4062,-209.9632 186,-218.943 151.4053,-235.8208 110.6796,-251.5492 80.3227,-262.5151"/>
<polygon fill="#ffff00" stroke="#ffff00" points="79.0883,-259.2394 70.8518,-265.9035 81.4464,-265.8303 79.0883,-259.2394"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M252.5517,-189.1438C243.367,-212.9132 220.2568,-265.9775 186,-298.943 184.9157,-299.9864 183.7693,-300.9922 182.5764,-301.96"/>
<polygon fill="#ffff00" stroke="#ffff00" points="180.4024,-299.2088 174.194,-307.794 184.4011,-304.9543 180.4024,-299.2088"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M239.6338,-164.7882C225.6864,-155.4997 205.3085,-142.9674 186,-134.943 148.7151,-119.4479 103.616,-108.745 72.5659,-102.5246"/>
<polygon fill="#ffff00" stroke="#ffff00" points="73.0905,-99.0611 62.606,-100.5865 71.7533,-105.9322 73.0905,-99.0611"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M252.5517,-164.7423C243.367,-140.9729 220.2568,-87.9086 186,-54.943 184.9157,-53.8996 183.7693,-52.8939 182.5764,-51.9261"/>
<polygon fill="#ffff00" stroke="#ffff00" points="184.4011,-48.9318 174.194,-46.0921 180.4024,-54.6773 184.4011,-48.9318"/>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M246.947,-164.6864C233.841,-149.1126 209.7751,-121.8656 186,-101.943 182.6727,-99.1549 179.0349,-96.4094 175.3566,-93.8078"/>
<polygon fill="#ffff00" stroke="#ffff00" points="177.0736,-90.7439 166.8279,-88.0462 173.1551,-96.5444 177.0736,-90.7439"/>
</g>
<!-- sourcefile~copy_bc.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~copy_bc.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/copy_bc.f90.html" xlink:title="copy_bc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="181.5,-289.943 111.5,-289.943 111.5,-265.943 181.5,-265.943 181.5,-289.943"/>
<text text-anchor="middle" x="146.5" y="-275.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">copy_bc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~copy_bc.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~copy_bc.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M246.947,-189.1997C233.841,-204.7735 209.7751,-232.0205 186,-251.943 182.6727,-254.7311 179.0349,-257.4767 175.3566,-260.0783"/>
<polygon fill="#ffff00" stroke="#ffff00" points="173.1551,-257.3417 166.8279,-265.8398 177.0736,-263.1422 173.1551,-257.3417"/>
</g>
<!-- sourcefile~global_sa.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~global_sa.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/global_sa.f90.html" xlink:title="global_sa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="184.5,-167.943 108.5,-167.943 108.5,-143.943 184.5,-143.943 184.5,-167.943"/>
<text text-anchor="middle" x="146.5" y="-153.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_sa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M221.7333,-170.2408C213.1976,-168.6186 203.9266,-166.8567 194.9029,-165.1418"/>
<polygon fill="#ffff00" stroke="#ffff00" points="195.3502,-161.6642 184.8725,-163.2356 194.0432,-168.5411 195.3502,-161.6642"/>
</g>
<!-- sourcefile~global_kkl.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~global_kkl.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/global_kkl.f90.html" xlink:title="global_kkl.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="185.5,-209.943 107.5,-209.943 107.5,-185.943 185.5,-185.943 185.5,-209.943"/>
<text text-anchor="middle" x="146.5" y="-195.543" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_kkl.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M221.7333,-183.6453C213.3812,-185.2326 204.325,-186.9537 195.4854,-188.6336"/>
<polygon fill="#ffff00" stroke="#ffff00" points="194.8172,-185.1979 185.6465,-190.5034 196.1241,-192.0748 194.8172,-185.1979"/>
</g>
<!-- sourcefile~wall_dist.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~wall_dist.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M114.6919,-307.9075C102.8482,-303.4261 89.2325,-298.2743 76.6686,-293.5204"/>
<polygon fill="#00ff00" stroke="#00ff00" points="77.9043,-290.2458 67.3128,-289.9803 75.427,-296.7928 77.9043,-290.2458"/>
</g>
<!-- sourcefile~wall_dist.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~wall_dist.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M117.4358,-307.8169C113.5717,-305.3035 109.9376,-302.358 107,-298.943 60.449,-244.8282 43.5578,-158.432 37.9829,-118.0698"/>
<polygon fill="#00ff00" stroke="#00ff00" points="41.4321,-117.4484 36.6953,-107.9714 34.4883,-118.3338 41.4321,-117.4484"/>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M137.5528,-88.3086C129.2211,-100.0478 116.6681,-118.3206 107,-134.943 82.6393,-176.8266 58.2558,-228.0809 45.2076,-256.452"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="41.9047,-255.259 40.9342,-265.8093 48.2721,-258.167 41.9047,-255.259"/>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M108.9205,-82.7141C97.1484,-84.8352 84.1713,-87.1734 72.4435,-89.2865"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="71.7414,-85.8566 62.5206,-91.0745 72.9828,-92.7457 71.7414,-85.8566"/>
</g>
<!-- sourcefile~copy_bc.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~copy_bc.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M111.3789,-277.943C101.8567,-277.943 91.405,-277.943 81.3847,-277.943"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.1556,-274.4431 71.1556,-277.943 81.1555,-281.4431 81.1556,-274.4431"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~write_output_tec_node.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilewrite_output_tec_nodef90AfferentGraph" width="593pt" height="32pt"
 viewBox="0.00 0.00 593.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~write_output_tec_node.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 589,-28 589,4 -4,4"/>
<!-- sourcefile~write_output_tec_node.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~write_output_tec_node.f90</title>
<polygon fill="none" stroke="#000000" points="139,-24 0,-24 0,0 139,0 139,-24"/>
<text text-anchor="middle" x="69.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">write_output_tec_node.f90</text>
</g>
<!-- sourcefile~write_output.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~write_output.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/write_output.f90.html" xlink:title="write_output.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="264,-24 175,-24 175,0 264,0 264,-24"/>
<text text-anchor="middle" x="219.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec_node.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec_node.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M174.9012,-12C166.832,-12 158.1976,-12 149.4732,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="149.2185,-8.5001 139.2184,-12 149.2184,-15.5001 149.2185,-8.5001"/>
</g>
<!-- sourcefile~dump_solution.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~dump_solution.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/dump_solution.f90.html" xlink:title="dump_solution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="400,-24 300,-24 300,0 400,0 400,-24"/>
<text text-anchor="middle" x="350" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dump_solution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dump_solution.f90&#45;&gt;sourcefile~write_output.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~dump_solution.f90&#45;&gt;sourcefile~write_output.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M299.9185,-12C291.538,-12 282.804,-12 274.3121,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="274.1141,-8.5001 264.1141,-12 274.1141,-15.5001 274.1141,-8.5001"/>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="495,-24 436,-24 436,0 495,0 495,-24"/>
<text text-anchor="middle" x="465.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~dump_solution.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~dump_solution.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M435.7559,-12C427.9733,-12 419.2953,-12 410.5317,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="410.2532,-8.5001 400.2531,-12 410.2531,-15.5001 410.2532,-8.5001"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~write_output_tec_node.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="585,-24 531,-24 531,0 585,0 585,-24"/>
<text text-anchor="middle" x="558" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~write_output_tec_node.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M530.7472,-12C522.791,-12 513.9269,-12 505.361,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="505.1413,-8.5001 495.1413,-12 505.1413,-15.5001 505.1413,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/write_output_tec_node.html">write_output_tec_node</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/write_output_tec_node.f90.html#src">write_output_tec_node.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>  <span class="c">!&lt; Writing solution in the output file in tecplot format with</span>
<a name="ln-2"></a>  <span class="c">!&lt; node data instead of cell-center data.</span>
<a name="ln-3"></a><span class="k">module </span><span class="n">write_output_tec_node</span>
<a name="ln-4"></a>  <span class="c">!&lt; Writing solution in the output file in tecplot format with</span>
<a name="ln-5"></a>  <span class="c">!&lt; node data instead of cell-center data.</span>
<a name="ln-6"></a>  <span class="c">!---------------------------------------------------------</span>
<a name="ln-7"></a>  <span class="c">! This module write state + other variable in output file</span>
<a name="ln-8"></a>  <span class="c">!---------------------------------------------------------</span>
<a name="ln-9"></a><span class="cp">#include &quot;../../debug.h&quot;</span>
<a name="ln-10"></a><span class="cp">#include &quot;../../error.h&quot;</span>
<a name="ln-11"></a>  <span class="k">use </span><span class="n">vartypes</span>
<a name="ln-12"></a>  <span class="k">use </span><span class="n">viscosity</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mu</span> 
<a name="ln-13"></a>  <span class="k">use </span><span class="n">viscosity</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">mu_t</span> 
<a name="ln-14"></a>  <span class="k">use </span><span class="n">wall_dist</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dist</span>
<a name="ln-15"></a>  <span class="k">use </span><span class="n">global_sst</span> <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sst_F1</span>
<a name="ln-16"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradu_x</span>
<a name="ln-17"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradu_y</span>
<a name="ln-18"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradu_z</span>
<a name="ln-19"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradv_x</span>
<a name="ln-20"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradv_y</span>
<a name="ln-21"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradv_z</span>
<a name="ln-22"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradw_x</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradw_y</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradw_z</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradT_x</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradT_y</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradT_z</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtk_x</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtk_y</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtk_z</span>
<a name="ln-31"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtw_x</span>
<a name="ln-32"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtw_y</span>
<a name="ln-33"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtw_z</span>
<a name="ln-34"></a>
<a name="ln-35"></a>  <span class="k">use </span><span class="n">utils</span>
<a name="ln-36"></a>
<a name="ln-37"></a>  <span class="k">implicit none</span>
<a name="ln-38"></a><span class="k">  private</span>
<a name="ln-39"></a><span class="k">  </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">OUT_FILE_UNIT</span>
<a name="ln-40"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-41"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="k">format</span><span class="o">=</span><span class="s2">&quot;(35e25.15)&quot;</span>
<a name="ln-42"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imx</span><span class="p">,</span> <span class="n">jmx</span><span class="p">,</span> <span class="n">kmx</span>
<a name="ln-43"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">density</span>      
<a name="ln-44"></a>   <span class="c">!&lt; Rho pointer, point to slice of qp (:,:,:,1)</span>
<a name="ln-45"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">x_speed</span>      
<a name="ln-46"></a>   <span class="c">!&lt; U pointer, point to slice of qp (:,:,:,2) </span>
<a name="ln-47"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">y_speed</span>      
<a name="ln-48"></a>   <span class="c">!&lt; V pointer, point to slice of qp (:,:,:,3) </span>
<a name="ln-49"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">z_speed</span>      
<a name="ln-50"></a>   <span class="c">!&lt; W pointer, point to slice of qp (:,:,:,4)</span>
<a name="ln-51"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pressure</span>     
<a name="ln-52"></a>   <span class="c">!&lt; P pointer, point to slice of qp (:,:,:,5)</span>
<a name="ln-53"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">tk</span>        
<a name="ln-54"></a>  <span class="c">!&lt; TKE, point to slice of qp (:,:,:,6)</span>
<a name="ln-55"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">tw</span>        
<a name="ln-56"></a>  <span class="c">!&lt; Omega, point to slice of qp (:,:,:,7)</span>
<a name="ln-57"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">te</span>        
<a name="ln-58"></a>  <span class="c">!&lt; Dissipation, point to slice of qp (:,:,:,7)</span>
<a name="ln-59"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">tv</span>        
<a name="ln-60"></a>  <span class="c">!&lt; SA visocity, point to slice of qp (:,:,:,6)</span>
<a name="ln-61"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">tkl</span>       
<a name="ln-62"></a>  <span class="c">!&lt; KL K-KL method, point to slice of qp (:,:,:,7)</span>
<a name="ln-63"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">tgm</span>       
<a name="ln-64"></a>  <span class="c">!&lt; Intermittency of LCTM2015, point to slice of qp (:,:,:,8)</span>
<a name="ln-65"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">write_file</span>
<a name="ln-66"></a>
<a name="ln-67"></a>  <span class="k">contains</span>
<a name="ln-68"></a>
<a name="ln-69"></a><span class="k">    subroutine </span><span class="n">write_file</span><span class="p">(</span><span class="n">file_handler</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-70"></a>      <span class="c">!&lt; Write output file in the tecplot format with node data</span>
<a name="ln-71"></a>      <span class="k">implicit none</span>
<a name="ln-72"></a><span class="k">      </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">file_handler</span>
<a name="ln-73"></a>      <span class="k">type</span><span class="p">(</span><span class="n">controltype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">control</span>
<a name="ln-74"></a>      <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-75"></a>      <span class="k">type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-76"></a>      <span class="k">type</span><span class="p">(</span><span class="n">nodetype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nodes</span> 
<a name="ln-77"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">state</span>
<a name="ln-78"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-79"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">err</span><span class="o">=</span><span class="s2">&quot;Write error: Asked to write non-existing variable- &quot;</span>
<a name="ln-80"></a>
<a name="ln-81"></a>      <span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;write_file&quot;</span><span class="p">)</span>
<a name="ln-82"></a>      
<a name="ln-83"></a>      <span class="n">OUT_FILE_UNIT</span> <span class="o">=</span> <span class="n">file_handler</span>
<a name="ln-84"></a>
<a name="ln-85"></a>      <span class="n">imx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">imx</span>
<a name="ln-86"></a>      <span class="n">jmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">jmx</span>
<a name="ln-87"></a>      <span class="n">kmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">kmx</span>
<a name="ln-88"></a>
<a name="ln-89"></a>      <span class="n">density</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-90"></a>      <span class="n">x_speed</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-91"></a>      <span class="n">y_speed</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-92"></a>      <span class="n">z_speed</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-93"></a>      <span class="n">pressure</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">5</span><span class="p">)</span>
<a name="ln-94"></a>
<a name="ln-95"></a>      <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-96"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a name="ln-97"></a>              <span class="c">!include nothing</span>
<a name="ln-98"></a>              <span class="k">continue</span>
<a name="ln-99"></a><span class="k">          </span>
<a name="ln-100"></a><span class="k">          case</span> <span class="p">(</span><span class="s2">&quot;sst&quot;</span><span class="p">,</span> <span class="s2">&quot;sst2003&quot;</span><span class="p">,</span> <span class="s2">&quot;bsl&quot;</span><span class="p">,</span> <span class="s2">&quot;des-sst&quot;</span><span class="p">,</span> <span class="s2">&quot;kw&quot;</span><span class="p">)</span>
<a name="ln-101"></a>              <span class="n">tk</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-102"></a>              <span class="n">tw</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-103"></a>
<a name="ln-104"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;kkl&quot;</span><span class="p">)</span>
<a name="ln-105"></a>              <span class="n">tk</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-106"></a>              <span class="n">tkl</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-107"></a>
<a name="ln-108"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;sa&quot;</span><span class="p">,</span> <span class="s2">&quot;saBC&quot;</span><span class="p">)</span>
<a name="ln-109"></a>              <span class="n">tv</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-110"></a>
<a name="ln-111"></a>          <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;ke&quot;</span><span class="p">)</span>
<a name="ln-112"></a>              <span class="n">tk</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-113"></a>              <span class="n">te</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-114"></a>
<a name="ln-115"></a>          <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-116"></a>            <span class="n">Fatal_error</span>
<a name="ln-117"></a>      <span class="k">end select</span>
<a name="ln-118"></a>
<a name="ln-119"></a>      <span class="c">! Transition modeling</span>
<a name="ln-120"></a>      <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">transition</span><span class="p">))</span>
<a name="ln-121"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lctm2015&#39;</span><span class="p">)</span>
<a name="ln-122"></a>          <span class="n">tgm</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">state</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">8</span><span class="p">)</span>
<a name="ln-123"></a>
<a name="ln-124"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;bc&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-125"></a>          <span class="c">!do nothing</span>
<a name="ln-126"></a>          <span class="k">continue</span>
<a name="ln-127"></a>
<a name="ln-128"></a><span class="k">        case </span><span class="n">DEFAULT</span>
<a name="ln-129"></a>          <span class="n">Fatal_error</span>
<a name="ln-130"></a>      <span class="k">end Select</span>
<a name="ln-131"></a>
<a name="ln-132"></a><span class="k">      call </span><span class="n">write_header</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
<a name="ln-133"></a>      <span class="k">call </span><span class="n">write_grid</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
<a name="ln-134"></a>
<a name="ln-135"></a>      <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">control</span><span class="p">%</span><span class="n">w_count</span>
<a name="ln-136"></a>
<a name="ln-137"></a>        <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">control</span><span class="p">%</span><span class="n">w_list</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
<a name="ln-138"></a>        
<a name="ln-139"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Velocity&#39;</span><span class="p">)</span>
<a name="ln-140"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">x_speed</span><span class="p">,</span> <span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-141"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">y_speed</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-142"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">z_speed</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-143"></a>
<a name="ln-144"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<a name="ln-145"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">density</span><span class="p">,</span> <span class="s2">&quot;Density&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-146"></a>          
<a name="ln-147"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Pressure&#39;</span><span class="p">)</span>
<a name="ln-148"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">pressure</span><span class="p">,</span> <span class="s2">&quot;Pressure&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-149"></a>            
<a name="ln-150"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Mu&#39;</span><span class="p">)</span>
<a name="ln-151"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="s2">&quot;Mu&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-152"></a>            
<a name="ln-153"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Mu_t&#39;</span><span class="p">)</span>
<a name="ln-154"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">mu_t</span><span class="p">,</span> <span class="s2">&quot;Mu_t&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-155"></a>            
<a name="ln-156"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;TKE&#39;</span><span class="p">)</span>
<a name="ln-157"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">tk</span><span class="p">,</span> <span class="s2">&quot;TKE&quot;</span><span class="p">,</span>  <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-158"></a>
<a name="ln-159"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Omega&#39;</span><span class="p">)</span>
<a name="ln-160"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">tw</span><span class="p">,</span> <span class="s2">&quot;Omega&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-161"></a>
<a name="ln-162"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Kl&#39;</span><span class="p">)</span>
<a name="ln-163"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">tkl</span><span class="p">,</span> <span class="s2">&quot;Kl&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-164"></a>
<a name="ln-165"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;tv&#39;</span><span class="p">)</span>
<a name="ln-166"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">tv</span><span class="p">,</span> <span class="s2">&quot;tv&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-167"></a>
<a name="ln-168"></a>         <span class="c">! case(&#39;Wall_distance&#39;)</span>
<a name="ln-169"></a>         <span class="c">!   call write_scalar(dist, &quot;Wall_dist&quot;, 1)</span>
<a name="ln-170"></a>
<a name="ln-171"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">)</span>
<a name="ln-172"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">sst_F1</span><span class="p">,</span> <span class="s2">&quot;F1&quot;</span><span class="p">,</span>  <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-173"></a>
<a name="ln-174"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dudx&#39;</span><span class="p">)</span>
<a name="ln-175"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradu_x</span> <span class="p">,</span><span class="s2">&quot;dudx &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-176"></a>                                               
<a name="ln-177"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dudy&#39;</span><span class="p">)</span>                         
<a name="ln-178"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradu_y</span> <span class="p">,</span><span class="s2">&quot;dudy &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-179"></a>                                               
<a name="ln-180"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dudz&#39;</span><span class="p">)</span>                         
<a name="ln-181"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradu_z</span> <span class="p">,</span><span class="s2">&quot;dudz &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-182"></a>                                               
<a name="ln-183"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dvdx&#39;</span><span class="p">)</span>                         
<a name="ln-184"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradv_x</span> <span class="p">,</span><span class="s2">&quot;dvdx &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-185"></a>                                               
<a name="ln-186"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dvdy&#39;</span><span class="p">)</span>                         
<a name="ln-187"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradv_y</span> <span class="p">,</span><span class="s2">&quot;dvdy &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-188"></a>                                               
<a name="ln-189"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dvdz&#39;</span><span class="p">)</span>                         
<a name="ln-190"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradv_z</span> <span class="p">,</span><span class="s2">&quot;dvdz &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-191"></a>                                               
<a name="ln-192"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dwdx&#39;</span><span class="p">)</span>                         
<a name="ln-193"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradw_x</span> <span class="p">,</span><span class="s2">&quot;dwdx &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-194"></a>                                               
<a name="ln-195"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dwdy&#39;</span><span class="p">)</span>                         
<a name="ln-196"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradw_y</span> <span class="p">,</span><span class="s2">&quot;dwdy &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-197"></a>                                               
<a name="ln-198"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dwdz&#39;</span><span class="p">)</span>                         
<a name="ln-199"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradw_z</span> <span class="p">,</span><span class="s2">&quot;dwdz &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-200"></a>                                               
<a name="ln-201"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;DTdx&#39;</span><span class="p">)</span>                         
<a name="ln-202"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradT_x</span> <span class="p">,</span><span class="s2">&quot;dTdx &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-203"></a>                                               
<a name="ln-204"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;DTdy&#39;</span><span class="p">)</span>                         
<a name="ln-205"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradT_y</span> <span class="p">,</span><span class="s2">&quot;dTdy &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-206"></a>                                               
<a name="ln-207"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;DTdz&#39;</span><span class="p">)</span>                         
<a name="ln-208"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradT_z</span> <span class="p">,</span><span class="s2">&quot;dTdz &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-209"></a>                                               
<a name="ln-210"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dtkdx&#39;</span><span class="p">)</span>                        
<a name="ln-211"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradtk_x</span><span class="p">,</span><span class="s2">&quot;dtkdx&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-212"></a>                                               
<a name="ln-213"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dtkdy&#39;</span><span class="p">)</span>                        
<a name="ln-214"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradtk_y</span><span class="p">,</span><span class="s2">&quot;dtkdy&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-215"></a>                                               
<a name="ln-216"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dtkdz&#39;</span><span class="p">)</span>                        
<a name="ln-217"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradtk_z</span><span class="p">,</span><span class="s2">&quot;dtkdz&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-218"></a>                                               
<a name="ln-219"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dtwdx&#39;</span><span class="p">)</span>                        
<a name="ln-220"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradtw_x</span><span class="p">,</span><span class="s2">&quot;dtwdx&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-221"></a>                                               
<a name="ln-222"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dtwdy&#39;</span><span class="p">)</span>                        
<a name="ln-223"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradtw_y</span><span class="p">,</span><span class="s2">&quot;dtwdy&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-224"></a>                                               
<a name="ln-225"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Dtwdz&#39;</span><span class="p">)</span>                        
<a name="ln-226"></a>            <span class="k">call </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">gradtw_z</span><span class="p">,</span><span class="s2">&quot;dtwdz&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-227"></a>
<a name="ln-228"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;do not write&#39;</span><span class="p">)</span>
<a name="ln-229"></a>            <span class="c">! do not write</span>
<a name="ln-230"></a>            <span class="k">continue</span>
<a name="ln-231"></a>
<a name="ln-232"></a><span class="k">          case </span><span class="n">Default</span>
<a name="ln-233"></a>            <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="n">err</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">control</span><span class="p">%</span><span class="n">w_list</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; to file&quot;</span>
<a name="ln-234"></a>
<a name="ln-235"></a>        <span class="k">end select</span>
<a name="ln-236"></a><span class="k">      end do</span>
<a name="ln-237"></a>
<a name="ln-238"></a>
<a name="ln-239"></a><span class="k">    end subroutine </span><span class="n">write_file</span>
<a name="ln-240"></a>
<a name="ln-241"></a>
<a name="ln-242"></a>    <span class="k">subroutine </span><span class="n">write_header</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
<a name="ln-243"></a>      <span class="c">!&lt; Write the header in the output file</span>
<a name="ln-244"></a>      <span class="k">implicit none</span>
<a name="ln-245"></a><span class="k">      type</span><span class="p">(</span><span class="n">controltype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">control</span>
<a name="ln-246"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-247"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">total</span>
<a name="ln-248"></a>
<a name="ln-249"></a>      <span class="n">DebugCall</span><span class="p">(</span><span class="s1">&#39;write_output_vtk: write_header&#39;</span><span class="p">)</span>
<a name="ln-250"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s2">&quot;variables = x y z &quot;</span>
<a name="ln-251"></a>
<a name="ln-252"></a>      <span class="n">total</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-253"></a>      <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">control</span><span class="p">%</span><span class="n">w_count</span>
<a name="ln-254"></a>
<a name="ln-255"></a>        <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">control</span><span class="p">%</span><span class="n">w_list</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
<a name="ln-256"></a>        
<a name="ln-257"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;Velocity&#39;</span><span class="p">)</span>
<a name="ln-258"></a>            <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s2">&quot; u v w &quot;</span>
<a name="ln-259"></a>            <span class="n">total</span> <span class="o">=</span> <span class="n">total</span><span class="o">+</span><span class="mi">3</span>
<a name="ln-260"></a>
<a name="ln-261"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;do not write&#39;</span><span class="p">)</span>
<a name="ln-262"></a>            <span class="c">!skip </span>
<a name="ln-263"></a>            <span class="k">continue</span>
<a name="ln-264"></a>
<a name="ln-265"></a><span class="k">          case </span><span class="n">Default</span>
<a name="ln-266"></a>            <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">control</span><span class="p">%</span><span class="n">w_list</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; &quot;</span>
<a name="ln-267"></a>            <span class="n">total</span> <span class="o">=</span> <span class="n">total</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-268"></a>
<a name="ln-269"></a>        <span class="k">end select</span>
<a name="ln-270"></a><span class="k">      end do</span>
<a name="ln-271"></a>
<a name="ln-272"></a><span class="k">      write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span> <span class="s1">&#39;(a,i4.4,3(a,i5.5),a)&#39;</span><span class="p">)</span> <span class="s2">&quot;zone T=block&quot;</span><span class="p">,</span><span class="n">process_id</span><span class="p">,</span><span class="s2">&quot;  i=&quot;</span><span class="p">,</span><span class="n">imx</span><span class="p">,</span><span class="s2">&quot; j=&quot;</span><span class="p">,</span><span class="n">jmx</span><span class="p">,</span> <span class="s2">&quot; k=&quot;</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot; Datapacking=Block&quot;</span>
<a name="ln-273"></a>
<a name="ln-274"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;Varlocation=([1-3]=Nodal)&quot;</span>
<a name="ln-275"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span><span class="s1">&#39;(a,i2.2,a)&#39;</span><span class="p">)</span> <span class="s2">&quot;Varlocation=([4-&quot;</span><span class="p">,</span><span class="n">total</span><span class="p">,</span><span class="s2">&quot;]=Nodal)&quot;</span>
<a name="ln-276"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span><span class="s2">&quot;(a,i4.4)&quot;</span><span class="p">)</span> <span class="s2">&quot;STRANDID=&quot;</span><span class="p">,</span><span class="mi">1</span>
<a name="ln-277"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span><span class="s2">&quot;(a,i4.4)&quot;</span><span class="p">)</span> <span class="s2">&quot;SOLUTIONTIME=&quot;</span><span class="p">,</span><span class="n">control</span><span class="p">%</span><span class="n">checkpoint_iter_count</span>
<a name="ln-278"></a>
<a name="ln-279"></a>
<a name="ln-280"></a>    <span class="k">end subroutine </span><span class="n">write_header</span>
<a name="ln-281"></a>
<a name="ln-282"></a>    <span class="k">subroutine </span><span class="n">write_grid</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
<a name="ln-283"></a>      <span class="c">!&lt; Write grid information in the output file</span>
<a name="ln-284"></a>      <span class="k">implicit none</span>
<a name="ln-285"></a><span class="k">      type</span><span class="p">(</span><span class="n">nodetype</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">imx</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">jmx</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">kmx</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nodes</span> 
<a name="ln-286"></a>
<a name="ln-287"></a>      <span class="c">! write grid point coordinates</span>
<a name="ln-288"></a>      <span class="n">DebugCall</span><span class="p">(</span><span class="s1">&#39;write_output_tec_node: write_grid&#39;</span><span class="p">)</span>
<a name="ln-289"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span> <span class="k">format</span><span class="p">)</span> <span class="p">(((</span><span class="n">nodes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="p">),</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-290"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span> <span class="k">format</span><span class="p">)</span> <span class="p">(((</span><span class="n">nodes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="p">),</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-291"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span> <span class="k">format</span><span class="p">)</span> <span class="p">(((</span><span class="n">nodes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="p">),</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-292"></a>
<a name="ln-293"></a>    <span class="k">end subroutine </span><span class="n">write_grid</span>
<a name="ln-294"></a>
<a name="ln-295"></a>    <span class="k">subroutine </span><span class="n">write_scalar</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">index</span><span class="p">)</span>
<a name="ln-296"></a>      <span class="c">!&lt; Write scalar variable in the output file</span>
<a name="ln-297"></a>      <span class="k">implicit none</span>
<a name="ln-298"></a><span class="k">      </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">index</span>
<a name="ln-299"></a><span class="nb">      </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="nb">index</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="nb">index</span><span class="p">,</span><span class="nb">index</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="nb">index</span><span class="p">,</span><span class="nb">index</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="nb">index</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">var</span>
<a name="ln-300"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="kd">::</span> <span class="n">name</span>
<a name="ln-301"></a>
<a name="ln-302"></a>      <span class="n">DebugCall</span><span class="p">(</span><span class="s1">&#39;write_scalar&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<a name="ln-303"></a>
<a name="ln-304"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OUT_FILE_UNIT</span><span class="p">,</span> <span class="k">format</span><span class="p">)</span> <span class="p">(((</span><span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">var</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-305"></a>                                          <span class="o">+</span> <span class="n">var</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">var</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">))&amp;</span>
<a name="ln-306"></a>                                          <span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">imx</span><span class="p">),</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jmx</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-307"></a>
<a name="ln-308"></a>    <span class="k">end subroutine </span><span class="n">write_scalar</span>
<a name="ln-309"></a>
<a name="ln-310"></a>
<a name="ln-311"></a><span class="k">end module </span><span class="n">write_output_tec_node</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-02-10T20:32:54.471560 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST-3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>