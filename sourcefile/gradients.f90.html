<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>gradients.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>gradients.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.6% of total for source files.">128 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/gradients.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">gradients.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/gradients.html">gradients</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/gradients.f90.html#src">gradients.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>allocate memory to laminar gradients if flow is viscous and
 allocate memory to tubulence gradients base upon the model being used</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~gradients.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilegradientsf90EfferentGraph" width="549pt" height="283pt"
 viewBox="0.00 0.00 549.00 282.56" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~gradients.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 278.5613)">
<title>sourcefile~~gradients.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-278.5613 545,-278.5613 545,4 -4,4"/>
<!-- sourcefile~gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~gradients.f90</title>
<polygon fill="none" stroke="#000000" points="541,-148 466,-148 466,-124 541,-124 541,-148"/>
<text text-anchor="middle" x="503.5" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">gradients.f90</text>
</g>
<!-- sourcefile~laminar_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~laminar_gradients.f90</title>
<g id="a_sourcefile~~gradients.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/laminar_gradients.f90.html" xlink:title="laminar_gradients.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="426,-230 310,-230 310,-206 426,-206 426,-230"/>
<text text-anchor="middle" x="368" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">laminar_gradients.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~laminar_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~laminar_gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M491.7913,-148.093C478.0862,-161.6471 454.1735,-183.4893 430,-197 426.7852,-198.7968 423.3908,-200.4751 419.9138,-202.0363"/>
<polygon fill="#ff0000" stroke="#ff0000" points="418.4863,-198.8391 410.5836,-205.8959 421.1621,-205.3075 418.4863,-198.8391"/>
</g>
<!-- sourcefile~sst_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~sst_gradients.f90</title>
<g id="a_sourcefile~~gradients.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/sst_gradients.f90.html" xlink:title="sst_gradients.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="415,-188 321,-188 321,-164 415,-164 415,-188"/>
<text text-anchor="middle" x="368" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sst_gradients.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~sst_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~sst_gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M465.7557,-147.1422C451.2383,-151.4278 434.4173,-156.3934 418.8645,-160.9847"/>
<polygon fill="#ff0000" stroke="#ff0000" points="417.464,-157.7487 408.8641,-163.9368 419.4459,-164.4623 417.464,-157.7487"/>
</g>
<!-- sourcefile~utils.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~utils.f90</title>
<g id="a_sourcefile~~gradients.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/utils.f90.html" xlink:title="utils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="270,-128 216,-128 216,-104 270,-104 270,-128"/>
<text text-anchor="middle" x="243" y="-113.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M465.8993,-133.1132C416.4114,-129.3137 329.9268,-122.6738 280.4928,-118.8785"/>
<polygon fill="#ff0000" stroke="#ff0000" points="280.4774,-115.3671 270.2388,-118.0913 279.9415,-122.3466 280.4774,-115.3671"/>
</g>
<!-- sourcefile~kkl_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~kkl_gradients.f90</title>
<g id="a_sourcefile~~gradients.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/kkl_gradients.f90.html" xlink:title="kkl_gradients.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="415,-108 321,-108 321,-84 415,-84 415,-108"/>
<text text-anchor="middle" x="368" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">kkl_gradients.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~kkl_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~kkl_gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M465.7557,-124.8578C451.2383,-120.5722 434.4173,-115.6066 418.8645,-111.0153"/>
<polygon fill="#ff0000" stroke="#ff0000" points="419.4459,-107.5377 408.8641,-108.0632 417.464,-114.2513 419.4459,-107.5377"/>
</g>
<!-- sourcefile~sa_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~sa_gradients.f90</title>
<g id="a_sourcefile~~gradients.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/sa_gradients.f90.html" xlink:title="sa_gradients.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="414,-66 322,-66 322,-42 414,-42 414,-66"/>
<text text-anchor="middle" x="368" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sa_gradients.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~sa_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~sa_gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M491.7913,-123.907C478.0862,-110.3529 454.1735,-88.5107 430,-75 426.7852,-73.2032 423.3908,-71.5249 419.9138,-69.9637"/>
<polygon fill="#ff0000" stroke="#ff0000" points="421.1621,-66.6925 410.5836,-66.1041 418.4863,-73.1609 421.1621,-66.6925"/>
</g>
<!-- sourcefile~global_vars.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~global_vars.f90</title>
<g id="a_sourcefile~~gradients.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/global_vars.f90.html" xlink:title="global_vars.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="180,-128 95,-128 95,-104 180,-104 180,-128"/>
<text text-anchor="middle" x="137.5" y="-113.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_vars.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M498.8545,-148.1222C489.5808,-170.4716 466.4741,-217.8183 430,-239 357.7591,-280.9526 322.5915,-283.3762 243,-258"/>
</g>
<!-- sourcefile~lctm2015_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~lctm2015_gradients.f90</title>
<g id="a_sourcefile~~gradients.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/lctm2015_gradients.f90.html" xlink:title="lctm2015_gradients.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="430,-24 306,-24 306,0 430,0 430,-24"/>
<text text-anchor="middle" x="368" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lctm2015_gradients.f90</text>
</a>
</g>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~lctm2015_gradients.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~lctm2015_gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M498.0447,-123.954C487.7649,-102.5686 463.5088,-57.886 430,-33 427.9244,-31.4585 425.728,-30.0251 423.4488,-28.6928"/>
<polygon fill="#ff0000" stroke="#ff0000" points="424.8254,-25.466 414.3269,-24.0404 421.6449,-31.7018 424.8254,-25.466"/>
</g>
<!-- sourcefile~laminar_gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~laminar_gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M322.1315,-205.9125C316.4421,-203.4362 310.9086,-200.4907 306,-197 283.746,-181.1742 265.5554,-155.2608 254.5405,-137.0135"/>
<polygon fill="#ff0000" stroke="#ff0000" points="257.5046,-135.1482 249.451,-128.2642 251.4539,-138.668 257.5046,-135.1482"/>
</g>
<!-- sourcefile~laminar_gradients.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~laminar_gradients.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M336.7716,-230.0752C302.7983,-242.8798 252.0905,-260.8983 243,-258"/>
</g>
<!-- sourcefile~sst_gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~sst_gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M337.4638,-163.8906C327.3552,-159.6979 316.1091,-154.8333 306,-150 295.0971,-144.7872 283.3879,-138.6293 273.0577,-132.9962"/>
<polygon fill="#ffda00" stroke="#ffda00" points="274.4681,-129.7771 264.0212,-128.0127 271.0877,-135.9068 274.4681,-129.7771"/>
</g>
<!-- sourcefile~sst_gradients.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~sst_gradients.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M324.2028,-188.0926C317.886,-190.6107 311.6265,-193.5664 306,-197 272.7311,-217.3025 280.1328,-269.8391 243,-258"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M243,-258C188.6388,-240.668 157.6165,-173.7073 144.6881,-138.2778"/>
<polygon fill="#ffda00" stroke="#ffda00" points="147.839,-136.682 141.2509,-128.3845 141.2267,-138.9794 147.839,-136.682"/>
</g>
<!-- sourcefile~utils.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~utils.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M215.8311,-116C208.0202,-116 199.2219,-116 190.4174,-116"/>
<polygon fill="#48ff00" stroke="#48ff00" points="190.1377,-112.5001 180.1377,-116 190.1376,-119.5001 190.1377,-112.5001"/>
</g>
<!-- sourcefile~kkl_gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~kkl_gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M320.7429,-103.5611C307.3477,-105.7044 292.9577,-108.0068 280.2439,-110.041"/>
<polygon fill="#00ff91" stroke="#00ff91" points="279.3387,-106.6412 270.0173,-111.6772 280.4447,-113.5533 279.3387,-106.6412"/>
</g>
<!-- sourcefile~kkl_gradients.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~kkl_gradients.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M337.5478,-83.9734C311.989,-75.5736 274.6807,-67.2898 243,-76"/>
</g>
<!-- sourcefile~sa_gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~sa_gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M327.7191,-66.0023C320.3619,-68.6535 312.8504,-71.676 306,-75 292.7524,-81.4281 278.9437,-90.1548 267.6422,-97.9051"/>
<polygon fill="#0091ff" stroke="#0091ff" points="265.3487,-95.2387 259.1747,-103.8488 269.3704,-100.9681 265.3487,-95.2387"/>
</g>
<!-- sourcefile~sa_gradients.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~sa_gradients.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M321.8259,-60.0046C298.0397,-63.6304 268.7083,-68.9318 243,-76"/>
</g>
<!-- sourcefile~global.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~global.f90</title>
<g id="a_sourcefile~~gradients.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/global.f90.html" xlink:title="global.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="59,-128 0,-128 0,-104 59,-104 59,-128"/>
<text text-anchor="middle" x="29.5" y="-113.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global.f90</text>
</a>
</g>
</g>
<!-- sourcefile~global_vars.f90&#45;&gt;sourcefile~global.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~global_vars.f90&#45;&gt;sourcefile~global.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M94.8155,-116C86.4413,-116 77.6869,-116 69.4077,-116"/>
<polygon fill="#4800ff" stroke="#4800ff" points="69.2393,-112.5001 59.2392,-116 69.2392,-119.5001 69.2393,-112.5001"/>
</g>
<!-- sourcefile~lctm2015_gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~lctm2015_gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M320.8438,-24.0808C315.5499,-26.5414 310.4644,-29.4846 306,-33 282.4593,-51.5367 288.9287,-66.7732 270,-90 268.15,-92.27 266.1162,-94.5454 264.0202,-96.754"/>
<polygon fill="#ff00da" stroke="#ff00da" points="261.4553,-94.3687 256.8321,-103.9017 266.391,-99.3324 261.4553,-94.3687"/>
</g>
<!-- sourcefile~lctm2015_gradients.f90&#45;&gt;sourcefile~global_vars.f90 -->
<g id="sourcefile~~gradients.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~lctm2015_gradients.f90&#45;&gt;sourcefile~global_vars.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M327,-24.1191C319.8605,-26.7255 312.6101,-29.7024 306,-33 275.6649,-48.1334 275.6874,-67.013 243,-76"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M243,-76C219.7891,-82.3815 194.5512,-91.8539 174.5811,-99.979"/>
<polygon fill="#ff00da" stroke="#ff00da" points="173.1393,-96.7876 165.2327,-103.84 175.8115,-103.2575 173.1393,-96.7876"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~gradients.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilegradientsf90AfferentGraph" width="445pt" height="94pt"
 viewBox="0.00 0.00 445.00 94.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~gradients.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 90)">
<title>sourcefile~~gradients.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-90 441,-90 441,4 -4,4"/>
<!-- sourcefile~gradients.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~gradients.f90</title>
<polygon fill="none" stroke="#000000" points="75,-65 0,-65 0,-41 75,-41 75,-65"/>
<text text-anchor="middle" x="37.5" y="-50.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">gradients.f90</text>
</g>
<!-- sourcefile~create_and_erase.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~create_and_erase.f90</title>
<g id="a_sourcefile~~gradients.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/create_and_erase.f90.html" xlink:title="create_and_erase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="229,-86 111,-86 111,-62 229,-62 229,-86"/>
<text text-anchor="middle" x="170" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">create_and_erase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~create_and_erase.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~create_and_erase.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M110.7258,-64.6056C102.1042,-63.2392 93.3232,-61.8475 84.9757,-60.5245"/>
<polygon fill="#ff0000" stroke="#ff0000" points="85.473,-57.0597 75.0484,-58.9511 84.3772,-63.9734 85.473,-57.0597"/>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~gradients.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="199.5,-44 140.5,-44 140.5,-20 199.5,-20 199.5,-44"/>
<text text-anchor="middle" x="170" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M140.2644,-36.7128C124.0412,-39.284 103.5697,-42.5286 85.1762,-45.4438"/>
<polygon fill="#ff0000" stroke="#ff0000" points="84.5404,-42.0008 75.2116,-47.0231 85.6362,-48.9145 84.5404,-42.0008"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~gradients.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="437,-44 383,-44 383,-20 437,-20 437,-44"/>
<text text-anchor="middle" x="410" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M382.7124,-32.5275C371.6304,-32.7172 358.7042,-32.9071 347,-33 299.8741,-33.374 245.6893,-32.941 209.8157,-32.5337"/>
<polygon fill="#00ffff" stroke="#00ffff" points="209.7926,-29.0333 199.7519,-32.4146 209.7098,-36.0328 209.7926,-29.0333"/>
</g>
<!-- sourcefile~start_finish.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~start_finish.f90</title>
<g id="a_sourcefile~~gradients.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/start_finish.f90.html" xlink:title="start_finish.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="347,-24 265,-24 265,0 347,0 347,-24"/>
<text text-anchor="middle" x="306" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_finish.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~start_finish.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~start_finish.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M382.9467,-26.7974C374.9882,-25.267 366.0079,-23.54 357.0646,-21.8201"/>
<polygon fill="#00ffff" stroke="#00ffff" points="357.5205,-18.3437 347.0394,-19.8922 356.1985,-25.2178 357.5205,-18.3437"/>
</g>
<!-- sourcefile~start_finish.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~gradients.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~start_finish.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M264.8264,-18.0549C247.4753,-20.6066 227.3489,-23.5663 210.1136,-26.1009"/>
<polygon fill="#00ffff" stroke="#00ffff" points="209.1907,-22.6989 199.8064,-27.6167 210.2092,-29.6244 209.1907,-22.6989"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/gradients.html">gradients</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/gradients.f90.html#src">gradients.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>  <span class="c">!&lt; allocate memory to laminar gradients if flow is viscous and</span>
<a name="ln-2"></a>  <span class="c">!&lt; allocate memory to tubulence gradients base upon the model being used</span>
<a name="ln-3"></a><span class="k">module </span><span class="n">gradients</span>
<a name="ln-4"></a>  <span class="c">!&lt; allocate memory to laminar gradients if flow is viscous and</span>
<a name="ln-5"></a>  <span class="c">!&lt; allocate memory to tubulence gradients base upon the model being used</span>
<a name="ln-6"></a>  <span class="c">!------------------------------------------------------------------</span>
<a name="ln-7"></a>  <span class="c">! 170509  Jatinder Pal Singh Sandhu</span>
<a name="ln-8"></a>  <span class="c">!         - first build</span>
<a name="ln-9"></a>  <span class="c">!-------------------------------------------------------------------</span>
<a name="ln-10"></a><span class="cp">#include &quot;../error.h&quot;</span>
<a name="ln-11"></a><span class="cp">#include &quot;../debug.h&quot;</span>
<a name="ln-12"></a>
<a name="ln-13"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">imx</span>
<a name="ln-14"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">jmx</span>
<a name="ln-15"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">kmx</span>
<a name="ln-16"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">mu_ref</span>
<a name="ln-17"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">turbulence</span> 
<a name="ln-18"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">transition</span> 
<a name="ln-19"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">n_grad</span>
<a name="ln-20"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">sst_n_grad</span>
<a name="ln-21"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">gradqp_x</span>
<a name="ln-22"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">gradqp_y</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">gradqp_z</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">global_vars</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">process_id</span>
<a name="ln-25"></a>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">dmsg</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">dealloc</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">alloc</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">utils</span><span class="p">,</span>        <span class="n">only</span> <span class="p">:</span> <span class="n">turbulence_read_error</span>
<a name="ln-30"></a>
<a name="ln-31"></a>  <span class="k">use </span><span class="n">laminar_gradients</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">setup_laminar_grad</span>
<a name="ln-32"></a>  <span class="k">use </span><span class="n">laminar_gradients</span><span class="p">,</span>  <span class="n">only</span> <span class="p">:</span> <span class="n">destroy_laminar_grad</span>
<a name="ln-33"></a>
<a name="ln-34"></a>  <span class="k">use </span><span class="n">sst_gradients</span><span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">setup_sst_grad</span>
<a name="ln-35"></a>  <span class="k">use </span><span class="n">sst_gradients</span><span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">destroy_sst_grad</span>
<a name="ln-36"></a>  <span class="k">use </span><span class="n">kkl_gradients</span><span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">setup_kkl_grad</span>
<a name="ln-37"></a>  <span class="k">use </span><span class="n">kkl_gradients</span><span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">destroy_kkl_grad</span>
<a name="ln-38"></a>  <span class="k">use </span><span class="n">sa_gradients</span> <span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">setup_sa_grad</span>
<a name="ln-39"></a>  <span class="k">use </span><span class="n">sa_gradients</span> <span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">destroy_sa_grad</span>
<a name="ln-40"></a>  <span class="k">use </span><span class="n">lctm2015_gradients</span> <span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">setup_lctm2015_grad</span>
<a name="ln-41"></a>  <span class="k">use </span><span class="n">lctm2015_gradients</span> <span class="p">,</span>      <span class="n">only</span> <span class="p">:</span> <span class="n">destroy_lctm2015_grad</span>
<a name="ln-42"></a>
<a name="ln-43"></a>  <span class="k">implicit none</span>
<a name="ln-44"></a><span class="k">  private</span>
<a name="ln-45"></a>
<a name="ln-46"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">setup_gradients</span>
<a name="ln-47"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">destroy_gradients</span>
<a name="ln-48"></a>
<a name="ln-49"></a>  <span class="k">contains</span>
<a name="ln-50"></a>
<a name="ln-51"></a>
<a name="ln-52"></a><span class="k">    subroutine </span><span class="n">setup_gradients</span>
<a name="ln-53"></a>      <span class="c">!&lt; Memoery allocation to the gradient variables and </span>
<a name="ln-54"></a>      <span class="c">!&lt; setup pointer to the slice to the main gradient variable</span>
<a name="ln-55"></a>      <span class="c">!&lt; based on the various models being used.</span>
<a name="ln-56"></a>
<a name="ln-57"></a>      <span class="k">implicit none</span>
<a name="ln-58"></a>
<a name="ln-59"></a><span class="k">      </span><span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;setup_gradients&quot;</span><span class="p">)</span>
<a name="ln-60"></a>
<a name="ln-61"></a>      <span class="k">if</span><span class="p">(</span><span class="n">mu_ref</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-62"></a>
<a name="ln-63"></a><span class="k">        call </span><span class="n">get_n_grad</span><span class="p">()</span>
<a name="ln-64"></a>        <span class="k">call </span><span class="n">allocate_memory</span><span class="p">()</span>
<a name="ln-65"></a>
<a name="ln-66"></a>        <span class="c">! linking pointer to laminar gradients</span>
<a name="ln-67"></a>        <span class="k">call </span><span class="n">setup_laminar_grad</span><span class="p">()</span>
<a name="ln-68"></a>
<a name="ln-69"></a>        <span class="c">! linking pointer to turbulent gradients</span>
<a name="ln-70"></a>        <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-71"></a>          
<a name="ln-72"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-73"></a>            <span class="c">!do nothing</span>
<a name="ln-74"></a>            <span class="k">continue</span>
<a name="ln-75"></a>
<a name="ln-76"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-77"></a>            <span class="k">call </span><span class="n">setup_sa_grad</span><span class="p">()</span>
<a name="ln-78"></a>
<a name="ln-79"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-80"></a>            <span class="k">call </span><span class="n">setup_sst_grad</span><span class="p">()</span>
<a name="ln-81"></a>
<a name="ln-82"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-83"></a>            <span class="k">call </span><span class="n">setup_kkl_grad</span><span class="p">()</span>
<a name="ln-84"></a>
<a name="ln-85"></a>          <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-86"></a>            <span class="c">!call turbulence_read_error()</span>
<a name="ln-87"></a>            <span class="n">Fatal_error</span>
<a name="ln-88"></a>
<a name="ln-89"></a>        <span class="k">end select</span>
<a name="ln-90"></a>
<a name="ln-91"></a>        <span class="c">!Transition modeling</span>
<a name="ln-92"></a>        <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">transition</span><span class="p">))</span>
<a name="ln-93"></a>
<a name="ln-94"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lctm2015&#39;</span><span class="p">)</span>
<a name="ln-95"></a>            <span class="k">call </span><span class="n">setup_lctm2015_grad</span><span class="p">()</span>
<a name="ln-96"></a>
<a name="ln-97"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="s1">&#39;bc&#39;</span><span class="p">)</span>
<a name="ln-98"></a>            <span class="c">!do nothing</span>
<a name="ln-99"></a>            <span class="k">continue</span>
<a name="ln-100"></a>
<a name="ln-101"></a><span class="k">          case </span><span class="n">DEFAULT</span>
<a name="ln-102"></a>            <span class="n">Fatal_error</span>
<a name="ln-103"></a>
<a name="ln-104"></a>        <span class="k">end Select</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="k">      end if</span>
<a name="ln-107"></a><span class="k">    end subroutine </span><span class="n">setup_gradients</span>
<a name="ln-108"></a>
<a name="ln-109"></a>
<a name="ln-110"></a>
<a name="ln-111"></a>    <span class="k">subroutine </span><span class="n">destroy_gradients</span>
<a name="ln-112"></a>      <span class="c">!&lt; Deallocate memoery and nullify pointers</span>
<a name="ln-113"></a>      <span class="c">!&lt; to the gradient variables.</span>
<a name="ln-114"></a>      
<a name="ln-115"></a>      <span class="k">implicit none</span>
<a name="ln-116"></a>
<a name="ln-117"></a><span class="k">      </span><span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;destroy_gradients&quot;</span><span class="p">)</span>
<a name="ln-118"></a>
<a name="ln-119"></a>      <span class="k">if</span><span class="p">(</span><span class="n">mu_ref</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-120"></a>
<a name="ln-121"></a><span class="k">        call </span><span class="n">destroy_memory</span><span class="p">()</span>
<a name="ln-122"></a>
<a name="ln-123"></a>        <span class="c">! unlink laminar grad pointer</span>
<a name="ln-124"></a>        <span class="k">call </span><span class="n">destroy_laminar_grad</span><span class="p">()</span>
<a name="ln-125"></a>
<a name="ln-126"></a>        <span class="c">!unlink turublent grad pointer</span>
<a name="ln-127"></a>        <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-128"></a>          
<a name="ln-129"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-130"></a>            <span class="c">!do nothing</span>
<a name="ln-131"></a>            <span class="k">continue</span>
<a name="ln-132"></a>
<a name="ln-133"></a><span class="k">          case</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-134"></a>            <span class="k">call </span><span class="n">destroy_sa_grad</span><span class="p">()</span>
<a name="ln-135"></a>
<a name="ln-136"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-137"></a>            <span class="k">call </span><span class="n">destroy_sst_grad</span><span class="p">()</span>
<a name="ln-138"></a>
<a name="ln-139"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-140"></a>            <span class="k">call </span><span class="n">destroy_kkl_grad</span><span class="p">()</span>
<a name="ln-141"></a>
<a name="ln-142"></a>          <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-143"></a>           <span class="c">! call turbulence_read_error()</span>
<a name="ln-144"></a>           <span class="n">Fatal_error</span>
<a name="ln-145"></a>
<a name="ln-146"></a>        <span class="k">end select</span>
<a name="ln-147"></a>
<a name="ln-148"></a>        <span class="c">!Transition modeling</span>
<a name="ln-149"></a>        <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">transition</span><span class="p">))</span>
<a name="ln-150"></a>
<a name="ln-151"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lctm2015&#39;</span><span class="p">)</span>
<a name="ln-152"></a>            <span class="k">call </span><span class="n">destroy_lctm2015_grad</span><span class="p">()</span>
<a name="ln-153"></a>
<a name="ln-154"></a>          <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="s1">&#39;bc&#39;</span><span class="p">)</span>
<a name="ln-155"></a>            <span class="c">!do nothing</span>
<a name="ln-156"></a>            <span class="k">continue</span>
<a name="ln-157"></a>
<a name="ln-158"></a><span class="k">          case </span><span class="n">DEFAULT</span>
<a name="ln-159"></a>            <span class="n">Fatal_error</span>
<a name="ln-160"></a>
<a name="ln-161"></a>        <span class="k">end Select</span>
<a name="ln-162"></a>
<a name="ln-163"></a><span class="k">      end if</span>
<a name="ln-164"></a>
<a name="ln-165"></a><span class="k">    end subroutine </span><span class="n">destroy_gradients</span>
<a name="ln-166"></a>
<a name="ln-167"></a>
<a name="ln-168"></a>
<a name="ln-169"></a>    <span class="k">subroutine </span><span class="n">get_n_grad</span><span class="p">()</span>
<a name="ln-170"></a>      <span class="c">!&lt; Set number of variables for which</span>
<a name="ln-171"></a>      <span class="c">!&lt; gradient is required based on the</span>
<a name="ln-172"></a>      <span class="c">!&lt; being used</span>
<a name="ln-173"></a>
<a name="ln-174"></a>      <span class="k">implicit none</span>
<a name="ln-175"></a>
<a name="ln-176"></a><span class="k">      </span><span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;get_n_grad&quot;</span><span class="p">)</span>
<a name="ln-177"></a>
<a name="ln-178"></a>      <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-179"></a>        
<a name="ln-180"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-181"></a>          <span class="c">!do nothing</span>
<a name="ln-182"></a>          <span class="k">continue</span>
<a name="ln-183"></a>
<a name="ln-184"></a><span class="k">        case</span> <span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-185"></a>          <span class="n">n_grad</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-186"></a>
<a name="ln-187"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-188"></a>          <span class="n">n_grad</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-189"></a>
<a name="ln-190"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-191"></a>          <span class="n">n_grad</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-192"></a>
<a name="ln-193"></a>        <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-194"></a>          <span class="c">!call turbulence_read_error()</span>
<a name="ln-195"></a>          <span class="n">Fatal_error</span>
<a name="ln-196"></a>
<a name="ln-197"></a>      <span class="k">end select</span>
<a name="ln-198"></a>
<a name="ln-199"></a>
<a name="ln-200"></a>      <span class="c">!Transition modeling</span>
<a name="ln-201"></a>      <span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">transition</span><span class="p">))</span>
<a name="ln-202"></a>
<a name="ln-203"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lctm2015&#39;</span><span class="p">)</span>
<a name="ln-204"></a>          <span class="n">n_grad</span> <span class="o">=</span> <span class="n">n_grad</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-205"></a>
<a name="ln-206"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="s1">&#39;bc&#39;</span><span class="p">)</span>
<a name="ln-207"></a>          <span class="n">n_grad</span> <span class="o">=</span> <span class="n">n_grad</span> <span class="o">+</span> <span class="mi">0</span>
<a name="ln-208"></a>
<a name="ln-209"></a>        <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-210"></a>          <span class="n">Fatal_error</span>
<a name="ln-211"></a>
<a name="ln-212"></a>      <span class="k">end Select</span>
<a name="ln-213"></a>
<a name="ln-214"></a><span class="k">    end subroutine </span><span class="n">get_n_grad</span>
<a name="ln-215"></a>
<a name="ln-216"></a>
<a name="ln-217"></a>
<a name="ln-218"></a>    <span class="k">subroutine </span><span class="n">allocate_memory</span><span class="p">()</span>
<a name="ln-219"></a>      <span class="c">!&lt; allocating memory to the gradient variable being used</span>
<a name="ln-220"></a>
<a name="ln-221"></a>      <span class="k">implicit none</span>
<a name="ln-222"></a>
<a name="ln-223"></a><span class="k">      </span><span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;allocate_memory&quot;</span><span class="p">)</span>
<a name="ln-224"></a>
<a name="ln-225"></a>      <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">gradqp_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">imx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">jmx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kmx</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_grad</span><span class="p">,</span> <span class="n">AErrMsg</span><span class="p">(</span><span class="s2">&quot;gradqp_x&quot;</span><span class="p">))</span>
<a name="ln-226"></a>      <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">gradqp_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">imx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">jmx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kmx</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_grad</span><span class="p">,</span> <span class="n">AErrMsg</span><span class="p">(</span><span class="s2">&quot;gradqp_y&quot;</span><span class="p">))</span>
<a name="ln-227"></a>      <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">gradqp_z</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">imx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">jmx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kmx</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_grad</span><span class="p">,</span> <span class="n">AErrMsg</span><span class="p">(</span><span class="s2">&quot;gradqp_z&quot;</span><span class="p">))</span>
<a name="ln-228"></a>
<a name="ln-229"></a>    <span class="k">end subroutine </span><span class="n">allocate_memory</span>
<a name="ln-230"></a>
<a name="ln-231"></a>
<a name="ln-232"></a>
<a name="ln-233"></a>    <span class="k">subroutine </span><span class="n">destroy_memory</span><span class="p">()</span>
<a name="ln-234"></a>      <span class="c">!&lt; deallocate memeory from the gradient variables</span>
<a name="ln-235"></a>
<a name="ln-236"></a>      <span class="k">implicit none</span>
<a name="ln-237"></a>
<a name="ln-238"></a><span class="k">      </span><span class="n">DebugCall</span><span class="p">(</span><span class="s2">&quot;deallocate_memory&quot;</span><span class="p">)</span>
<a name="ln-239"></a>
<a name="ln-240"></a>      <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">gradqp_x</span><span class="p">)</span>
<a name="ln-241"></a>      <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">gradqp_y</span><span class="p">)</span>
<a name="ln-242"></a>      <span class="k">call </span><span class="n">dealloc</span><span class="p">(</span><span class="n">gradqp_z</span><span class="p">)</span>
<a name="ln-243"></a>
<a name="ln-244"></a>    <span class="k">end subroutine </span><span class="n">destroy_memory</span>
<a name="ln-245"></a>    
<a name="ln-246"></a>
<a name="ln-247"></a>
<a name="ln-248"></a><span class="k">end module </span><span class="n">gradients</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2019-05-14T23:06:25.947765 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>