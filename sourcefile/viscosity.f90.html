<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="">
    
    <meta name="author" content="FEST-3D Team" >
    <link rel="icon" href="../favicon.png">

    <title>viscosity.f90 &ndash; FEST-3D</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140495700-1"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
   
     gtag('config', 'UA-140495700-1');
   </script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FEST-3D </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>viscosity.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.8% of total for source files.">442 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/viscosity.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">viscosity.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/viscosity.html">viscosity</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/viscosity.f90.html#src">viscosity.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>Setup, destroy, calculate molecular and turbulence viscosity</p>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~viscosity.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileviscosityf90EfferentGraph" width="300pt" height="318pt"
 viewBox="0.00 0.00 300.00 318.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~viscosity.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 314)">
<title>sourcefile~~viscosity.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-314 296,-314 296,4 -4,4"/>
<!-- sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~viscosity.f90</title>
<polygon fill="none" stroke="#000000" points="292,-168 222,-168 222,-144 292,-144 292,-168"/>
<text text-anchor="middle" x="257" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">viscosity.f90</text>
</g>
<!-- sourcefile~global_sa.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~global_sa.f90</title>
<g id="a_sourcefile~~viscosity.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/global_sa.f90.html" xlink:title="global_sa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="184.5,-310 108.5,-310 108.5,-286 184.5,-286 184.5,-310"/>
<text text-anchor="middle" x="146.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_sa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sa.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sa.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M251.8172,-168.0164C241.6999,-190.4604 217.5249,-239.4208 186,-272 183.2525,-274.8394 180.1421,-277.53 176.9024,-280.0275"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.8625,-277.1832 168.7156,-285.8126 178.9022,-282.9 174.8625,-277.1832"/>
</g>
<!-- sourcefile~gradients.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~gradients.f90</title>
<g id="a_sourcefile~~viscosity.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/gradients.f90.html" xlink:title="gradients.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="184,-230 109,-230 109,-206 184,-206 184,-230"/>
<text text-anchor="middle" x="146.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">gradients.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~gradients.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~gradients.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M236.602,-168.0324C222.4695,-176.3065 203.1799,-187.4766 186,-197 183.5992,-198.3308 181.1084,-199.6945 178.5982,-201.0565"/>
<polygon fill="#ff0000" stroke="#ff0000" points="176.7003,-198.103 169.5491,-205.9204 180.0144,-204.2688 176.7003,-198.103"/>
</g>
<!-- sourcefile~copy_bc.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~copy_bc.f90</title>
<g id="a_sourcefile~~viscosity.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/copy_bc.f90.html" xlink:title="copy_bc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="181.5,-108 111.5,-108 111.5,-84 181.5,-84 181.5,-108"/>
<text text-anchor="middle" x="146.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">copy_bc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~copy_bc.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~copy_bc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M234.6387,-143.8581C218.3132,-134.9936 195.9641,-122.8584 177.8563,-113.0261"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.2863,-109.8199 168.8281,-108.1238 175.946,-115.9715 179.2863,-109.8199"/>
</g>
<!-- sourcefile~wall_dist.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~wall_dist.f90</title>
<g id="a_sourcefile~~viscosity.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/wall_dist.f90.html" xlink:title="wall_dist.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="182,-188 111,-188 111,-164 182,-164 182,-188"/>
<text text-anchor="middle" x="146.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wall_dist.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~wall_dist.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~wall_dist.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M221.7333,-162.3831C212.3578,-164.08 202.095,-165.9376 192.2475,-167.7199"/>
<polygon fill="#ff0000" stroke="#ff0000" points="191.407,-164.3151 182.1902,-169.5402 192.6537,-171.2032 191.407,-164.3151"/>
</g>
<!-- sourcefile~global_kkl.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~global_kkl.f90</title>
<g id="a_sourcefile~~viscosity.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/global_kkl.f90.html" xlink:title="global_kkl.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="185.5,-66 107.5,-66 107.5,-42 185.5,-42 185.5,-66"/>
<text text-anchor="middle" x="146.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_kkl.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_kkl.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_kkl.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M248.5098,-143.7792C236.2261,-126.754 212.0932,-95.6668 186,-75 184.4475,-73.7704 182.8124,-72.5773 181.1265,-71.4258"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.7663,-68.3246 172.4214,-66.0369 179.0818,-74.2765 182.7663,-68.3246"/>
</g>
<!-- sourcefile~utils.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~utils.f90</title>
<g id="a_sourcefile~~viscosity.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/utils.f90.html" xlink:title="utils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="62.5,-230 8.5,-230 8.5,-206 62.5,-206 62.5,-230"/>
<text text-anchor="middle" x="35.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M250.9984,-168.2254C240.7531,-187.5149 217.8641,-224.3254 186,-239 149.458,-255.8289 103.0473,-245.1565 71.4918,-233.7756"/>
<polygon fill="#ff0000" stroke="#ff0000" points="72.3909,-230.373 61.7999,-230.0896 69.9025,-236.9158 72.3909,-230.373"/>
</g>
<!-- sourcefile~vartypes.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~vartypes.f90</title>
<g id="a_sourcefile~~viscosity.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/vartypes.f90.html" xlink:title="vartypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-168 0,-168 0,-144 71,-144 71,-168"/>
<text text-anchor="middle" x="35.5" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vartypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M221.9715,-155.4088C210.5076,-155.2414 197.7109,-155.0825 186,-155 150.8898,-154.7528 142.1103,-154.7545 107,-155 98.7039,-155.058 89.8667,-155.1539 81.3363,-155.2639"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.0913,-151.7668 71.1402,-155.4035 81.1872,-158.7662 81.0913,-151.7668"/>
</g>
<!-- sourcefile~global_sst.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~global_sst.f90</title>
<g id="a_sourcefile~~viscosity.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/global_sst.f90.html" xlink:title="global_sst.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="186,-24 107,-24 107,0 186,0 186,-24"/>
<text text-anchor="middle" x="146.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">global_sst.f90</text>
</a>
</g>
</g>
<!-- sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sst.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~viscosity.f90&#45;&gt;sourcefile~global_sst.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M252.5783,-143.698C243.4402,-119.7315 220.4079,-66.2286 186,-33 184.9176,-31.9547 183.7727,-30.9473 182.5811,-29.9781"/>
<polygon fill="#ff0000" stroke="#ff0000" points="184.4092,-26.986 174.2042,-24.1384 180.4061,-32.7284 184.4092,-26.986"/>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M108.9205,-218C97.2673,-218 84.4334,-218 72.7993,-218"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="72.5206,-214.5001 62.5206,-218 72.5205,-221.5001 72.5206,-214.5001"/>
</g>
<!-- sourcefile~gradients.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~gradients.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M123.4573,-205.9087C118.0411,-203.0226 112.3028,-199.929 107,-197 93.0908,-189.3172 77.795,-180.585 64.9327,-173.1594"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="66.4594,-169.9991 56.0516,-168.0171 62.9518,-176.0569 66.4594,-169.9991"/>
</g>
<!-- sourcefile~copy_bc.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~copy_bc.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M124.0375,-108.1419C107.6381,-117.0064 85.188,-129.1416 66.9982,-138.9739"/>
<polygon fill="#7fff00" stroke="#7fff00" points="65.0618,-136.042 57.9291,-143.8762 68.3905,-142.1999 65.0618,-136.042"/>
</g>
<!-- sourcefile~wall_dist.f90&#45;&gt;sourcefile~utils.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~wall_dist.f90&#45;&gt;sourcefile~utils.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M114.6919,-188.0355C101.4949,-193.029 86.0977,-198.8549 72.4072,-204.0351"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="70.91,-200.8594 62.7958,-207.6719 73.3873,-207.4064 70.91,-200.8594"/>
</g>
<!-- sourcefile~wall_dist.f90&#45;&gt;sourcefile~vartypes.f90 -->
<g id="sourcefile~~viscosity.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~wall_dist.f90&#45;&gt;sourcefile~vartypes.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M110.7679,-169.5618C101.3604,-167.8667 91.0813,-166.0147 81.2267,-164.239"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="81.6273,-160.7549 71.1651,-162.4262 80.386,-167.644 81.6273,-160.7549"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~viscosity.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileviscosityf90AfferentGraph" width="641pt" height="377pt"
 viewBox="0.00 0.00 641.00 377.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~viscosity.f90~~AfferentGraph" class="graph" transform="scale(.917 .917) rotate(0) translate(4 407.6372)">
<title>sourcefile~~viscosity.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-407.6372 695,-407.6372 695,4 -4,4"/>
<!-- sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~viscosity.f90</title>
<polygon fill="none" stroke="#000000" points="70,-213 0,-213 0,-189 70,-189 70,-213"/>
<text text-anchor="middle" x="35" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">viscosity.f90</text>
</g>
<!-- sourcefile~write_output_vtk.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~write_output_vtk.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/write_output_vtk.f90.html" xlink:title="write_output_vtk.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="230,-108 121,-108 121,-84 230,-84 230,-108"/>
<text text-anchor="middle" x="175.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output_vtk.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~write_output_vtk.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M123.5117,-108.0415C117.3631,-110.5136 111.3727,-113.4703 106,-117 81.0391,-133.3984 60.0761,-161.1142 47.543,-180.1974"/>
<polygon fill="#ff0000" stroke="#ff0000" points="44.4957,-178.4672 42.0871,-188.7846 50.404,-182.2211 44.4957,-178.4672"/>
</g>
<!-- sourcefile~plusgs.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~plusgs.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/plusgs.f90.html" xlink:title="plusgs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-276 145,-276 145,-252 206,-252 206,-276"/>
<text text-anchor="middle" x="175.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">plusgs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plusgs.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~plusgs.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M144.8247,-256.4506C132.5162,-252.9815 118.3487,-248.4232 106,-243 90.5515,-236.2155 74.2849,-226.7804 61.2251,-218.5712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="63.0523,-215.5851 52.7455,-213.1314 59.2726,-221.477 63.0523,-215.5851"/>
</g>
<!-- sourcefile~time.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~time.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/time.f90.html" xlink:title="time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="202.5,-356 148.5,-356 148.5,-332 202.5,-332 202.5,-356"/>
<text text-anchor="middle" x="175.5" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~time.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~time.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M148.2581,-338.3265C134.4565,-334.3994 118.1048,-328.0246 106,-318 74.6593,-292.0451 53.4754,-248.4526 42.8855,-222.4384"/>
<polygon fill="#ff0000" stroke="#ff0000" points="46.1315,-221.1285 39.2294,-213.0904 39.6124,-223.6783 46.1315,-221.1285"/>
</g>
<!-- sourcefile~write_output_tec.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~write_output_tec.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/write_output_tec.f90.html" xlink:title="write_output_tec.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="230,-66 121,-66 121,-42 230,-42 230,-66"/>
<text text-anchor="middle" x="175.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output_tec.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_tec.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~write_output_tec.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M120.7084,-66.0528C115.444,-68.5043 110.4263,-71.4531 106,-75 71.7723,-102.4273 51.1972,-151.0913 41.5796,-179.2394"/>
<polygon fill="#ff0000" stroke="#ff0000" points="38.1905,-178.3436 38.4245,-188.9359 44.847,-180.5096 38.1905,-178.3436"/>
</g>
<!-- sourcefile~update.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~update.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/update.f90.html" xlink:title="update.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="357.5,-316 293.5,-316 293.5,-292 357.5,-292 357.5,-316"/>
<text text-anchor="middle" x="325.5" y="-301.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">update.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M293.2478,-308.541C248.5008,-313.2772 166.2933,-316.214 106,-285 78.9182,-270.9797 57.9937,-241.7602 46.0842,-221.7624"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.1106,-220.004 41.1155,-213.0521 43.0303,-223.4724 49.1106,-220.004"/>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~plusgs.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~plusgs.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M293.3212,-295.419C270.7242,-289.3931 240.3279,-281.2874 216.0694,-274.8185"/>
<polygon fill="#ff9900" stroke="#ff9900" points="216.6535,-271.352 206.0893,-272.1571 214.8498,-278.1157 216.6535,-271.352"/>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~time.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~time.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M293.3212,-312.581C269.5641,-318.9162 237.1863,-327.5503 212.3835,-334.1644"/>
<polygon fill="#cbff00" stroke="#cbff00" points="211.366,-330.8133 202.6055,-336.7719 213.1697,-337.577 211.366,-330.8133"/>
</g>
<!-- sourcefile~viscous.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~viscous.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/viscous.f90.html" xlink:title="viscous.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="208.5,-150 142.5,-150 142.5,-126 208.5,-126 208.5,-150"/>
<text text-anchor="middle" x="175.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">viscous.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~viscous.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~viscous.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M297.6073,-291.9994C291.4415,-288.2667 285.4333,-283.6201 281,-278 246.778,-234.617 284.0784,-198.0655 245,-159 237.7793,-151.7817 228.1702,-147.0289 218.4068,-143.904"/>
<polygon fill="#0066ff" stroke="#0066ff" points="219.2404,-140.5039 208.6749,-141.2907 217.425,-147.2644 219.2404,-140.5039"/>
</g>
<!-- sourcefile~source.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~source.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/source.f90.html" xlink:title="source.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="207,-234 144,-234 144,-210 207,-210 207,-234"/>
<text text-anchor="middle" x="175.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">source.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~source.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~source.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M302.1789,-291.7942C295.1433,-287.7412 287.5531,-282.9821 281,-278 263.2357,-264.4943 264.227,-254.3269 245,-243 236.456,-237.9666 226.5997,-234.0436 217.0446,-231.0239"/>
<polygon fill="#3200ff" stroke="#3200ff" points="217.8426,-227.6113 207.2639,-228.1953 215.8978,-234.3358 217.8426,-227.6113"/>
</g>
<!-- sourcefile~lusgs.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~lusgs.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/lusgs.f90.html" xlink:title="lusgs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="203,-192 148,-192 148,-168 203,-168 203,-192"/>
<text text-anchor="middle" x="175.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lusgs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~update.f90&#45;&gt;sourcefile~lusgs.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~update.f90&#45;&gt;sourcefile~lusgs.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M298.6264,-291.8053C292.2886,-288.0352 285.9456,-283.4198 281,-278 255.5358,-250.0942 273.5642,-225.7234 245,-201 236.007,-193.2162 224.2012,-188.3174 212.878,-185.2344"/>
<polygon fill="#ff0098" stroke="#ff0098" points="213.6676,-181.8247 203.1344,-182.9656 212.0801,-188.6423 213.6676,-181.8247"/>
</g>
<!-- sourcefile~write_output_tec_node.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~write_output_tec_node.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/write_output_tec_node.f90.html" xlink:title="write_output_tec_node.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="245,-24 106,-24 106,0 245,0 245,-24"/>
<text text-anchor="middle" x="175.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output_tec_node.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~write_output_tec_node.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M119.2521,-24.0706C114.4532,-26.5179 109.9372,-29.461 106,-33 62.25,-72.3255 44.6071,-143.0509 38.2201,-178.891"/>
<polygon fill="#ff0000" stroke="#ff0000" points="34.7565,-178.3842 36.5829,-188.8205 41.6633,-179.5231 34.7565,-178.3842"/>
</g>
<!-- sourcefile~viscous.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~viscous.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M142.3862,-146.2441C130.6703,-149.6186 117.5409,-153.9316 106,-159 90.5515,-165.7845 74.2849,-175.2196 61.2251,-183.4288"/>
<polygon fill="#ff0000" stroke="#ff0000" points="59.2726,-180.523 52.7455,-188.8686 63.0523,-186.4149 59.2726,-180.523"/>
</g>
<!-- sourcefile~source.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~source.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M143.9691,-217.2872C125.1267,-214.4709 100.8799,-210.8468 80.0438,-207.7325"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.5353,-204.2672 70.1277,-206.2504 79.5004,-211.1903 80.5353,-204.2672"/>
</g>
<!-- sourcefile~solver.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~solver.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/solver.f90.html" xlink:title="solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="601,-243 542,-243 542,-219 601,-219 601,-243"/>
<text text-anchor="middle" x="571.5" y="-228.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M325.5,-384C229.7043,-404.2875 185.4506,-422.2364 106,-365 59.0037,-331.1437 42.7933,-259.4511 37.4605,-223.1111"/>
<polygon fill="#ff0000" stroke="#ff0000" points="40.911,-222.5053 36.1326,-213.0492 33.9711,-223.4212 40.911,-222.5053"/>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~time.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~time.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M456,-304C390.6771,-323.0032 392.0547,-369.9051 325.5,-384"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M325.5,-384C304.019,-388.5492 249.1161,-371.1031 212.0383,-357.8179"/>
<polygon fill="#cbff00" stroke="#cbff00" points="213.1561,-354.5002 202.562,-354.3747 210.7655,-361.0794 213.1561,-354.5002"/>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~update.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~update.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M456,-304C427.6436,-313.7993 393.7052,-313.4608 367.5469,-310.8505"/>
<polygon fill="#00ff66" stroke="#00ff66" points="367.9055,-307.3688 357.5724,-309.7093 367.1097,-314.3234 367.9055,-307.3688"/>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~viscous.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~viscous.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M557.3305,-243.0758C536.611,-259.9668 496.1325,-290.1311 456,-304"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M456,-304C402.2271,-322.5827 296.2846,-183.6318 245,-159 236.6559,-154.9924 227.3798,-151.5559 218.3931,-148.6927"/>
<polygon fill="#0066ff" stroke="#0066ff" points="219.3972,-145.3399 208.8129,-145.811 217.3808,-152.0432 219.3972,-145.3399"/>
</g>
<!-- sourcefile~dump_solution.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~dump_solution.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/dump_solution.f90.html" xlink:title="dump_solution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="506,-139 406,-139 406,-115 506,-115 506,-139"/>
<text text-anchor="middle" x="456" y="-124.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dump_solution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solver.f90&#45;&gt;sourcefile~dump_solution.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~solver.f90&#45;&gt;sourcefile~dump_solution.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M557.7971,-218.6614C537.8056,-200.6605 500.4761,-167.0477 477.0025,-145.9114"/>
<polygon fill="#ff0000" stroke="#ff0000" points="479.102,-143.092 469.3286,-139.0015 474.418,-148.294 479.102,-143.092"/>
</g>
<!-- sourcefile~lusgs.f90&#45;&gt;sourcefile~viscosity.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~lusgs.f90&#45;&gt;sourcefile~viscosity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M147.7417,-184.1489C128.4621,-187.0306 102.3429,-190.9345 80.0994,-194.2592"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.5634,-190.8003 70.1906,-195.7402 80.5982,-197.7234 79.5634,-190.8003"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="691,-243 637,-243 637,-219 691,-219 691,-243"/>
<text text-anchor="middle" x="664" y="-228.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~solver.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~solver.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M636.7472,-231C628.791,-231 619.9269,-231 611.361,-231"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="611.1413,-227.5001 601.1413,-231 611.1413,-234.5001 611.1413,-227.5001"/>
</g>
<!-- sourcefile~write_output.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~write_output.f90</title>
<g id="a_sourcefile~~viscosity.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/write_output.f90.html" xlink:title="write_output.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="370,-87 281,-87 281,-63 370,-63 370,-87"/>
<text text-anchor="middle" x="325.5" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">write_output.f90</text>
</a>
</g>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_vtk.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_vtk.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.9012,-81.2438C268.0451,-83.0437 253.7545,-85.0444 239.9504,-86.9769"/>
<polygon fill="#ff0000" stroke="#ff0000" points="239.4304,-83.5155 230.0123,-88.3683 240.401,-90.4479 239.4304,-83.5155"/>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M280.9012,-68.7562C268.0451,-66.9563 253.7545,-64.9556 239.9504,-63.0231"/>
<polygon fill="#33ff00" stroke="#33ff00" points="240.401,-59.5521 230.0123,-61.6317 239.4304,-66.4845 240.401,-59.5521"/>
</g>
<!-- sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec_node.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~write_output.f90&#45;&gt;sourcefile~write_output_tec_node.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M304.8273,-62.8383C288.8626,-53.7882 266.0194,-41.5704 245,-33 240.1635,-31.028 235.0718,-29.1441 229.9342,-27.3716"/>
<polygon fill="#00ffff" stroke="#00ffff" points="230.6461,-23.9207 220.0529,-24.1062 228.4496,-30.5672 230.6461,-23.9207"/>
</g>
<!-- sourcefile~dump_solution.f90&#45;&gt;sourcefile~write_output.f90 -->
<g id="sourcefile~~viscosity.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~dump_solution.f90&#45;&gt;sourcefile~write_output.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M425.7327,-114.9395C407.826,-107.8042 384.9288,-98.6804 365.5407,-90.9549"/>
<polygon fill="#00ffff" stroke="#00ffff" points="366.6405,-87.6256 356.0553,-87.1753 364.0493,-94.1284 366.6405,-87.6256"/>
</g>
</g>
</svg>
</div><script>var pansourcefileviscosityf90AfferentGraph = svgPanZoom('#sourcefileviscosityf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/viscosity.html">viscosity</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/viscosity.f90.html#src">viscosity.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a>  <span class="c">!&lt; Setup, destroy, calculate molecular and turbulence viscosity</span>
<a name="ln-2"></a><span class="k">module </span><span class="n">viscosity</span>
<a name="ln-3"></a>  <span class="c">!&lt; Setup, destroy, calculate molecular and turbulence viscosity</span>
<a name="ln-4"></a>  <span class="c">!-----------------------------------------------------</span>
<a name="ln-5"></a>
<a name="ln-6"></a>  <span class="k">use </span><span class="n">vartypes</span>
<a name="ln-7"></a>  <span class="k">use </span><span class="n">wall_dist</span>  <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">dist</span>
<a name="ln-8"></a>  <span class="k">use </span><span class="n">global_kkl</span>   <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cmu</span>
<a name="ln-9"></a>  <span class="k">use </span><span class="n">global_sst</span>   <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">bstar</span>
<a name="ln-10"></a>  <span class="k">use </span><span class="n">global_sst</span>   <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">a1</span>
<a name="ln-11"></a>  <span class="k">use </span><span class="n">global_sst</span>   <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sst_F1</span>
<a name="ln-12"></a>  <span class="k">use </span><span class="n">global_sst</span>   <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">sigma_w2</span>
<a name="ln-13"></a>  <span class="k">use </span><span class="n">global_sa</span>    <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">cv1</span>
<a name="ln-14"></a>
<a name="ln-15"></a>  <span class="c">! gradients</span>
<a name="ln-16"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradu_x</span>
<a name="ln-17"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradu_y</span>
<a name="ln-18"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradu_z</span> 
<a name="ln-19"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradv_x</span> 
<a name="ln-20"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradv_y</span>
<a name="ln-21"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradv_z</span>
<a name="ln-22"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradw_x</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradw_y</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradw_z</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradT_x</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradT_y</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradT_z</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtk_x</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtk_y</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtk_z</span>
<a name="ln-31"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtw_x</span>
<a name="ln-32"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtw_y</span>
<a name="ln-33"></a>  <span class="k">use </span><span class="n">gradients</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">gradtw_z</span>
<a name="ln-34"></a>  <span class="k">use </span><span class="n">copy_bc</span>       <span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">copy1</span>
<a name="ln-35"></a>  <span class="k">use </span><span class="n">utils</span>       <span class="p">,</span> <span class="n">only</span> <span class="p">:</span>   <span class="n">alloc</span>
<a name="ln-36"></a>
<a name="ln-37"></a><span class="cp">#include &quot;error.h&quot;</span>
<a name="ln-38"></a>
<a name="ln-39"></a>  <span class="k">implicit none</span>
<a name="ln-40"></a><span class="k">  private</span>
<a name="ln-41"></a><span class="k">  </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span>     <span class="kd">::</span> <span class="n">mu</span>
<a name="ln-42"></a>   <span class="c">!&lt; Cell-center molecular viscosity</span>
<a name="ln-43"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span>     <span class="kd">::</span> <span class="n">mu_t</span>
<a name="ln-44"></a>   <span class="c">!&lt; Cell-center turbulent viscosity</span>
<a name="ln-45"></a>
<a name="ln-46"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">setup_viscosity</span>
<a name="ln-47"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">calculate_viscosity</span>
<a name="ln-48"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">mu</span><span class="p">,</span><span class="n">mu_t</span>
<a name="ln-49"></a>
<a name="ln-50"></a>  <span class="k">contains</span>
<a name="ln-51"></a>
<a name="ln-52"></a><span class="k">    subroutine </span><span class="n">calculate_viscosity</span><span class="p">(</span><span class="n">qp</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-53"></a>      <span class="c">!&lt; Calculate molecular and turbulent viscosity</span>
<a name="ln-54"></a>      <span class="k">implicit none</span>
<a name="ln-55"></a><span class="k">      type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-56"></a>      <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-57"></a>      <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-58"></a>      <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-59"></a>      <span class="k">type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-60"></a>      <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-61"></a>      <span class="k">type</span><span class="p">(</span><span class="n">boundarytype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bc</span>
<a name="ln-62"></a>      <span class="c">!&lt; boundary conditions and fixed values</span>
<a name="ln-63"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">dims</span><span class="p">%</span><span class="n">n_var</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">qp</span>
<a name="ln-64"></a>      <span class="c">!&lt; Store primitive variable at cell center</span>
<a name="ln-65"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-66"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T</span> <span class="c">! molecular viscosity</span>
<a name="ln-67"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span> <span class="c">! kkl eddy viscosity</span>
<a name="ln-68"></a>      <span class="c">!- sst varibales -!</span>
<a name="ln-69"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">F</span>
<a name="ln-70"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">arg2</span>
<a name="ln-71"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">vort</span>
<a name="ln-72"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NUM</span>
<a name="ln-73"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DENOM</span>
<a name="ln-74"></a>      <span class="c">! for arg2</span>
<a name="ln-75"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">var1</span>
<a name="ln-76"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">var2</span>
<a name="ln-77"></a>      <span class="c">!for vorticity</span>
<a name="ln-78"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wijwij</span>
<a name="ln-79"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wx</span>
<a name="ln-80"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wy</span>
<a name="ln-81"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wz</span>
<a name="ln-82"></a>      <span class="c">!for strain calculation</span>
<a name="ln-83"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SijSij</span>
<a name="ln-84"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Sxx</span><span class="p">,</span> <span class="n">Syy</span><span class="p">,</span> <span class="n">Szz</span>
<a name="ln-85"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Sxy</span><span class="p">,</span> <span class="n">Szx</span><span class="p">,</span> <span class="n">Syz</span>
<a name="ln-86"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">strain</span>
<a name="ln-87"></a>      <span class="c">!for arg1</span>
<a name="ln-88"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">arg1</span>
<a name="ln-89"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CD</span>
<a name="ln-90"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">right</span>
<a name="ln-91"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">left</span>
<a name="ln-92"></a>
<a name="ln-93"></a>      <span class="c">! sa variables</span>
<a name="ln-94"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fv1</span>
<a name="ln-95"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xi</span>
<a name="ln-96"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pressure</span>
<a name="ln-97"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">density</span>
<a name="ln-98"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tk</span>
<a name="ln-99"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tkl</span>
<a name="ln-100"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tw</span>
<a name="ln-101"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tv</span>
<a name="ln-102"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imx</span><span class="p">,</span> <span class="n">jmx</span><span class="p">,</span> <span class="n">kmx</span>
<a name="ln-103"></a>
<a name="ln-104"></a>      <span class="n">imx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">imx</span>
<a name="ln-105"></a>      <span class="n">jmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">jmx</span>
<a name="ln-106"></a>      <span class="n">kmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">kmx</span>
<a name="ln-107"></a>
<a name="ln-108"></a>      <span class="c">!--- calculate_molecular_viscosity ---!</span>
<a name="ln-109"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">/=</span><span class="mf">0.</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-110"></a><span class="k">        select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_variation</span><span class="p">))</span>
<a name="ln-111"></a>          <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;sutherland_law&#39;</span><span class="p">)</span>
<a name="ln-112"></a>            <span class="c">! apply_sutherland_law</span>
<a name="ln-113"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">kmx</span>
<a name="ln-114"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">jmx</span>
<a name="ln-115"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">imx</span>
<a name="ln-116"></a>                  <span class="n">pressure</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-117"></a>                  <span class="n">density</span>  <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-118"></a>                  <span class="n">T</span> <span class="o">=</span> <span class="n">pressure</span><span class="o">/</span><span class="p">(</span><span class="n">density</span><span class="o">*</span><span class="n">flow</span><span class="p">%</span><span class="n">R_gas</span><span class="p">)</span>
<a name="ln-119"></a>                  <span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span> <span class="o">*</span> <span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">flow</span><span class="p">%</span><span class="n">T_ref</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.5</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-120"></a>                            <span class="o">*</span><span class="p">((</span><span class="n">flow</span><span class="p">%</span><span class="n">T_ref</span> <span class="o">+</span> <span class="n">flow</span><span class="p">%</span><span class="n">Sutherland_temp</span><span class="p">)&amp;</span>
<a name="ln-121"></a>                            <span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">flow</span><span class="p">%</span><span class="n">Sutherland_temp</span><span class="p">))</span>
<a name="ln-122"></a>                <span class="k">end do</span>
<a name="ln-123"></a><span class="k">              end do</span>
<a name="ln-124"></a><span class="k">            end do</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="k">          case</span> <span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>
<a name="ln-127"></a>            <span class="c">!do nothing</span>
<a name="ln-128"></a>            <span class="c">!mu will be equal to mu_ref</span>
<a name="ln-129"></a>            <span class="k">continue</span>
<a name="ln-130"></a>
<a name="ln-131"></a><span class="k">          case </span><span class="n">DEFAULT</span>
<a name="ln-132"></a>            <span class="k">print</span><span class="o">*</span><span class="p">,</span><span class="s2">&quot;mu_variation not recognized:&quot;</span>
<a name="ln-133"></a>            <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;   found &#39;&quot;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_variation</span><span class="p">),</span><span class="s2">&quot;&#39;&quot;</span>
<a name="ln-134"></a>            <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;accepted values: 1) sutherland_law&quot;</span>
<a name="ln-135"></a>            <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;                 2) constant&quot;</span>
<a name="ln-136"></a>            <span class="n">Fatal_error</span>
<a name="ln-137"></a>        <span class="k">end select</span>
<a name="ln-138"></a><span class="k">      end if</span>
<a name="ln-139"></a>      <span class="c">!--- end molecular viscosity calculation---!</span>
<a name="ln-140"></a>
<a name="ln-141"></a>      <span class="c">!--- calculate_turbulent_viscosity  ---!</span>
<a name="ln-142"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="o">/=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-143"></a><span class="k">        select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-144"></a>
<a name="ln-145"></a>          <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a name="ln-146"></a>            <span class="c">!do nothing</span>
<a name="ln-147"></a>            <span class="k">continue</span>
<a name="ln-148"></a>
<a name="ln-149"></a><span class="k">          case</span> <span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">)</span>
<a name="ln-150"></a>            <span class="c">!call calculate_sa_mu()</span>
<a name="ln-151"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">kmx</span>
<a name="ln-152"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">jmx</span>
<a name="ln-153"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">imx</span>
<a name="ln-154"></a>                  <span class="n">tv</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-155"></a>                  <span class="n">density</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-156"></a>                  <span class="c">! xsi </span>
<a name="ln-157"></a>                   <span class="n">xi</span> <span class="o">=</span> <span class="n">tv</span><span class="o">*</span><span class="n">density</span><span class="o">/</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-158"></a>                  <span class="c">!calculation fo fv1 function</span>
<a name="ln-159"></a>                  <span class="n">fv1</span> <span class="o">=</span> <span class="p">(</span><span class="n">xi</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">xi</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">cv1</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-160"></a>                  <span class="n">mu_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">density</span><span class="o">*</span><span class="n">tv</span><span class="o">*</span><span class="n">fv1</span>
<a name="ln-161"></a>                <span class="k">end do</span>
<a name="ln-162"></a><span class="k">              end do</span>
<a name="ln-163"></a><span class="k">            end do</span>
<a name="ln-164"></a>
<a name="ln-165"></a>            <span class="c">! populating ghost cell</span>
<a name="ln-166"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-167"></a>              <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-168"></a>                <span class="k">case</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">:)</span>
<a name="ln-169"></a>                  <span class="c">!interface</span>
<a name="ln-170"></a>                  <span class="k">continue</span>
<a name="ln-171"></a>
<a name="ln-172"></a><span class="k">                case</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-173"></a>                  <span class="c">!call copy1(sa_mu, &quot;symm&quot;, face_names(i))</span>
<a name="ln-174"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">face_names</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-175"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imin&quot;</span><span class="p">)</span>
<a name="ln-176"></a>                        <span class="n">mu_t</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-177"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imax&quot;</span><span class="p">)</span>
<a name="ln-178"></a>                        <span class="n">mu_t</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-179"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmin&quot;</span><span class="p">)</span>
<a name="ln-180"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-181"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmax&quot;</span><span class="p">)</span>
<a name="ln-182"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-183"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmin&quot;</span><span class="p">)</span>
<a name="ln-184"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-185"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmax&quot;</span><span class="p">)</span>
<a name="ln-186"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-187"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-188"></a>                      <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;ERROR: wrong face for boundary condition&quot;</span>
<a name="ln-189"></a>                      <span class="n">Fatal_error</span>
<a name="ln-190"></a>                  <span class="k">end select</span>
<a name="ln-191"></a>
<a name="ln-192"></a><span class="k">                case</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-193"></a>                  <span class="c">!call copy1(sa_mu, &quot;anti&quot;, face_names(i))</span>
<a name="ln-194"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">face_names</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-195"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imin&quot;</span><span class="p">)</span>
<a name="ln-196"></a>                        <span class="n">mu_t</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-197"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imax&quot;</span><span class="p">)</span>
<a name="ln-198"></a>                        <span class="n">mu_t</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-199"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmin&quot;</span><span class="p">)</span>
<a name="ln-200"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-201"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmax&quot;</span><span class="p">)</span>
<a name="ln-202"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-203"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmin&quot;</span><span class="p">)</span>
<a name="ln-204"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-205"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmax&quot;</span><span class="p">)</span>
<a name="ln-206"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-207"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-208"></a>                      <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;ERROR: wrong face for boundary condition&quot;</span>
<a name="ln-209"></a>                      <span class="n">Fatal_error</span>
<a name="ln-210"></a>                  <span class="k">end select</span>
<a name="ln-211"></a><span class="k">              end select</span>
<a name="ln-212"></a><span class="k">            end do</span>
<a name="ln-213"></a>            <span class="c">!--- end of sa eddy viscosity  ---!</span>
<a name="ln-214"></a>
<a name="ln-215"></a>          <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-216"></a>            <span class="c">!call calculate_sst_mu()</span>
<a name="ln-217"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">kmx</span>
<a name="ln-218"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">jmx</span>
<a name="ln-219"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">imx</span>
<a name="ln-220"></a>                  <span class="n">density</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-221"></a>                  <span class="n">tk</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-222"></a>                  <span class="n">tw</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-223"></a>
<a name="ln-224"></a>                  <span class="c">! calculate_arg2()</span>
<a name="ln-225"></a>                  <span class="n">var1</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">bstar</span><span class="o">*</span><span class="n">tw</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-226"></a>                  <span class="n">var2</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="p">(</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">density</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">tw</span><span class="p">)</span>
<a name="ln-227"></a>                  <span class="n">arg2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">)</span>
<a name="ln-228"></a>
<a name="ln-229"></a>                  <span class="c">! calculate_f2()</span>
<a name="ln-230"></a>                  <span class="n">F</span> <span class="o">=</span> <span class="nb">tanh</span><span class="p">(</span><span class="n">arg2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-231"></a>
<a name="ln-232"></a>                  <span class="c">! calculate_vorticity(</span>
<a name="ln-233"></a>                  <span class="n">sxx</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradu_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-234"></a>                  <span class="n">syy</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradv_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-235"></a>                  <span class="n">szz</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradw_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-236"></a>                  <span class="n">syz</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradw_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">gradv_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-237"></a>                  <span class="n">szx</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradu_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">gradw_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-238"></a>                  <span class="n">sxy</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradv_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">gradu_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-239"></a>
<a name="ln-240"></a>                  <span class="n">SijSij</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">sxx</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">syy</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">szz</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">syz</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">szx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sxy</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-241"></a>
<a name="ln-242"></a>                  <span class="n">strain</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">SijSij</span><span class="p">)</span>
<a name="ln-243"></a>
<a name="ln-244"></a>                  <span class="n">NUM</span> <span class="o">=</span> <span class="n">density</span><span class="o">*</span><span class="n">a1</span><span class="o">*</span><span class="n">tk</span>
<a name="ln-245"></a>                  <span class="n">DENOM</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">((</span><span class="n">a1</span><span class="o">*</span><span class="n">tw</span><span class="p">),</span> <span class="n">strain</span><span class="o">*</span><span class="n">F</span><span class="p">),</span><span class="mf">1.0e-10</span><span class="p">)</span>
<a name="ln-246"></a>                  <span class="n">mu_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">NUM</span><span class="o">/</span><span class="n">DENOM</span>
<a name="ln-247"></a>                  <span class="c">!-- end eddy visocisyt calculation --!</span>
<a name="ln-248"></a>                  <span class="c">!-- calculating blending function F1 --!</span>
<a name="ln-249"></a>                  <span class="n">CD</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">density</span><span class="o">*</span><span class="n">sigma_w2</span><span class="o">*</span><span class="p">(</span>                             <span class="p">&amp;</span> 
<a name="ln-250"></a>                                                      <span class="n">gradtk_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">gradtw_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-251"></a>                                                    <span class="o">+</span> <span class="n">gradtk_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">gradtw_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-252"></a>                                                    <span class="o">+</span> <span class="n">gradtk_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">gradtw_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-253"></a>                                                     <span class="p">)</span><span class="o">/</span><span class="n">tw</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-254"></a>                           <span class="mf">1.0e-10</span><span class="p">)</span>
<a name="ln-255"></a>
<a name="ln-256"></a>                  <span class="n">right</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">density</span><span class="o">*</span><span class="n">sigma_w2</span><span class="o">*</span><span class="n">tk</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">CD</span><span class="o">*</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-257"></a>                  <span class="n">left</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">)</span>
<a name="ln-258"></a>                  <span class="n">arg1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<a name="ln-259"></a>                  <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">tanh</span><span class="p">(</span><span class="n">arg1</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-260"></a>                  <span class="c">!-- end of blending function F1 calculation --!</span>
<a name="ln-261"></a>                <span class="k">end do</span>
<a name="ln-262"></a><span class="k">              end do</span>
<a name="ln-263"></a><span class="k">            end do</span>
<a name="ln-264"></a>
<a name="ln-265"></a><span class="k">            select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">transition</span><span class="p">))</span>
<a name="ln-266"></a>              <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lctm2015&#39;</span><span class="p">)</span>
<a name="ln-267"></a>                <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">kmx</span>
<a name="ln-268"></a>                  <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">jmx</span>
<a name="ln-269"></a>                    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">imx</span>
<a name="ln-270"></a>                      <span class="c">!modified blending function (Menter 2015)</span>
<a name="ln-271"></a>                      <span class="n">var1</span> <span class="o">=</span> <span class="n">density</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-272"></a>                      <span class="n">var2</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">var1</span><span class="o">/</span><span class="mi">120</span><span class="p">)</span><span class="o">**</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-273"></a>                      <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">var2</span><span class="p">)</span>
<a name="ln-274"></a>                    <span class="k">end do</span>
<a name="ln-275"></a><span class="k">                  end do</span>
<a name="ln-276"></a><span class="k">                end do</span>
<a name="ln-277"></a><span class="k">              case </span><span class="n">DEFAULT</span>
<a name="ln-278"></a>                <span class="c">!do nothing</span>
<a name="ln-279"></a>                <span class="k">continue</span>
<a name="ln-280"></a><span class="k">            end select</span>
<a name="ln-281"></a>
<a name="ln-282"></a>            <span class="c">! populating ghost cell</span>
<a name="ln-283"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-284"></a>              <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-285"></a>                <span class="k">case</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">:)</span>
<a name="ln-286"></a>                  <span class="c">!interface</span>
<a name="ln-287"></a>                  <span class="k">continue</span>
<a name="ln-288"></a>
<a name="ln-289"></a><span class="k">                case</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-290"></a>                  <span class="c">!call copy1(sst_mu, &quot;symm&quot;, face_names(i))</span>
<a name="ln-291"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">face_names</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-292"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imin&quot;</span><span class="p">)</span>
<a name="ln-293"></a>                        <span class="n">mu_t</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-294"></a>                        <span class="n">sst_F1</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-295"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imax&quot;</span><span class="p">)</span>
<a name="ln-296"></a>                        <span class="n">mu_t</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-297"></a>                        <span class="n">sst_F1</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-298"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmin&quot;</span><span class="p">)</span>
<a name="ln-299"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-300"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-301"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmax&quot;</span><span class="p">)</span>
<a name="ln-302"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-303"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-304"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmin&quot;</span><span class="p">)</span>
<a name="ln-305"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-306"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-307"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmax&quot;</span><span class="p">)</span>
<a name="ln-308"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-309"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-310"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-311"></a>                      <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;ERROR: wrong face for boundary condition&quot;</span>
<a name="ln-312"></a>                      <span class="n">Fatal_error</span>
<a name="ln-313"></a>                  <span class="k">end select</span>
<a name="ln-314"></a><span class="k">                case</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-315"></a>                  <span class="c">!call copy1(sst_mu, &quot;anti&quot;, face_names(i))</span>
<a name="ln-316"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">face_names</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-317"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imin&quot;</span><span class="p">)</span>
<a name="ln-318"></a>                        <span class="n">mu_t</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-319"></a>                        <span class="n">sst_F1</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-320"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imax&quot;</span><span class="p">)</span>
<a name="ln-321"></a>                        <span class="n">mu_t</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-322"></a>                        <span class="n">sst_F1</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-323"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmin&quot;</span><span class="p">)</span>
<a name="ln-324"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-325"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-326"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmax&quot;</span><span class="p">)</span>
<a name="ln-327"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-328"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-329"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmin&quot;</span><span class="p">)</span>
<a name="ln-330"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-331"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-332"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmax&quot;</span><span class="p">)</span>
<a name="ln-333"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-334"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-335"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-336"></a>                      <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;ERROR: wrong face for boundary condition&quot;</span>
<a name="ln-337"></a>                      <span class="n">Fatal_error</span>
<a name="ln-338"></a>                  <span class="k">end select</span>
<a name="ln-339"></a><span class="k">              end select</span>
<a name="ln-340"></a><span class="k">            end do</span>
<a name="ln-341"></a>            <span class="c">!--- end of sst2003 eddy viscosity  and blending fucntion calculation ---!</span>
<a name="ln-342"></a>
<a name="ln-343"></a>          <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">)</span>
<a name="ln-344"></a>            <span class="c">!call calculate_sst_mu()</span>
<a name="ln-345"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">kmx</span>
<a name="ln-346"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">jmx</span>
<a name="ln-347"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">imx</span>
<a name="ln-348"></a>
<a name="ln-349"></a>                  <span class="n">density</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-350"></a>                  <span class="n">tk</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-351"></a>                  <span class="n">tw</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-352"></a>                  <span class="c">! calculate_arg2()</span>
<a name="ln-353"></a>                  <span class="n">var1</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">bstar</span><span class="o">*</span><span class="n">tw</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-354"></a>                  <span class="n">var2</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="p">(</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">density</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">tw</span><span class="p">)</span>
<a name="ln-355"></a>                  <span class="n">arg2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">)</span>
<a name="ln-356"></a>
<a name="ln-357"></a>                  <span class="c">! calculate_f2()</span>
<a name="ln-358"></a>                  <span class="n">F</span> <span class="o">=</span> <span class="nb">tanh</span><span class="p">(</span><span class="n">arg2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-359"></a>
<a name="ln-360"></a>                  <span class="c">! calculate_vorticity(</span>
<a name="ln-361"></a>                  <span class="n">wx</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradw_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">gradv_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-362"></a>                  <span class="n">wy</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradu_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">gradw_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-363"></a>                  <span class="n">wz</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradv_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">gradu_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-364"></a>
<a name="ln-365"></a>                  <span class="n">wijwij</span> <span class="o">=</span> <span class="n">wx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">wy</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">wz</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-366"></a>
<a name="ln-367"></a>                  <span class="n">vort</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">wijwij</span><span class="p">)</span>
<a name="ln-368"></a>
<a name="ln-369"></a>                  <span class="n">NUM</span> <span class="o">=</span> <span class="n">density</span><span class="o">*</span><span class="n">a1</span><span class="o">*</span><span class="n">tk</span>
<a name="ln-370"></a>                  <span class="n">DENOM</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">((</span><span class="n">a1</span><span class="o">*</span><span class="n">tw</span><span class="p">),</span> <span class="n">vort</span><span class="o">*</span><span class="n">F</span><span class="p">),</span><span class="mf">1.e-20</span><span class="p">)</span>
<a name="ln-371"></a>                  <span class="n">mu_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">NUM</span><span class="o">/</span><span class="n">DENOM</span>
<a name="ln-372"></a>                  <span class="c">!-- end eddy visocisyt calculation --!</span>
<a name="ln-373"></a>                  <span class="c">!-- calculating blending function F1 --!</span>
<a name="ln-374"></a>                  <span class="n">CD</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">density</span><span class="o">*</span><span class="n">sigma_w2</span><span class="o">*</span><span class="p">(</span>                             <span class="p">&amp;</span> 
<a name="ln-375"></a>                                                      <span class="n">gradtk_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">gradtw_x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-376"></a>                                                    <span class="o">+</span> <span class="n">gradtk_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">gradtw_y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-377"></a>                                                    <span class="o">+</span> <span class="n">gradtk_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">gradtw_z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)&amp;</span>
<a name="ln-378"></a>                                                     <span class="p">)</span><span class="o">/</span><span class="n">tw</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-379"></a>                           <span class="err">1</span><span class="n">e</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-380"></a>
<a name="ln-381"></a>                  <span class="n">right</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">density</span><span class="o">*</span><span class="n">sigma_w2</span><span class="o">*</span><span class="n">tk</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">CD</span><span class="o">*</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-382"></a>                  <span class="n">left</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">)</span>
<a name="ln-383"></a>                  <span class="n">arg1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<a name="ln-384"></a>                  <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">tanh</span><span class="p">(</span><span class="n">arg1</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-385"></a>                  <span class="c">!-- end of blending function F1 calculation --!</span>
<a name="ln-386"></a>                <span class="k">end do</span>
<a name="ln-387"></a><span class="k">              end do</span>
<a name="ln-388"></a><span class="k">            end do</span>
<a name="ln-389"></a>
<a name="ln-390"></a><span class="k">            select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">transition</span><span class="p">))</span>
<a name="ln-391"></a>              <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lctm2015&#39;</span><span class="p">)</span>
<a name="ln-392"></a>                <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">kmx</span>
<a name="ln-393"></a>                  <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">jmx</span>
<a name="ln-394"></a>                    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">imx</span>
<a name="ln-395"></a>                      <span class="c">!modified blending function (Menter 2015)</span>
<a name="ln-396"></a>                      <span class="n">var1</span> <span class="o">=</span> <span class="n">density</span><span class="o">*</span><span class="n">dist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-397"></a>                      <span class="n">var2</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">var1</span><span class="o">/</span><span class="mi">120</span><span class="p">)</span><span class="o">**</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-398"></a>                      <span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">sst_F1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">var2</span><span class="p">)</span>
<a name="ln-399"></a>                    <span class="k">end do</span>
<a name="ln-400"></a><span class="k">                  end do</span>
<a name="ln-401"></a><span class="k">                end do</span>
<a name="ln-402"></a><span class="k">              case </span><span class="n">DEFAULT</span>
<a name="ln-403"></a>                <span class="c">!do nothing</span>
<a name="ln-404"></a>                <span class="k">continue</span>
<a name="ln-405"></a><span class="k">            end select</span>
<a name="ln-406"></a>
<a name="ln-407"></a>            <span class="c">! populating ghost cell</span>
<a name="ln-408"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-409"></a>              <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-410"></a>                <span class="k">case</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">:)</span>
<a name="ln-411"></a>                  <span class="c">!interface</span>
<a name="ln-412"></a>                  <span class="k">continue</span>
<a name="ln-413"></a>
<a name="ln-414"></a><span class="k">                case</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-415"></a>                  <span class="c">!call copy1(sst_mu, &quot;symm&quot;, face_names(i))</span>
<a name="ln-416"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">face_names</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-417"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imin&quot;</span><span class="p">)</span>
<a name="ln-418"></a>                        <span class="n">mu_t</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-419"></a>                        <span class="n">sst_F1</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-420"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imax&quot;</span><span class="p">)</span>
<a name="ln-421"></a>                        <span class="n">mu_t</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-422"></a>                        <span class="n">sst_F1</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-423"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmin&quot;</span><span class="p">)</span>
<a name="ln-424"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-425"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-426"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmax&quot;</span><span class="p">)</span>
<a name="ln-427"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-428"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-429"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmin&quot;</span><span class="p">)</span>
<a name="ln-430"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-431"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-432"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmax&quot;</span><span class="p">)</span>
<a name="ln-433"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-434"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-435"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-436"></a>                      <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;ERROR: wrong face for boundary condition&quot;</span>
<a name="ln-437"></a>                      <span class="n">Fatal_error</span>
<a name="ln-438"></a>                  <span class="k">end select</span>
<a name="ln-439"></a><span class="k">                case</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-440"></a>                  <span class="c">!call copy1(sst_mu, &quot;anti&quot;, face_names(i))</span>
<a name="ln-441"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">face_names</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-442"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imin&quot;</span><span class="p">)</span>
<a name="ln-443"></a>                        <span class="n">mu_t</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-444"></a>                        <span class="n">sst_F1</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-445"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imax&quot;</span><span class="p">)</span>
<a name="ln-446"></a>                        <span class="n">mu_t</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-447"></a>                        <span class="n">sst_F1</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-448"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmin&quot;</span><span class="p">)</span>
<a name="ln-449"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-450"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-451"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmax&quot;</span><span class="p">)</span>
<a name="ln-452"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-453"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-454"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmin&quot;</span><span class="p">)</span>
<a name="ln-455"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-456"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-457"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmax&quot;</span><span class="p">)</span>
<a name="ln-458"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-459"></a>                        <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span>  <span class="n">sst_F1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-460"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-461"></a>                      <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;ERROR: wrong face for boundary condition&quot;</span>
<a name="ln-462"></a>                      <span class="n">Fatal_error</span>
<a name="ln-463"></a>                  <span class="k">end select</span>
<a name="ln-464"></a><span class="k">              end select</span>
<a name="ln-465"></a><span class="k">            end do</span>
<a name="ln-466"></a>            <span class="c">!--- end of sst eddy viscosity  and blending fucntion calculation ---!</span>
<a name="ln-467"></a>
<a name="ln-468"></a>
<a name="ln-469"></a>          <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-470"></a>            <span class="c">!--- calculate_kkl_mu()</span>
<a name="ln-471"></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">cmu</span><span class="o">**</span><span class="mf">0.25</span>
<a name="ln-472"></a>
<a name="ln-473"></a>            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">kmx</span>
<a name="ln-474"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">jmx</span>
<a name="ln-475"></a>                <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">imx</span>
<a name="ln-476"></a>                  <span class="n">density</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-477"></a>                  <span class="n">tk</span>  <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-478"></a>                  <span class="n">tkl</span> <span class="o">=</span> <span class="n">qp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-479"></a>                  <span class="n">mu_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">density</span><span class="o">*</span><span class="n">tkl</span><span class="o">/</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">tk</span><span class="p">),</span><span class="mf">1.e-20</span><span class="p">))</span>
<a name="ln-480"></a>                  <span class="k">if</span><span class="p">(</span><span class="n">tkl</span><span class="o">&lt;</span><span class="mf">1.e-14</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">tk</span><span class="o">&lt;</span><span class="mf">1.e-14</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-481"></a>                    <span class="n">mu_t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0</span> 
<a name="ln-482"></a>                <span class="k">end do</span>
<a name="ln-483"></a><span class="k">              end do</span>
<a name="ln-484"></a><span class="k">            end do</span>
<a name="ln-485"></a>
<a name="ln-486"></a>            <span class="c">! populating ghost cell</span>
<a name="ln-487"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-488"></a>              <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-489"></a>                <span class="k">case</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">:)</span>
<a name="ln-490"></a>                  <span class="c">!interface</span>
<a name="ln-491"></a>                  <span class="k">continue</span>
<a name="ln-492"></a>
<a name="ln-493"></a><span class="k">                case</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-494"></a>                  <span class="c">!call copy1(kkl_mu, &quot;symm&quot;, face_names(i))</span>
<a name="ln-495"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">face_names</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-496"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imin&quot;</span><span class="p">)</span>
<a name="ln-497"></a>                        <span class="n">mu_t</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-498"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imax&quot;</span><span class="p">)</span>
<a name="ln-499"></a>                        <span class="n">mu_t</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-500"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmin&quot;</span><span class="p">)</span>
<a name="ln-501"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-502"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmax&quot;</span><span class="p">)</span>
<a name="ln-503"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-504"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmin&quot;</span><span class="p">)</span>
<a name="ln-505"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-506"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmax&quot;</span><span class="p">)</span>
<a name="ln-507"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-508"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-509"></a>                      <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;ERROR: wrong face for boundary condition&quot;</span>
<a name="ln-510"></a>                      <span class="n">Fatal_error</span>
<a name="ln-511"></a>                  <span class="k">end select</span>
<a name="ln-512"></a><span class="k">                case</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-513"></a>                  <span class="c">!call copy1(kkl_mu, &quot;anti&quot;, face_names(i))</span>
<a name="ln-514"></a>                  <span class="k">select case</span><span class="p">(</span><span class="n">bc</span><span class="p">%</span><span class="n">face_names</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-515"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imin&quot;</span><span class="p">)</span>
<a name="ln-516"></a>                        <span class="n">mu_t</span><span class="p">(</span>      <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span>     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-517"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;imax&quot;</span><span class="p">)</span>
<a name="ln-518"></a>                        <span class="n">mu_t</span><span class="p">(</span>  <span class="n">imx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span> <span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-519"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmin&quot;</span><span class="p">)</span>
<a name="ln-520"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-521"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;jmax&quot;</span><span class="p">)</span>
<a name="ln-522"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">jmx</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-523"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmin&quot;</span><span class="p">)</span>
<a name="ln-524"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">)</span>
<a name="ln-525"></a>                    <span class="k">case</span><span class="p">(</span><span class="s2">&quot;kmax&quot;</span><span class="p">)</span>
<a name="ln-526"></a>                        <span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="n">kmx</span>  <span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu_t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">imx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">jmx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">kmx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-527"></a>                    <span class="k">case </span><span class="n">DEFAULT</span>
<a name="ln-528"></a>                      <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s2">&quot;ERROR: wrong face for boundary condition&quot;</span>
<a name="ln-529"></a>                      <span class="n">Fatal_error</span>
<a name="ln-530"></a>                  <span class="k">end select</span>
<a name="ln-531"></a><span class="k">              end select</span>
<a name="ln-532"></a><span class="k">            end do</span>
<a name="ln-533"></a>            <span class="c">!--- end of kkl eddy viscosity calculation ---!</span>
<a name="ln-534"></a>
<a name="ln-535"></a>          <span class="k">case </span><span class="n">DEFAULT</span> 
<a name="ln-536"></a>            <span class="n">Fatal_error</span>
<a name="ln-537"></a>
<a name="ln-538"></a>        <span class="k">end select</span>
<a name="ln-539"></a><span class="k">      end if</span>
<a name="ln-540"></a>      <span class="c">!--- end turbulent viscosity calculation---!</span>
<a name="ln-541"></a>      <span class="c">!--- check on viscosity ---!</span>
<a name="ln-542"></a>      <span class="k">if</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">mu</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-543"></a><span class="k">        </span><span class="n">Fatal_error</span>
<a name="ln-544"></a>      <span class="k">end if</span>
<a name="ln-545"></a>
<a name="ln-546"></a><span class="k">    end subroutine </span><span class="n">calculate_viscosity</span>
<a name="ln-547"></a>
<a name="ln-548"></a>    <span class="k">subroutine </span><span class="n">setup_viscosity</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span><span class="n">flow</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<a name="ln-549"></a>      <span class="c">!&lt; Allocate and pointer for molecular and turbulent viscosity</span>
<a name="ln-550"></a>      <span class="k">implicit none</span>
<a name="ln-551"></a><span class="k">      type</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dims</span>
<a name="ln-552"></a>      <span class="c">!&lt; Extent of the domain:imx,jmx,kmx</span>
<a name="ln-553"></a>      <span class="k">type</span><span class="p">(</span><span class="n">schemetype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheme</span>
<a name="ln-554"></a>      <span class="c">!&lt; finite-volume Schemes</span>
<a name="ln-555"></a>      <span class="k">type</span><span class="p">(</span><span class="n">flowtype</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flow</span>
<a name="ln-556"></a>      <span class="c">!&lt; Information about fluid flow: freestream-speed, ref-viscosity,etc.</span>
<a name="ln-557"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imx</span><span class="p">,</span> <span class="n">jmx</span><span class="p">,</span> <span class="n">kmx</span>
<a name="ln-558"></a>
<a name="ln-559"></a>      <span class="n">imx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">imx</span>
<a name="ln-560"></a>      <span class="n">jmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">jmx</span>
<a name="ln-561"></a>      <span class="n">kmx</span> <span class="o">=</span> <span class="n">dims</span><span class="p">%</span><span class="n">kmx</span>
<a name="ln-562"></a>      <span class="c">!setup_molecular_viscosity()</span>
<a name="ln-563"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span><span class="o">/=</span><span class="mf">0.</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-564"></a><span class="k">        call </span><span class="n">alloc</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-565"></a>        <span class="n">mu</span> <span class="o">=</span> <span class="n">flow</span><span class="p">%</span><span class="n">mu_ref</span> <span class="c">!intialize</span>
<a name="ln-566"></a>      <span class="k">end if</span>
<a name="ln-567"></a>
<a name="ln-568"></a>      <span class="c">!--- setup_turbulent_viscosity ---!</span>
<a name="ln-569"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="o">/=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-570"></a><span class="k">        call </span><span class="n">alloc</span><span class="p">(</span><span class="n">mu_t</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-571"></a>
<a name="ln-572"></a>
<a name="ln-573"></a>        <span class="k">select case</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">scheme</span><span class="p">%</span><span class="n">turbulence</span><span class="p">))</span>
<a name="ln-574"></a>
<a name="ln-575"></a>          <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;saBC&#39;</span><span class="p">,</span> <span class="s1">&#39;kkl&#39;</span><span class="p">)</span>
<a name="ln-576"></a>            <span class="c">!do nothing</span>
<a name="ln-577"></a>            <span class="k">continue</span>
<a name="ln-578"></a>
<a name="ln-579"></a><span class="k">          case</span> <span class="p">(</span><span class="s1">&#39;sst&#39;</span><span class="p">,</span> <span class="s1">&#39;sst2003&#39;</span><span class="p">)</span>
<a name="ln-580"></a>            <span class="c">!-- sst blending funciton F1 --!</span>
<a name="ln-581"></a>            <span class="k">call </span><span class="n">alloc</span><span class="p">(</span><span class="n">sst_F1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">jmx</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">kmx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-582"></a>            <span class="n">sst_F1</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-583"></a>            <span class="c">!-- sst blnding function setup compete--!</span>
<a name="ln-584"></a>
<a name="ln-585"></a>          <span class="k">case </span><span class="n">DEFAULT</span> 
<a name="ln-586"></a>            <span class="n">Fatal_error</span>
<a name="ln-587"></a>
<a name="ln-588"></a>        <span class="k">end select</span>
<a name="ln-589"></a><span class="k">      end if</span>
<a name="ln-590"></a>      <span class="c">! --- end turbulent viscosity setup ---!</span>
<a name="ln-591"></a>
<a name="ln-592"></a>    <span class="k">end subroutine </span><span class="n">setup_viscosity</span>
<a name="ln-593"></a>
<a name="ln-594"></a>
<a name="ln-595"></a><span class="k">end module </span><span class="n">viscosity</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-02-10T20:32:54.471560 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FEST-3D was developed by FEST-3D Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>